var lt=Object.defineProperty;var dt=(a,t,s)=>t in a?lt(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var B=(a,t,s)=>dt(a,typeof t!="symbol"?t+"":t,s);import{j as e}from"./ui-DWQTkzug.js";import{r as c,u as Je,a as mt,R as Ye,B as ut,b as pt,c as Z,N as Ae}from"./router-Cgtqz8sJ.js";import{a as ht,g as xt}from"./vendor-C8w-UNLI.js";import{c as le,a as J}from"./utils-DdsSmqNV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Ne={},Le;function gt(){if(Le)return Ne;Le=1;var a=ht();return Ne.createRoot=a.createRoot,Ne.hydrateRoot=a.hydrateRoot,Ne}var yt=gt();const ft=xt(yt);function bt(a,t){let s;try{s=a()}catch{return}return{getItem:n=>{var i;const o=m=>m===null?null:JSON.parse(m,void 0),l=(i=s.getItem(n))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,i)=>s.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>s.removeItem(n)}}const Ce=a=>t=>{try{const s=a(t);return s instanceof Promise?s:{then(r){return Ce(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return Ce(r)(s)}}}},vt=(a,t)=>(s,r,n)=>{let i={storage:bt(()=>localStorage),partialize:y=>y,version:0,merge:(y,x)=>({...x,...y}),...t},o=!1;const l=new Set,m=new Set;let d=i.storage;if(!d)return a((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...y)},r,n);const u=()=>{const y=i.partialize({...r()});return d.setItem(i.name,{state:y,version:i.version})},h=n.setState;n.setState=(y,x)=>(h(y,x),u());const f=a((...y)=>(s(...y),u()),r,n);n.getInitialState=()=>f;let I;const j=()=>{var y,x;if(!d)return;o=!1,l.forEach(w=>{var g;return w((g=r())!=null?g:f)});const b=((x=i.onRehydrateStorage)==null?void 0:x.call(i,(y=r())!=null?y:f))||void 0;return Ce(d.getItem.bind(d))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate){const g=i.migrate(w.state,w.version);return g instanceof Promise?g.then(p=>[!0,p]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var g;const[p,k]=w;if(I=i.merge(k,(g=r())!=null?g:f),s(I,!0),p)return u()}).then(()=>{b==null||b(I,void 0),I=r(),o=!0,m.forEach(w=>w(I))}).catch(w=>{b==null||b(void 0,w)})};return n.persist={setOptions:y=>{i={...i,...y},y.storage&&(d=y.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>j(),hasHydrated:()=>o,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(m.add(y),()=>{m.delete(y)})},i.skipHydration||j(),I||f},jt=vt,V=le()(jt((a,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:(s,r)=>{a({user:s,token:r,isAuthenticated:!0,isLoading:!1})},logout:()=>{a({user:null,token:null,isAuthenticated:!1,isLoading:!1})},setLoading:s=>{a({isLoading:s})},updateUser:s=>{const{user:r}=t();r&&a({user:{...r,...s}})}}),{name:"auth-storage",partialize:a=>({user:a.user,token:a.token,isAuthenticated:a.isAuthenticated})})),P=le((a,t)=>({notifications:[],addNotification:s=>{const r={...s,id:Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),read:!1};a(n=>({notifications:[r,...n.notifications]})),s.type!=="error"&&setTimeout(()=>{t().removeNotification(r.id)},5e3)},removeNotification:s=>{a(r=>({notifications:r.notifications.filter(n=>n.id!==s)}))},markAsRead:s=>{a(r=>({notifications:r.notifications.map(n=>n.id===s?{...n,read:!0}:n)}))},markAllAsRead:()=>{a(s=>({notifications:s.notifications.map(r=>({...r,read:!0}))}))},clearAll:()=>{a({notifications:[]})},getUnreadCount:()=>{const{notifications:s}=t();return s.filter(r=>!r.read).length}})),_e=({size:a="md",className:t=""})=>{const s={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};return e.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-primary-600 ${s[a]} ${t}`})},Y=le((a,t)=>({isOnline:navigator.onLine,lastSyncTime:null,pendingOperations:0,syncInProgress:!1,setOnlineStatus:s=>{a({isOnline:s})},setSyncStatus:s=>{a({syncInProgress:s})},updateLastSyncTime:s=>{a({lastSyncTime:s||new Date().toISOString()})},setPendingOperations:s=>{a({pendingOperations:Math.max(0,s)})},incrementPendingOperations:()=>{const{pendingOperations:s}=t();a({pendingOperations:s+1})},decrementPendingOperations:()=>{const{pendingOperations:s}=t();a({pendingOperations:Math.max(0,s-1)})}}));typeof window<"u"&&(window.addEventListener("online",()=>{Y.getState().setOnlineStatus(!0)}),window.addEventListener("offline",()=>{Y.getState().setOnlineStatus(!1)}));function wt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const Fe=c.forwardRef(wt);function Nt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const _t=c.forwardRef(Nt);function kt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const ae=c.forwardRef(kt);function St({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"}))}const Ct=c.forwardRef(St);function It({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Xe=c.forwardRef(It);function Dt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349M3.75 21V9.349m0 0a3.001 3.001 0 0 0 3.75-.615A2.993 2.993 0 0 0 9.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 0 0 2.25 1.016c.896 0 1.7-.393 2.25-1.015a3.001 3.001 0 0 0 3.75.614m-16.5 0a3.004 3.004 0 0 1-.621-4.72l1.189-1.19A1.5 1.5 0 0 1 5.378 3h13.243a1.5 1.5 0 0 1 1.06.44l1.19 1.189a3 3 0 0 1-.621 4.72M6.75 18h3.75a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v3.75c0 .414.336.75.75.75Z"}))}const Ot=c.forwardRef(Dt);function Pt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const et=c.forwardRef(Pt);function Et({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const ue=c.forwardRef(Et);function Rt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ce=c.forwardRef(Rt);function Tt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const pe=c.forwardRef(Tt);function At({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const Lt=c.forwardRef(At);function Ft({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const he=c.forwardRef(Ft);function $t({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"}))}const tt=c.forwardRef($t);function Mt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ye=c.forwardRef(Mt);function Ut({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const $e=c.forwardRef(Ut);function Bt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const je=c.forwardRef(Bt);function qt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const zt=c.forwardRef(qt);function Wt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Re=c.forwardRef(Wt);function Vt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const Ht=c.forwardRef(Vt);function Kt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5h3m-6.75 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-15a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 4.5v15a2.25 2.25 0 0 0 2.25 2.25Z"}))}const Qt=c.forwardRef(Kt);function Zt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Te=c.forwardRef(Zt);function Gt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Jt=c.forwardRef(Gt);function Yt({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const Xt=c.forwardRef(Yt);function es({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Ie=c.forwardRef(es);function ts({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const st=c.forwardRef(ts);function ss({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const rs=c.forwardRef(ss);function as({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const ns=c.forwardRef(as);function is({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const De=c.forwardRef(is);function os({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const rt=c.forwardRef(os);function cs({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const te=c.forwardRef(cs);function ls({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const ds=c.forwardRef(ls);function ms({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const se=c.forwardRef(ms);function us({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const we=c.forwardRef(us);function ps({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 14.25 6-6m4.5-3.493V21.75l-3.75-1.5-3.75 1.5-3.75-1.5-3.75 1.5V4.757c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0c1.1.128 1.907 1.077 1.907 2.185ZM9.75 9h.008v.008H9.75V9Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008V13.5Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const hs=c.forwardRef(ps);function xs({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const gs=c.forwardRef(xs);function ys({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const fs=c.forwardRef(ys);function bs({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const xe=c.forwardRef(bs);function vs({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const ne=c.forwardRef(vs);function js({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const ws=c.forwardRef(js);function Ns({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const at=c.forwardRef(Ns);function _s({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const ks=c.forwardRef(_s);function Ss({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const fe=c.forwardRef(Ss);function Cs({title:a,titleId:t,...s},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),a?c.createElement("title",{id:t},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const be=c.forwardRef(Cs),Oe=[{id:"prod-1",name:"Hazelnut Kunafa",description:"Premium kunafa with hazelnut toppings",category_id:"cat-1",price:219,cost_price:110,sku:"KUN001",is_available:!0,is_active:!0,sort_order:1,preparation_time:10},{id:"prod-2",name:"White Chocolate Kunafa",description:"Kunafa topped with white chocolate",category_id:"cat-1",price:219,cost_price:110,sku:"KUN002",is_available:!0,is_active:!0,sort_order:2,preparation_time:10},{id:"prod-3",name:"Pista Kunafa",description:"Kunafa with pistachio toppings",category_id:"cat-1",price:249,cost_price:125,sku:"KUN003",is_available:!0,is_active:!0,sort_order:3,preparation_time:10},{id:"prod-4",name:"Biscoff Kunafa",description:"Kunafa with biscoff cookie crumbs",category_id:"cat-1",price:209,cost_price:105,sku:"KUN004",is_available:!0,is_active:!0,sort_order:4,preparation_time:10},{id:"prod-5",name:"Hazelnut White Kunafa",description:"Kunafa with hazelnut and white chocolate",category_id:"cat-1",price:249,cost_price:125,sku:"KUN005",is_available:!0,is_active:!0,sort_order:5,preparation_time:10},{id:"prod-6",name:"Biscoff Hazelnut Kunafa",description:"Kunafa with biscoff and hazelnut",category_id:"cat-1",price:259,cost_price:130,sku:"KUN006",is_available:!0,is_active:!0,sort_order:6,preparation_time:10},{id:"prod-7",name:"Pista White Kunafa",description:"Kunafa with pistachio and white chocolate",category_id:"cat-1",price:259,cost_price:130,sku:"KUN007",is_available:!0,is_active:!0,sort_order:7,preparation_time:10},{id:"prod-8",name:"Hazelnut Pista Kunafa",description:"Kunafa with hazelnut and pistachio",category_id:"cat-1",price:259,cost_price:130,sku:"KUN008",is_available:!0,is_active:!0,sort_order:8,preparation_time:10},{id:"prod-9",name:"Biscoff White Kunafa",description:"Kunafa with biscoff and white chocolate",category_id:"cat-1",price:259,cost_price:130,sku:"KUN009",is_available:!0,is_active:!0,sort_order:9,preparation_time:10},{id:"prod-10",name:"Pista Biscoff Kunafa",description:"Kunafa with pistachio and biscoff",category_id:"cat-1",price:259,cost_price:130,sku:"KUN010",is_available:!0,is_active:!0,sort_order:10,preparation_time:10},{id:"prod-11",name:"Coffee Hazelnut Kunafa",description:"Coffee flavored kunafa with hazelnut",category_id:"cat-1",price:249,cost_price:125,sku:"KUN011",is_available:!0,is_active:!0,sort_order:11,preparation_time:10},{id:"prod-12",name:"Pista Coffee Kunafa",description:"Coffee flavored kunafa with pistachio",category_id:"cat-1",price:259,cost_price:130,sku:"KUN012",is_available:!0,is_active:!0,sort_order:12,preparation_time:10},{id:"prod-13",name:"Choco Tsunami",description:"Signature chocolate dessert creation",category_id:"cat-2",price:189,cost_price:95,sku:"SIG001",is_available:!0,is_active:!0,sort_order:1,preparation_time:12},{id:"prod-14",name:"Mango Tsunami",description:"Signature mango dessert creation",category_id:"cat-2",price:199,cost_price:100,sku:"SIG002",is_available:!0,is_active:!0,sort_order:2,preparation_time:12},{id:"prod-15",name:"Hazelnut Mango Cyclone",description:"Hazelnut and mango signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG003",is_available:!0,is_active:!0,sort_order:3,preparation_time:12},{id:"prod-16",name:"Pista Mango Thunderstorm",description:"Pistachio and mango signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG004",is_available:!0,is_active:!0,sort_order:4,preparation_time:12},{id:"prod-17",name:"Biscoff Mango Hurricane",description:"Biscoff and mango signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG005",is_available:!0,is_active:!0,sort_order:5,preparation_time:12},{id:"prod-18",name:"Pista Hazelnut Earthquake",description:"Pistachio and hazelnut signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG006",is_available:!0,is_active:!0,sort_order:6,preparation_time:12},{id:"prod-19",name:"Pista Biscoff Tsunami",description:"Pistachio and biscoff signature dessert",category_id:"cat-2",price:249,cost_price:125,sku:"SIG007",is_available:!0,is_active:!0,sort_order:7,preparation_time:12},{id:"prod-20",name:"Coffee Mango Cyclone",description:"Coffee and mango signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG008",is_available:!0,is_active:!0,sort_order:8,preparation_time:12},{id:"prod-21",name:"Pista Coffee Earthquake",description:"Pistachio and coffee signature dessert",category_id:"cat-2",price:209,cost_price:105,sku:"SIG009",is_available:!0,is_active:!0,sort_order:9,preparation_time:12},{id:"prod-27",name:"Hazelnut Rice Tub",description:"Crispy rice with hazelnut toppings",category_id:"cat-3",price:199,cost_price:100,sku:"RIC001",is_available:!0,is_active:!0,sort_order:1,preparation_time:8},{id:"prod-28",name:"White Chocolate Rice Tub",description:"Crispy rice with white chocolate",category_id:"cat-3",price:199,cost_price:100,sku:"RIC002",is_available:!0,is_active:!0,sort_order:2,preparation_time:8},{id:"prod-29",name:"Pista Rice Tub",description:"Crispy rice with pistachio toppings",category_id:"cat-3",price:219,cost_price:110,sku:"RIC003",is_available:!0,is_active:!0,sort_order:3,preparation_time:8},{id:"prod-30",name:"Biscoff Rice Tub",description:"Crispy rice with biscoff crumbs",category_id:"cat-3",price:189,cost_price:95,sku:"RIC004",is_available:!0,is_active:!0,sort_order:4,preparation_time:8},{id:"prod-31",name:"Mixed Nuts Rice Tub",description:"Crispy rice with mixed nuts",category_id:"cat-3",price:229,cost_price:115,sku:"RIC005",is_available:!0,is_active:!0,sort_order:5,preparation_time:8},{id:"prod-32",name:"Dark Chocolate Brownie",description:"Rich dark chocolate brownie",category_id:"cat-4",price:149,cost_price:75,sku:"CHO001",is_available:!0,is_active:!0,sort_order:1,preparation_time:5},{id:"prod-33",name:"Chocolate Lava Cake",description:"Warm chocolate lava cake",category_id:"cat-4",price:169,cost_price:85,sku:"CHO002",is_available:!0,is_active:!0,sort_order:2,preparation_time:10},{id:"prod-34",name:"Chocolate Mousse Cup",description:"Creamy chocolate mousse",category_id:"cat-4",price:129,cost_price:65,sku:"CHO003",is_available:!0,is_active:!0,sort_order:3,preparation_time:3},{id:"prod-35",name:"Chocolate Truffle Cake",description:"Decadent chocolate truffle cake",category_id:"cat-4",price:189,cost_price:95,sku:"CHO004",is_available:!0,is_active:!0,sort_order:4,preparation_time:8},{id:"prod-36",name:"Hot Chocolate Fudge",description:"Warm chocolate fudge dessert",category_id:"cat-4",price:159,cost_price:80,sku:"CHO005",is_available:!0,is_active:!0,sort_order:5,preparation_time:6},{id:"prod-40",name:"Strawberry Chocolate Delight",description:"Fresh strawberries with chocolate",category_id:"cat-5",price:179,cost_price:90,sku:"FRU001",is_available:!0,is_active:!0,sort_order:1,preparation_time:8},{id:"prod-41",name:"Mango Chocolate Fusion",description:"Ripe mangoes with premium chocolate",category_id:"cat-5",price:199,cost_price:100,sku:"FRU002",is_available:!0,is_active:!0,sort_order:2,preparation_time:8},{id:"prod-42",name:"Mixed Berry Chocolate Bowl",description:"Mixed berries with dark chocolate",category_id:"cat-5",price:219,cost_price:110,sku:"FRU003",is_available:!0,is_active:!0,sort_order:3,preparation_time:10},{id:"prod-43",name:"Banana Chocolate Parfait",description:"Sliced bananas layered with chocolate",category_id:"cat-5",price:159,cost_price:80,sku:"FRU004",is_available:!0,is_active:!0,sort_order:4,preparation_time:8},{id:"prod-44",name:"Kiwi White Chocolate Mix",description:"Fresh kiwi with white chocolate",category_id:"cat-5",price:189,cost_price:95,sku:"FRU005",is_available:!0,is_active:!0,sort_order:5,preparation_time:8},{id:"prod-45",name:"Pineapple Choco Chunks",description:"Grilled pineapple with chocolate chunks",category_id:"cat-5",price:169,cost_price:85,sku:"FRU006",is_available:!0,is_active:!0,sort_order:6,preparation_time:10},{id:"prod-46",name:"Vanilla Scoop",description:"Premium vanilla ice cream",category_id:"cat-6",price:89,cost_price:45,sku:"ICE001",is_available:!0,is_active:!0,sort_order:1,preparation_time:2},{id:"prod-47",name:"Chocolate Scoop",description:"Rich chocolate ice cream",category_id:"cat-6",price:89,cost_price:45,sku:"ICE002",is_available:!0,is_active:!0,sort_order:2,preparation_time:2},{id:"prod-48",name:"Strawberry Scoop",description:"Fresh strawberry ice cream",category_id:"cat-6",price:99,cost_price:50,sku:"ICE003",is_available:!0,is_active:!0,sort_order:3,preparation_time:2},{id:"prod-49",name:"Mango Scoop",description:"Tropical mango ice cream",category_id:"cat-6",price:99,cost_price:50,sku:"ICE004",is_available:!0,is_active:!0,sort_order:4,preparation_time:2},{id:"prod-50",name:"Pistachio Scoop",description:"Premium pistachio ice cream",category_id:"cat-6",price:109,cost_price:55,sku:"ICE005",is_available:!0,is_active:!0,sort_order:5,preparation_time:2},{id:"prod-51",name:"Coffee Scoop",description:"Rich coffee flavored ice cream",category_id:"cat-6",price:99,cost_price:50,sku:"ICE006",is_available:!0,is_active:!0,sort_order:6,preparation_time:2},{id:"prod-52",name:"Cookies & Cream Scoop",description:"Cookies and cream ice cream",category_id:"cat-6",price:109,cost_price:55,sku:"ICE007",is_available:!0,is_active:!0,sort_order:7,preparation_time:2},{id:"prod-53",name:"Kulfi Scoop",description:"Traditional Indian kulfi",category_id:"cat-6",price:119,cost_price:60,sku:"ICE008",is_available:!0,is_active:!0,sort_order:8,preparation_time:2},{id:"prod-54",name:"Fresh Orange Juice",description:"Freshly squeezed orange juice",category_id:"cat-7",price:79,cost_price:40,sku:"BEV001",is_available:!0,is_active:!0,sort_order:1,preparation_time:3},{id:"prod-55",name:"Mango Lassi",description:"Creamy mango yogurt drink",category_id:"cat-7",price:89,cost_price:45,sku:"BEV002",is_available:!0,is_active:!0,sort_order:2,preparation_time:4},{id:"prod-56",name:"Cold Coffee",description:"Iced coffee with milk",category_id:"cat-7",price:99,cost_price:50,sku:"BEV003",is_available:!0,is_active:!0,sort_order:3,preparation_time:5},{id:"prod-57",name:"Chocolate Milkshake",description:"Rich chocolate milkshake",category_id:"cat-7",price:119,cost_price:60,sku:"BEV004",is_available:!0,is_active:!0,sort_order:4,preparation_time:6},{id:"prod-58",name:"Strawberry Shake",description:"Fresh strawberry milkshake",category_id:"cat-7",price:109,cost_price:55,sku:"BEV005",is_available:!0,is_active:!0,sort_order:5,preparation_time:6},{id:"prod-59",name:"Fresh Lime Soda",description:"Refreshing lime soda",category_id:"cat-7",price:69,cost_price:35,sku:"BEV006",is_available:!0,is_active:!0,sort_order:6,preparation_time:3},{id:"prod-60",name:"Mint Lemonade",description:"Fresh mint and lemon drink",category_id:"cat-7",price:79,cost_price:40,sku:"BEV007",is_available:!0,is_active:!0,sort_order:7,preparation_time:4},{id:"prod-61",name:"Masala Chai",description:"Traditional spiced tea",category_id:"cat-7",price:49,cost_price:25,sku:"BEV008",is_available:!0,is_active:!0,sort_order:8,preparation_time:5},{id:"prod-62",name:"Filter Coffee",description:"South Indian filter coffee",category_id:"cat-7",price:59,cost_price:30,sku:"BEV009",is_available:!0,is_active:!0,sort_order:9,preparation_time:4},{id:"prod-63",name:"Buttermilk",description:"Spiced buttermilk drink",category_id:"cat-7",price:59,cost_price:30,sku:"BEV010",is_available:!0,is_active:!0,sort_order:10,preparation_time:3},{id:"prod-64",name:"Extra Hazelnut",description:"Additional hazelnut topping",category_id:"cat-8",price:39,cost_price:20,sku:"ADD001",is_available:!0,is_active:!0,sort_order:1,preparation_time:1},{id:"prod-65",name:"Extra Pistachio",description:"Additional pistachio topping",category_id:"cat-8",price:49,cost_price:25,sku:"ADD002",is_available:!0,is_active:!0,sort_order:2,preparation_time:1},{id:"prod-66",name:"Extra White Chocolate",description:"Additional white chocolate topping",category_id:"cat-8",price:39,cost_price:20,sku:"ADD003",is_available:!0,is_active:!0,sort_order:3,preparation_time:1},{id:"prod-67",name:"Extra Biscoff",description:"Additional biscoff crumbs",category_id:"cat-8",price:35,cost_price:18,sku:"ADD004",is_available:!0,is_active:!0,sort_order:4,preparation_time:1},{id:"prod-68",name:"Extra Honey",description:"Premium honey drizzle",category_id:"cat-8",price:25,cost_price:13,sku:"ADD006",is_available:!0,is_active:!0,sort_order:6,preparation_time:1},{id:"prod-69",name:"Extra Chocolate Sauce",description:"Rich chocolate sauce",category_id:"cat-8",price:29,cost_price:15,sku:"ADD007",is_available:!0,is_active:!0,sort_order:7,preparation_time:1},{id:"prod-70",name:"Extra Ice Cream Scoop",description:"Additional ice cream scoop for sharing",category_id:"cat-8",price:29,cost_price:15,sku:"ADD005",is_available:!0,is_active:!0,sort_order:5,preparation_time:1}],Is=Object.freeze(Object.defineProperty({__proto__:null,smoochoProducts:Oe},Symbol.toStringTag,{value:"Module"})),nt=()=>{const[a,t]=c.useState([]),[s,r]=c.useState([]),[n,i]=c.useState(""),[o,l]=c.useState(null),[m,d]=c.useState(null),[u,h]=c.useState(!1),[f,I]=c.useState(!1),[j,y]=c.useState(""),[x,b]=c.useState("menu"),[w,g]=c.useState([]),[p,k]=c.useState(null),[D,v]=c.useState("today");c.useEffect(()=>{const T=Array.from(new Set(Oe.map(M=>M.category_id))).map((M,ct)=>({id:M,name:E(M),description:$(M),isActive:!0,sortOrder:ct+1})),z=Oe.map(M=>({id:M.id,name:M.name,description:M.description,price:M.price,categoryId:M.category_id,isAvailable:M.is_available,isVegetarian:M.is_vegetarian||!1,isSpicy:M.is_spicy||!1,preparationTime:M.preparation_time||10,calories:M.calories||0})),Se=[{id:"1",orderNumber:"ORD-001",customerName:"John Doe",items:[{name:"Hazelnut Kunafa",quantity:2,price:219},{name:"Chocolate Mousse Cup",quantity:1,price:129}],total:567,orderDate:new Date,status:"completed",paymentMethod:"Cash",tableNumber:"T1"},{id:"2",orderNumber:"ORD-002",customerName:"Jane Smith",items:[{name:"Pista Kunafa",quantity:1,price:249},{name:"Vanilla Scoop",quantity:2,price:89}],total:427,orderDate:new Date(Date.now()-864e5),status:"completed",paymentMethod:"Card",tableNumber:"T3"},{id:"3",orderNumber:"ORD-003",customerName:"Mike Johnson",items:[{name:"White Chocolate Kunafa",quantity:1,price:219},{name:"Fresh Orange Juice",quantity:2,price:99}],total:417,orderDate:new Date(Date.now()-1728e5),status:"completed",paymentMethod:"UPI",tableNumber:"T2"}];t(T),r(z),g(Se),T.length>0&&i(T[0].id)},[]);const E=N=>({"cat-1":"Kunafa Bowls","cat-2":"Chocolate Delights","cat-3":"Fruits Choco Mix","cat-4":"Ice Creams","cat-5":"Beverages","cat-6":"Add-ons"})[N]||"Unknown Category",$=N=>({"cat-1":"Premium kunafa desserts with various toppings","cat-2":"Rich chocolate desserts and mousses","cat-3":"Fresh fruits paired with premium chocolate","cat-4":"Premium ice cream varieties","cat-5":"Refreshing beverages and drinks","cat-6":"Additional toppings and extras"})[N]||"Delicious items",C=N=>{const T={...N,id:`cat-${Date.now()}`};t([...a,T]),h(!1)},R=(N,T)=>{t(a.map(z=>z.id===N?{...z,...T}:z)),l(null)},O=N=>{var T;window.confirm("Are you sure you want to delete this category?")&&(t(a.filter(z=>z.id!==N)),r(s.filter(z=>z.categoryId!==N)),n===N&&i(((T=a[0])==null?void 0:T.id)||""))},W=N=>{const T={...N,id:`prod-${Date.now()}`};r([...s,T]),I(!1)},_=(N,T)=>{r(s.map(z=>z.id===N?{...z,...T}:z)),d(null)},S=N=>{window.confirm("Are you sure you want to delete this item?")&&r(s.filter(T=>T.id!==N))},A=s.filter(N=>{var T;return N.categoryId===n&&(j===""||N.name.toLowerCase().includes(j.toLowerCase())||((T=N.description)==null?void 0:T.toLowerCase().includes(j.toLowerCase())))}),L=a.find(N=>N.id===n),q=()=>{const N=new Date,T=new Date(N.getFullYear(),N.getMonth(),N.getDate()),z=new Date(T.getTime()-864e5),Se=new Date(T.getTime()-7*864e5);switch(D){case"today":return w.filter(M=>M.orderDate>=T);case"yesterday":return w.filter(M=>M.orderDate>=z&&M.orderDate<T);case"week":return w.filter(M=>M.orderDate>=Se);default:return w}},K=N=>{console.log("Reprinting order:",N.orderNumber),alert(`Reprinting order ${N.orderNumber}`)},U=N=>{k(N)},Q=N=>{const T={...N,id:`ORD-${Date.now()}`,orderNumber:`ORD-${Date.now()}`,orderDate:new Date,status:"pending"};g([T,...w]),alert(`Order duplicated as ${T.orderNumber}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>b("menu"),className:`py-4 px-1 border-b-2 font-medium text-sm ${x==="menu"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Menu Management"}),e.jsx("button",{onClick:()=>b("orders"),className:`py-4 px-1 border-b-2 font-medium text-sm ${x==="orders"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Past Orders"})]})}),e.jsx("div",{className:"p-6",children:x==="menu"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Menu Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your menu categories, items, and pricing"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(se,{className:"w-5 h-5 mr-2"}),"Add Category"]}),e.jsxs("button",{onClick:()=>I(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",disabled:!n,children:[e.jsx(se,{className:"w-5 h-5 mr-2"}),"Add Item"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsx("div",{className:"xl:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Categories"})}),e.jsx("div",{className:"p-4 space-y-2",children:a.map(N=>e.jsx("div",{className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${n===N.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>i(N.id),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:N.name}),N.description&&e.jsx("p",{className:"text-sm text-gray-600",children:N.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:T=>{T.stopPropagation(),l(N)},className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx("button",{onClick:T=>{T.stopPropagation(),O(N.id)},className:"p-1 text-red-400 hover:text-red-600 rounded",children:e.jsx(ne,{className:"w-4 h-4"})})]})]})},N.id))})]})}),e.jsx("div",{className:"xl:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:L?L.name:"Select Category"}),L&&e.jsxs("p",{className:"text-sm text-gray-600",children:[A.length," items"]})]}),L&&e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"text",placeholder:"Search items...",value:j,onChange:N=>y(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})})]})}),e.jsx("div",{className:"p-4",children:L?e.jsx("div",{className:"space-y-4",children:A.map(N=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:N.name}),e.jsxs("span",{className:"text-lg font-bold text-primary-600",children:["₹",N.price]})]}),N.description&&e.jsx("p",{className:"text-gray-600 mb-2",children:N.description}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[N.isVegetarian&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Vegetarian"}),N.isSpicy&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:"Spicy"}),N.preparationTime&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[N.preparationTime," min"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(N),className:"p-2 text-gray-400 hover:text-gray-600 rounded hover:bg-gray-100",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(N.id),className:"p-2 text-red-400 hover:text-red-600 rounded hover:bg-red-100",children:e.jsx(ne,{className:"w-4 h-4"})})]})]})},N.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Select a category to view and manage items"})})]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Past Orders"}),e.jsx("p",{className:"text-gray-600",children:"View and manage completed orders"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("select",{value:D,onChange:N=>v(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"week",children:"This Week"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:D==="today"?"Today's Orders":D==="yesterday"?"Yesterday's Orders":"This Week's Orders"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[q().map(N=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:N.orderNumber}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:N.status}),N.tableNumber&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:N.tableNumber})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-600",children:[e.jsx(at,{className:"w-4 h-4"}),e.jsx("span",{children:N.customerName}),e.jsx(je,{className:"w-4 h-4 ml-2"}),e.jsx("span",{children:N.paymentMethod})]}),e.jsx("div",{className:"space-y-1",children:N.items.map((T,z)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[T.quantity,"x ",T.name]}),e.jsxs("span",{children:["₹",T.price*T.quantity]})]},z))}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-semibold text-lg",children:["Total: ₹",N.total]}),e.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(et,{className:"w-3 h-3"}),N.orderDate.toLocaleDateString()," at ",N.orderDate.toLocaleTimeString()]})]})})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>U(N),className:"p-2 text-blue-400 hover:text-blue-600 rounded hover:bg-blue-100",title:"Edit Order",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>K(N),className:"p-2 text-green-400 hover:text-green-600 rounded hover:bg-green-100",title:"Reprint Receipt",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Q(N),className:"p-2 text-purple-400 hover:text-purple-600 rounded hover:bg-purple-100",title:"Duplicate Order",children:e.jsx(Xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(N),className:"p-2 text-gray-400 hover:text-gray-600 rounded hover:bg-gray-100",title:"View Details",children:e.jsx(st,{className:"w-4 h-4"})})]})]})},N.id)),q().length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No orders found for the selected period"})]})})]})]})})]}),u&&e.jsx(Me,{onSubmit:C,onCancel:()=>h(!1)}),o&&e.jsx(Me,{category:o,onSubmit:N=>R(o.id,N),onCancel:()=>l(null),isEditing:!0}),f&&e.jsx(Ue,{categories:a,onSubmit:W,onCancel:()=>I(!1)}),m&&e.jsx(Ue,{item:m,categories:a,onSubmit:N=>_(m.id,N),onCancel:()=>d(null),isEditing:!0}),p&&e.jsx(Ds,{order:p,onClose:()=>k(null),onReprint:()=>K(p),onDuplicate:()=>Q(p)})]})},Me=({category:a,onSubmit:t,onCancel:s,isEditing:r=!1})=>{const[n,i]=c.useState({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||"",isActive:(a==null?void 0:a.isActive)??!0,sortOrder:(a==null?void 0:a.sortOrder)||1}),o=l=>{l.preventDefault(),t(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:r?"Edit Category":"Add New Category"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",value:n.name,onChange:l=>i({...n,name:l.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:l=>i({...n,description:l.target.value}),className:"form-textarea",rows:3})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.isActive,onChange:l=>i({...n,isActive:l.target.checked}),className:"w-4 h-4"}),"Active"]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Sort Order"}),e.jsx("input",{type:"number",value:n.sortOrder,onChange:l=>i({...n,sortOrder:parseInt(l.target.value)}),className:"form-input w-20",min:"1"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:r?"Update":"Create"}),e.jsx("button",{type:"button",onClick:s,className:"btn btn-secondary flex-1",children:"Cancel"})]})]})]})})})},Ue=({item:a,categories:t,onSubmit:s,onCancel:r,isEditing:n=!1})=>{var m;const[i,o]=c.useState({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||"",price:(a==null?void 0:a.price)||0,categoryId:(a==null?void 0:a.categoryId)||((m=t[0])==null?void 0:m.id)||"",image:(a==null?void 0:a.image)||"",isAvailable:(a==null?void 0:a.isAvailable)??!0,isVegetarian:(a==null?void 0:a.isVegetarian)??!1,isSpicy:(a==null?void 0:a.isSpicy)??!1,preparationTime:(a==null?void 0:a.preparationTime)||0,calories:(a==null?void 0:a.calories)||0}),l=d=>{d.preventDefault(),s(i)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:n?"Edit Menu Item":"Add New Menu Item"}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",value:i.name,onChange:d=>o({...i,name:d.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("select",{value:i.categoryId,onChange:d=>o({...i,categoryId:d.target.value}),className:"form-select",required:!0,children:t.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:d=>o({...i,description:d.target.value}),className:"form-textarea",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Price ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.price,onChange:d=>o({...i,price:parseFloat(d.target.value)}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Preparation Time (min)"}),e.jsx("input",{type:"number",min:"0",value:i.preparationTime,onChange:d=>o({...i,preparationTime:parseInt(d.target.value)}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Calories"}),e.jsx("input",{type:"number",min:"0",value:i.calories,onChange:d=>o({...i,calories:parseInt(d.target.value)}),className:"form-input"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.isAvailable,onChange:d=>o({...i,isAvailable:d.target.checked}),className:"w-4 h-4"}),"Available"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.isVegetarian,onChange:d=>o({...i,isVegetarian:d.target.checked}),className:"w-4 h-4"}),"Vegetarian"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.isSpicy,onChange:d=>o({...i,isSpicy:d.target.checked}),className:"w-4 h-4"}),"Spicy"]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:n?"Update":"Create"}),e.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary flex-1",children:"Cancel"})]})]})]})})})},Ds=({order:a,onClose:t,onReprint:s,onDuplicate:r})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Order Number:"})," ",a.orderNumber]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Customer:"})," ",a.customerName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Payment Method:"})," ",a.paymentMethod]}),a.tableNumber&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Table:"})," ",a.tableNumber]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Status:"})," ",a.status]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Total:"})," ₹",a.total]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",a.orderDate.toLocaleDateString()," at ",a.orderDate.toLocaleTimeString()]})]})]}),e.jsx("h4",{className:"text-md font-semibold mb-3",children:"Items:"}),e.jsx("div",{className:"space-y-2",children:a.items.map((n,i)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{children:[n.quantity,"x ",n.name]}),e.jsxs("span",{children:["₹",n.price*n.quantity]})]},i))}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:s,className:"btn btn-primary",children:"Reprint Receipt"}),e.jsx("button",{onClick:r,className:"btn btn-secondary",children:"Duplicate Order"}),e.jsx("button",{onClick:t,className:"btn btn-danger",children:"Close"})]})]})})}),it=({isOpen:a,onClose:t,isPage:s=!1})=>{const[r,n]=c.useState("general"),[i,o]=c.useState({business:{name:"Smoocho Dessert Shop",address:"123 Sweet Street, Dessert City",phone:"+1 (555) 123-4567",email:"info@smoocho.com",taxRate:8.5,currency:"USD"},printer:{enabled:!0,model:"Star TSP100",paperSize:"80mm"},security:{requirePin:!0,sessionTimeout:30,maxLoginAttempts:3},notifications:{email:!0,whatsapp:!1,lowStock:!0}}),l=(d,u,h)=>{o(f=>({...f,[d]:{...f[d],[u]:h}}))},m=[{id:"general",name:"General",icon:ye},{id:"business",name:"Business",icon:Re},{id:"printer",name:"Printer",icon:we},{id:"security",name:"Security",icon:gs},{id:"notifications",name:"Notifications",icon:Xe},{id:"appearance",name:"Appearance",icon:rs},{id:"system",name:"System",icon:Qt}];return s?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:m.map(d=>{const u=d.icon;return e.jsxs("button",{onClick:()=>n(d.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${r===d.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(u,{className:"w-5 h-5 inline mr-2"}),d.name]},d.id)})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r==="general"&&e.jsx(Be,{settings:i,updateSetting:l}),r==="business"&&e.jsx(qe,{settings:i,updateSetting:l}),r==="printer"&&e.jsx(ze,{settings:i,updateSetting:l}),r==="security"&&e.jsx(We,{settings:i,updateSetting:l}),r==="notifications"&&e.jsx(Ve,{settings:i,updateSetting:l}),r==="appearance"&&e.jsx(He,{settings:i,updateSetting:l}),r==="system"&&e.jsx(Ke,{settings:i,updateSetting:l})]})]}):a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Settings"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(be,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"w-64 bg-gray-50 p-4",children:e.jsx("nav",{className:"space-y-2",children:m.map(d=>{const u=d.icon;return e.jsxs("button",{onClick:()=>n(d.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${r===d.id?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{children:d.name})]},d.id)})})}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[r==="general"&&e.jsx(Be,{settings:i,updateSetting:l}),r==="business"&&e.jsx(qe,{settings:i,updateSetting:l}),r==="printer"&&e.jsx(ze,{settings:i,updateSetting:l}),r==="security"&&e.jsx(We,{settings:i,updateSetting:l}),r==="notifications"&&e.jsx(Ve,{settings:i,updateSetting:l}),r==="appearance"&&e.jsx(He,{settings:i,updateSetting:l}),r==="system"&&e.jsx(Ke,{settings:i,updateSetting:l})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{t()},className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700",children:"Save Changes"})]})]})}):null},Be=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"General Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Language"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Spanish"}),e.jsx("option",{children:"French"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Timezone"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"UTC"}),e.jsx("option",{children:"EST"}),e.jsx("option",{children:"PST"})]})]})]})]}),qe=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Business Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Name"}),e.jsx("input",{type:"text",value:a.business.name,onChange:s=>t("business","name",s.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",value:a.business.taxRate,onChange:s=>t("business","taxRate",parseFloat(s.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]})]})]}),ze=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Printer Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.printer.enabled,onChange:s=>t("printer","enabled",s.target.checked),className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Enable Printer"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Paper Size"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"80mm"}),e.jsx("option",{children:"58mm"})]})]})]})]}),We=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Security Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.security.requirePin,onChange:s=>t("security","requirePin",s.target.checked),className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Require PIN for sensitive operations"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Session Timeout (minutes)"}),e.jsx("input",{type:"number",value:a.security.sessionTimeout,onChange:s=>t("security","sessionTimeout",parseInt(s.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]})]})]}),Ve=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Notification Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.notifications.email,onChange:s=>t("notifications","email",s.target.checked),className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Email notifications"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.notifications.lowStock,onChange:s=>t("notifications","lowStock",s.target.checked),className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Low stock alerts"})]})})]})]}),He=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Appearance Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Theme"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"Light"}),e.jsx("option",{children:"Dark"}),e.jsx("option",{children:"Auto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Font Size"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"Small"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"Large"})]})]})]})]}),Ke=({settings:a,updateSetting:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"System Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Auto-sync Interval"}),e.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{children:"5 minutes"}),e.jsx("option",{children:"15 minutes"}),e.jsx("option",{children:"30 minutes"}),e.jsx("option",{children:"1 hour"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data Retention (days)"}),e.jsx("input",{type:"number",defaultValue:30,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]})]})]}),re=({children:a,title:t="Smoocho POS",showBackButton:s=!1,onBack:r})=>{const n=Je(),i=mt();console.log("🔍 PremiumLayout rendering:",{title:t,location:i.pathname});const o=[{name:"Dashboard",href:"/dashboard",icon:ns,current:i.pathname==="/dashboard"},{name:"POS",href:"/pos",icon:xe,current:i.pathname==="/pos"},{name:"Menu Editor",href:"/menu-editor",icon:te,current:i.pathname==="/menu-editor"},{name:"Inventory",href:"/inventory",icon:zt,current:i.pathname==="/inventory"},{name:"Reports",href:"/reports",icon:ue,current:i.pathname==="/reports"},{name:"Integrations",href:"/integrations",icon:$e,current:i.pathname==="/integrations"},{name:"Updates",href:"/updates",icon:tt,current:i.pathname==="/updates"},{name:"Settings",href:"/settings",icon:$e,current:i.pathname==="/settings"}],l=()=>{r?r():n(-1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-neutral-50 to-neutral-100",children:[e.jsx("header",{className:"bg-white shadow-lg border-b border-neutral-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[s&&e.jsx("button",{onClick:l,className:"p-2 rounded-lg hover:bg-neutral-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500",children:e.jsx(_t,{className:"w-6 h-6 text-neutral-600"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-primary-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"🍰"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-neutral-900",children:t}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Professional POS System"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{className:"relative p-2 rounded-lg hover:bg-neutral-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx(Xe,{className:"w-6 h-6 text-neutral-600"}),e.jsx("span",{className:"absolute top-1 right-1 w-3 h-3 bg-red-500 rounded-full"})]}),e.jsxs("button",{className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-neutral-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-400 to-primary-500 rounded-full flex items-center justify-center",children:e.jsx(at,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"hidden sm:block text-sm font-medium text-neutral-700",children:"Admin"})]})]})]})})}),e.jsxs("div",{className:"flex",children:[e.jsx("nav",{className:"w-64 bg-red-500 shadow-xl border-r border-neutral-200 min-h-screen",style:{display:"block !important",opacity:"1 !important"},children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-white text-center mb-4 p-2 bg-red-600 rounded",children:"🔍 SIDEBAR VISIBLE - DEBUG MODE"}),e.jsx("div",{className:"space-y-2",children:o.map(m=>{const d=m.icon;return e.jsxs("a",{href:m.href,className:`group flex items-center space-x-3 px-4 py-3 rounded-xl font-medium transition-all duration-200 ${m.current?"bg-primary-50 text-primary-700 border-r-4 border-primary-500 shadow-sm":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[e.jsx(d,{className:`w-6 h-6 transition-colors duration-200 ${m.current?"text-primary-600":"text-neutral-400 group-hover:text-neutral-600"}`}),e.jsx("span",{className:"text-sm",children:m.name})]},m.name)})}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-r from-emerald-50 to-emerald-100 rounded-xl border border-emerald-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-emerald-800",children:"System Online"})]}),e.jsx("p",{className:"text-xs text-emerald-600 mt-1",children:"All services running smoothly"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"p-3 bg-neutral-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-neutral-600",children:"Today's Sales"}),e.jsx("span",{className:"text-sm font-semibold text-neutral-900",children:"₹12,450"})]})}),e.jsx("div",{className:"p-3 bg-neutral-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-neutral-600",children:"Orders"}),e.jsx("span",{className:"text-sm font-semibold text-neutral-900",children:"24"})]})})]})]})}),e.jsx("main",{className:"flex-1 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:a})})]}),e.jsx("footer",{className:"bg-white border-t border-neutral-200 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-neutral-500",children:"© 2024 Smoocho POS System"}),e.jsx("span",{className:"text-xs text-neutral-400",children:"•"}),e.jsx("span",{className:"text-sm text-neutral-500",children:"Version 2.0.0"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-xs text-neutral-400",children:"Offline Mode: Active"}),e.jsx("span",{className:"text-xs text-neutral-400",children:"•"}),e.jsx("span",{className:"text-xs text-neutral-400",children:"Sync: Real-time"})]})]})})})]})},Os=()=>{const{user:a}=V(),{isOnline:t,pendingOperations:s}=Y(),r=Je(),[n,i]=c.useState(!1),[o,l]=c.useState(!1),m=[{name:"Today's Sales",value:"₹12,485",change:"+12%",changeType:"positive",icon:Re},{name:"Orders Today",value:"47",change:"+8%",changeType:"positive",icon:xe},{name:"Low Stock Items",value:"3",change:"Alert",changeType:"negative",icon:Fe},{name:"Active Items",value:"124",change:"2 new",changeType:"neutral",icon:ks}],d=[{name:"New Order",description:"Start a new POS order",icon:xe,color:"bg-green-500",action:()=>r("/pos")},{name:"Manage Inventory",description:"Update stock levels",icon:Fe,color:"bg-blue-500",action:()=>r("/inventory")},{name:"Edit Menu",description:"Manage menu items & prices",icon:te,color:"bg-purple-500",action:()=>i(!0)},{name:"Settings",description:"Configure system preferences",icon:ye,color:"bg-gray-500",action:()=>l(!0)},{name:"View Reports",description:"Sales and analytics",icon:ue,color:"bg-indigo-500",action:()=>r("/reports")},{name:"Recent Orders",description:"View order history",icon:he,color:"bg-orange-500",action:()=>r("/orders")}];return e.jsx(re,{title:"Dashboard",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-secondary-900",children:["Welcome back, ",(a==null?void 0:a.username)||"Admin","!"]}),e.jsx("p",{className:"mt-1 text-sm text-secondary-600",children:"Here's what's happening at your dessert shop today."})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsxs("div",{className:`
              flex items-center px-3 py-2 rounded-lg text-sm font-medium
              ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}
            `,children:[e.jsx("div",{className:`
                w-2 h-2 rounded-full mr-2
                ${t?"bg-green-500":"bg-red-500"}
              `}),t?"Online":"Offline"]}),s>0&&e.jsxs("div",{className:"flex items-center px-3 py-2 rounded-lg text-sm font-medium bg-amber-100 text-amber-800",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),s," pending"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:m.map(u=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(u.icon,{className:"w-5 h-5 text-primary-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-secondary-500",children:u.name}),e.jsx("p",{className:"text-2xl font-semibold text-secondary-900",children:u.value}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:`
                      text-sm font-medium
                      ${u.changeType==="positive"?"text-green-600":u.changeType==="negative"?"text-red-600":"text-secondary-600"}
                    `,children:u.change})})]})]})},u.name))}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-secondary-900 mb-4",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(u=>e.jsx("button",{onClick:u.action,className:"card hover:shadow-lg transition-shadow duration-200 text-left touch-feedback",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`
                    flex-shrink-0 w-12 h-12 ${u.color} rounded-lg 
                    flex items-center justify-center
                  `,children:e.jsx(u.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-secondary-900",children:u.name}),e.jsx("p",{className:"text-xs text-secondary-500 mt-1",children:u.description})]})]})},u.name))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-secondary-900 mb-4",children:"Recent Activity"}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"space-y-4",children:[{time:"2 min ago",action:"Order #1234 completed",amount:"₹450"},{time:"15 min ago",action:"Stock updated: Chocolate Cake",amount:"+5 units"},{time:"1 hour ago",action:"Order #1233 completed",amount:"₹320"},{time:"2 hours ago",action:"Low stock alert: Vanilla Extract",amount:"2 units left"}].map((u,h)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-secondary-100 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-secondary-900",children:u.action}),e.jsx("p",{className:"text-xs text-secondary-500",children:u.time})]}),e.jsx("div",{className:"text-sm font-medium text-secondary-600",children:u.amount})]},h))})})]}),n&&e.jsx(nt,{}),o&&e.jsx(it,{isOpen:o,onClose:()=>l(!1)})]})})},Ps="modulepreload",Es=function(a){return"/"+a},Qe={},Rs=function(t,s,r){let n=Promise.resolve();if(s&&s.length>0){let o=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),m=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=o(s.map(d=>{if(d=Es(d),d in Qe)return;Qe[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ps,u||(f.as="script"),f.crossOrigin="",f.href=d,m&&f.setAttribute("nonce",m),document.head.appendChild(f),u)return new Promise((I,j)=>{f.addEventListener("load",I),f.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Ts=.05,ve=le((a,t)=>({items:[],subtotal:0,discount_amount:0,discount_type:void 0,tax_amount:0,total_amount:0,order_type:"dine_in",table_number:void 0,customer_info:void 0,addItem:(s,r=1,n="")=>{console.log("🛟 Adding item to cart:",{product:s.name,quantity:r,specialInstructions:n});const{items:i}=t(),o=i.findIndex(m=>m.product.id===s.id&&m.special_instructions===n);let l;if(o>=0)l=i.map((m,d)=>d===o?{...m,quantity:m.quantity+r,item_total:(m.quantity+r)*s.price}:m),console.log("🔄 Updated existing cart item");else{const m={product:s,quantity:r,special_instructions:n,item_total:r*s.price};l=[...i,m],console.log("➕ Added new cart item")}a({items:l}),console.log("🛟 Cart updated, total items:",l.length),t().calculateTotals()},removeItem:s=>{const{items:r}=t(),n=r.filter(i=>i.product.id!==s);a({items:n}),t().calculateTotals()},updateQuantity:(s,r)=>{const{items:n}=t();if(r<=0){t().removeItem(s);return}const i=n.map(o=>o.product.id===s?{...o,quantity:r,item_total:r*o.product.price}:o);a({items:i}),t().calculateTotals()},updateSpecialInstructions:(s,r)=>{const{items:n}=t(),i=n.map(o=>o.product.id===s?{...o,special_instructions:r}:o);a({items:i})},applyDiscount:(s,r="fixed")=>{a({discount_amount:s,discount_type:r}),t().calculateTotals()},removeDiscount:()=>{a({discount_amount:0,discount_type:void 0}),t().calculateTotals()},calculateTotals:()=>{const{items:s,discount_amount:r,discount_type:n}=t(),i=s.reduce((u,h)=>u+h.item_total,0);let o=0;r>0&&(n==="percentage"?o=i*r/100:o=Math.min(r,i));const l=i-o,m=l*Ts,d=l+m;a({subtotal:i,discount_amount:o,tax_amount:m,total_amount:d})},clearCart:()=>{a({items:[],subtotal:0,discount_amount:0,discount_type:void 0,tax_amount:0,total_amount:0})},getItemCount:()=>{const{items:s}=t();return s.reduce((r,n)=>r+n.quantity,0)},getItemCountById:s=>{const{items:r}=t(),n=r.find(i=>i.product.id===s);return n?n.quantity:0},removeItemById:(s,r=1)=>{const{items:n}=t(),i=n.findIndex(o=>o.product.id===s);if(i>=0){if(n[i].quantity<=r){const l=n.filter((m,d)=>d!==i);a({items:l})}else{const l=n.map((m,d)=>d===i?{...m,quantity:m.quantity-r,item_total:(m.quantity-r)*m.product.price}:m);a({items:l})}t().calculateTotals()}}})),ge={app:{name:"Smoocho Bill",version:"1.0.0",description:"Touch-optimized POS & Inventory Management System",defaultLanguage:"en",deviceType:"tablet"},api:{baseUrl:"http://localhost:5000",timeout:3e4,retryAttempts:3,retryDelay:1e3},websocket:{url:"ws://localhost:5000",reconnectAttempts:5,reconnectDelay:1e3,pingInterval:3e4},sync:{interval:300*1e3,batchSize:50,maxRetries:3,backoffDelay:1e3,autoSyncOnReconnect:!0},ui:{touchTargetSize:80,animationDuration:150,debounceDelay:200,toastDuration:4e3,tablet:{gridColumns:4,itemSpacing:16,fontSize:{small:"14px",medium:"16px",large:"20px",xlarge:"24px"},buttonHeight:60,inputHeight:56,cardPadding:20},mobile:{gridColumns:2,itemSpacing:12,fontSize:{small:"12px",medium:"14px",large:"18px",xlarge:"22px"},buttonHeight:50,inputHeight:48,cardPadding:16}},business:{taxRate:.05,currency:{code:"INR",symbol:"₹",decimals:2},orderNumberPrefix:"SMO",receiptFooter:"Thank you for choosing Smoocho!",lowStockThreshold:10},storage:{tokenKey:"smoocho-auth-token",maxCacheSize:100*1024*1024,cacheExpiry:1440*60*1e3,dbName:"SmoochoOfflineDB",dbVersion:1},print:{thermalPrinterWidth:48,paperSizes:{thermal58mm:{width:48,name:"58mm Thermal"},thermal80mm:{width:64,name:"80mm Thermal"},a4:{width:80,name:"A4 Paper"}},defaultPaperSize:"thermal80mm",tablet:{enableBuiltInPrinter:!0,printPreview:!0,autoPrint:!1,printQuality:"high",margins:{top:10,bottom:10,left:10,right:10}},receipt:{headerLogo:!0,showQRCode:!0,showTaxBreakdown:!0,showPaymentMethod:!0,showCashierInfo:!0,footerMessage:!0}},payments:{supportedMethods:["cash","card","upi","wallet"],paytm:{environment:"staging",website:"WEBSTAGING"},tablet:{enableCardReader:!0,enableBarcodeScanner:!0,enableNFC:!0,showPaymentKeyboard:!0}},integrations:{zomato:{enabled:!1,apiUrl:"https://api.zomato.com/v2.1",webhookEndpoint:"/api/webhooks/zomato"},swiggy:{enabled:!1,apiUrl:"https://api.swiggy.com/v1",webhookEndpoint:"/api/webhooks/swiggy"},whatsapp:{enabled:!1,provider:"twilio",sendReceipt:!0,sendOrderUpdates:!0}},performance:{enableServiceWorker:!0,enableOfflineMode:!0,enableBackgroundSync:!0,enablePushNotifications:!0,cacheStrategies:{images:"cache-first",api:"network-first",static:"cache-first"},tablet:{enableHardwareAcceleration:!0,enableTouchGestures:!0,enableSwipeNavigation:!0,enablePinchZoom:!1,enableOrientationLock:"landscape"}},accessibility:{enableHighContrast:!0,enableLargeText:!0,enableScreenReader:!0,enableKeyboardNavigation:!0,enableVoiceCommands:!1,tablet:{enableHapticFeedback:!0,enableSoundEffects:!0,enableVisualCues:!0,enableTouchAssist:!0}}},As=ge.api.baseUrl;class Ls{constructor(){B(this,"baseUrl",`${As}/inventory`)}async fetchWithAuth(t,s={}){const r=localStorage.getItem("auth_token"),n=await fetch(t,{...s,headers:{"Content-Type":"application/json",Authorization:r?`Bearer ${r}`:"",...s.headers}});if(!n.ok){const i=await n.json().catch(()=>({message:"Request failed"}));throw new Error(i.message||`HTTP ${n.status}`)}return n.json()}async getAllItems(t){const s=new URLSearchParams;t&&Object.entries(t).forEach(([i,o])=>{o!==void 0&&s.append(i,o.toString())});const r=`${this.baseUrl}/items${s.toString()?`?${s.toString()}`:""}`;return(await this.fetchWithAuth(r)).data}async getItemById(t){return(await this.fetchWithAuth(`${this.baseUrl}/items/${t}`)).data}async createItem(t){return(await this.fetchWithAuth(`${this.baseUrl}/items`,{method:"POST",body:JSON.stringify(t)})).data}async updateItem(t,s){return(await this.fetchWithAuth(`${this.baseUrl}/items/${t}`,{method:"PUT",body:JSON.stringify(s)})).data}async deleteItem(t){await this.fetchWithAuth(`${this.baseUrl}/items/${t}`,{method:"DELETE"})}async addStockTransaction(t){return(await this.fetchWithAuth(`${this.baseUrl}/transactions`,{method:"POST",body:JSON.stringify(t)})).data}async getLowStockAlerts(){return(await this.fetchWithAuth(`${this.baseUrl}/alerts/low-stock`)).data}async getExpiringItems(t=7){return(await this.fetchWithAuth(`${this.baseUrl}/alerts/expiring?days=${t}`)).data}async getStockUsageReport(t,s){const r=new URLSearchParams({startDate:t,endDate:s});return(await this.fetchWithAuth(`${this.baseUrl}/reports/usage?${r.toString()}`)).data}async getStockSummary(){return(await this.fetchWithAuth(`${this.baseUrl}/summary`)).data}async checkStockAvailability(t){return(await this.fetchWithAuth(`${this.baseUrl}/check-availability`,{method:"POST",body:JSON.stringify({productIds:t})})).data}async bulkUpdateStock(t){return(await this.fetchWithAuth(`${this.baseUrl}/bulk-update`,{method:"POST",body:JSON.stringify({updates:t})})).data}async importInventory(t){return(await this.fetchWithAuth(`${this.baseUrl}/import`,{method:"POST",body:JSON.stringify({items:t})})).data}async syncPendingChanges(){console.log("Syncing pending inventory changes...")}async getItemsNeedingRestock(){return this.getAllItems({lowStock:!0})}async getInventoryValue(){return(await this.getAllItems()).reduce((s,r)=>{const n=r.cost_per_unit||0,i=r.current_stock||0;return s+n*i},0)}async getItemsByCategory(t){return this.getAllItems({search:t})}async checkItemStock(t,s){try{return((await this.getItemById(t)).current_stock||0)>=s}catch{return!1}}async getDailyUsage(t,s=7){const r=new Date,n=new Date;n.setDate(n.getDate()-s);const o=(await this.getStockUsageReport(n.toISOString().split("T")[0],r.toISOString().split("T")[0])).find(l=>l.inventory_item.id===t);return o?o.total_used/s:0}async calculateReorderPoint(t,s=3){const r=await this.getDailyUsage(t);return Math.ceil(r*s*1.2)}async getRestockSuggestions(){const t=await this.getLowStockAlerts(),s=[];for(const r of t){const n=await this.calculateReorderPoint(r.id),i=Math.max(n-(r.current_stock||0),r.minimum_stock||0);s.push({item:r,suggested_order_quantity:i,reason:(r.current_stock||0)<=0?"Out of stock":"Below minimum threshold"})}return s}}const F=new Ls;class Fs{async validateOrderStock(t){const s={isValid:!0,insufficientItems:[],warnings:[]},r=await F.getAllItems({isActive:!0}),n=new Map(r.map(o=>[o.id,o])),i=new Map;for(const o of t){const{product:l,quantity:m}=o;if(!(!l.recipe_items||!Array.isArray(l.recipe_items)))for(const d of l.recipe_items){const u=d.quantity*m,h=i.get(d.inventory_item_id)||0;i.set(d.inventory_item_id,h+u)}}for(const[o,l]of i.entries()){const m=n.get(o);if(!m){s.isValid=!1,s.insufficientItems.push({item_name:"Unknown Item",required:l,available:0,unit:"unknown"});continue}const d=m.current_stock||0;d<l?(s.isValid=!1,s.insufficientItems.push({item_name:m.name,required:l,available:d,unit:m.unit})):d<l+(m.minimum_stock||0)&&s.warnings.push({item_name:m.name,message:`Stock will go below minimum threshold (${m.minimum_stock})`})}return s}async processStockDeduction(t,s,r){const n={success:!0,deductedItems:[],errors:[]};try{const i=await this.validateOrderStock(s);if(!i.isValid)return n.success=!1,n.errors=i.insufficientItems.map(o=>`Insufficient ${o.item_name}: need ${o.required} ${o.unit}, have ${o.available} ${o.unit}`),n;if(i.warnings.length>0)for(const o of i.warnings)P.getState().addNotification({type:"warning",title:"Stock Warning",message:`${o.item_name}: ${o.message}`});for(const o of s){const{product:l,quantity:m}=o;if(!(!l.recipe_items||!Array.isArray(l.recipe_items)))for(const d of l.recipe_items){const u=d.quantity*m;try{await F.addStockTransaction({inventory_item_id:d.inventory_item_id,transaction_type:"OUT",quantity:u,reference_type:"ORDER",reference_id:t,notes:`Auto-deduction for ${l.name} (Qty: ${m})`});const h=await F.getItemById(d.inventory_item_id);n.deductedItems.push({inventory_item_id:d.inventory_item_id,item_name:h.name,quantity_deducted:u,unit:h.unit})}catch(h){n.success=!1,n.errors.push(`Failed to deduct ${d.inventory_item_id}: ${h.message}`)}}}return n.errors.length>0&&(n.success=!1),n}catch(i){return n.success=!1,n.errors.push(`Stock deduction failed: ${i.message}`),n}}async calculateProjectedStock(t){const s=new Map,r=await F.getAllItems({isActive:!0}),n=new Map(r.map(o=>[o.id,o])),i=new Map;for(const o of t){const{product:l,quantity:m}=o;if(!(!l.recipe_items||!Array.isArray(l.recipe_items)))for(const d of l.recipe_items){const u=d.quantity*m,h=i.get(d.inventory_item_id)||0;i.set(d.inventory_item_id,h+u)}}for(const[o,l]of i.entries()){const m=n.get(o);if(m){const d=m.current_stock||0,u=d-l;s.set(o,{current:d,projected:u,item:m})}}return s}async getItemsBelowMinimumAfterOrder(t){const s=await this.calculateProjectedStock(t),r=[];for(const[n,i]of s.entries()){const{current:o,projected:l,item:m}=i,d=m.minimum_stock||0;l<d&&r.push({item:m,current_stock:o,projected_stock:l,minimum_stock:d})}return r}async checkProductsAvailability(t){const s=new Map;try{const r=await F.checkStockAvailability(t);for(const n of r)s.set(n.product_id,n.is_available)}catch(r){console.error("Failed to check product availability:",r);for(const n of t)s.set(n,!1)}return s}async calculateRecipeCost(t){if(!t.recipe_items||!Array.isArray(t.recipe_items))return 0;let s=0;try{for(const r of t.recipe_items){const n=await F.getItemById(r.inventory_item_id);n&&n.cost_per_unit&&(s+=n.cost_per_unit*r.quantity)}}catch(r){console.error("Failed to calculate recipe cost:",r)}return s}async calculateMaxProductQuantity(t){if(!t.recipe_items||!Array.isArray(t.recipe_items))return 1/0;try{let s=1/0;for(const r of t.recipe_items){const n=await F.getItemById(r.inventory_item_id);if(n){const i=n.current_stock||0,o=Math.floor(i/r.quantity);s=Math.min(s,o)}else return 0}return s===1/0?0:s}catch(s){return console.error("Failed to calculate max product quantity:",s),0}}async generateRecipeReport(t){const s={recipe_items:[],total_recipe_cost:0,can_make_quantity:0,missing_ingredients:[]};if(!t.recipe_items||!Array.isArray(t.recipe_items))return s;let r=1/0;for(const n of t.recipe_items)try{const i=await F.getItemById(n.inventory_item_id);if(!i){s.missing_ingredients.push(`Unknown ingredient: ${n.inventory_item_id}`),r=0;continue}const o=i.current_stock||0,l=i.cost_per_unit||0,m=l*n.quantity,d=o>=n.quantity,u=Math.floor(o/n.quantity);s.recipe_items.push({ingredient:i,required_quantity:n.quantity,available_quantity:o,cost_per_unit:l,total_cost:m,sufficient:d}),s.total_recipe_cost+=m,r=Math.min(r,u)}catch{s.missing_ingredients.push(`Error loading ingredient: ${n.inventory_item_id}`),r=0}return s.can_make_quantity=r===1/0?0:r,s}}const ee=new Fs,Ze=({products:a,selectedItems:t,onProductUnavailable:s})=>{const[r,n]=c.useState(new Map),[i,o]=c.useState(!1),[l,m]=c.useState(null),d=async()=>{if(a.length!==0){o(!0);try{const x=a.map(g=>g.id),b=await ee.checkProductsAvailability(x),w=new Map;for(const g of a){const p=b.get(g.id)||!1,k=await ee.calculateMaxProductQuantity(g);let D="";const v=[];if(p)k<10&&(D=`Limited stock: only ${k} available`);else{const $=(await ee.generateRecipeReport(g)).recipe_items.filter(C=>!C.sufficient);$.length>0?(v.push(...$.map(C=>C.ingredient.name)),D=`Insufficient ingredients: ${v.join(", ")}`):D="Product unavailable"}w.set(g.id,{product_id:g.id,product_name:g.name,is_available:p,max_quantity:k,warning_message:D,insufficient_items:v})}n(w)}catch(x){console.error("Failed to check product availability:",x)}finally{o(!1)}}},u=async()=>{if(t.length!==0)try{const x=await ee.validateOrderStock(t);x.isValid||console.warn("Order validation failed:",x.insufficientItems)}catch(x){console.error("Failed to validate order:",x)}};c.useEffect(()=>{d()},[a]),c.useEffect(()=>{u()},[t]),c.useEffect(()=>{const x=setInterval(()=>{d()},3e4);return()=>clearInterval(x)},[a]);const h=()=>Array.from(r.values()).filter(x=>!x.is_available),f=()=>Array.from(r.values()).filter(x=>x.is_available&&x.max_quantity<10),I=x=>{if(x.is_available&&x.max_quantity>=10)return null;const b=!x.is_available;return e.jsxs("div",{className:`p-3 rounded-lg border-2 ${b?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:b?"🚫":"⚠️"}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${b?"text-red-800":"text-yellow-800"}`,children:x.product_name}),e.jsx("p",{className:`text-sm ${b?"text-red-600":"text-yellow-600"}`,children:x.warning_message})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m(l===x.product_id?null:x.product_id),className:`px-2 py-1 text-xs font-medium rounded ${b?"bg-red-100 text-red-700 hover:bg-red-200":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"}`,children:"Details"}),b&&s&&e.jsx("button",{onClick:()=>s(x.product_id),className:"px-2 py-1 text-xs font-medium bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]})]}),l===x.product_id&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Max Available:"})," ",x.max_quantity," units"]}),x.insufficient_items.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Missing Ingredients:"}),e.jsx("ul",{className:"list-disc list-inside ml-2 mt-1",children:x.insufficient_items.map((w,g)=>e.jsx("li",{className:"text-red-600",children:w},g))})]}),e.jsx("div",{className:"flex space-x-2 pt-2",children:e.jsx("button",{onClick:d,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded hover:bg-gray-50",children:"Refresh Status"})})]})})]},x.product_id)},j=h(),y=f();return j.length===0&&y.length===0&&!i?null:e.jsxs("div",{className:"space-y-4",children:[i&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Checking stock availability..."})]})}),j.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-red-800 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🚫"}),"Unavailable Items (",j.length,")"]}),j.map(I)]}),y.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-yellow-800 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"⚠️"}),"Low Stock Items (",y.length,")"]}),y.map(I)]}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsx("button",{onClick:d,disabled:i,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50",children:i?"Checking...":"Refresh Stock Status"})})]})},$s=({product:a,size:t="sm"})=>{const[s,r]=c.useState(null);if(c.useEffect(()=>{(async()=>{try{const m=(await ee.checkProductsAvailability([a.id])).get(a.id)||!1,d=await ee.calculateMaxProductQuantity(a);r({product_id:a.id,product_name:a.name,is_available:m,max_quantity:d,insufficient_items:[]})}catch(l){console.error("Failed to check product stock:",l)}})()},[a.id]),!s)return null;const n=()=>s.is_available?s.max_quantity<5?"bg-yellow-500":s.max_quantity<10?"bg-orange-500":"bg-green-500":"bg-red-500",i={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"};return e.jsx("div",{className:`${i[t]} ${n()} rounded-full`,title:s.is_available?`${s.max_quantity} available`:"Out of stock"})},Ms=({products:a,categories:t,onGoToCart:s})=>{var j,y;const[r,n]=c.useState("all"),[i,o]=c.useState(""),{addItem:l,getItemCount:m,getItemCountById:d,removeItemById:u}=ve();console.log("🔍 POSMenu received props:",{productsCount:a.length,categoriesCount:t.length,firstProduct:(j=a[0])==null?void 0:j.name,firstCategory:(y=t[0])==null?void 0:y.name});const h=c.useMemo(()=>{let x=a;if(r!=="all"&&(x=x.filter(b=>b.category_id===r)),i){const b=i.toLowerCase();x=x.filter(w=>{var g;return w.name.toLowerCase().includes(b)||((g=w.description)==null?void 0:g.toLowerCase().includes(b))})}return x},[a,r,i]),f=x=>{console.log("🛒 Adding to cart:",x.name,"Current cart items:",cartItems.length),l(x,1),console.log("✅ Item added to cart. New cart items:",cartItems.length+1),console.log(`✅ Added ${x.name} to cart`)},I=x=>{const b=t.find(w=>w.id===x);return(b==null?void 0:b.name)||"Unknown"};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-secondary-200 p-2 sm:p-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>s(),className:"flex items-center space-x-1 px-2 py-1 bg-primary-50 text-primary-700 rounded-lg text-xs font-medium hover:bg-primary-100 transition-colors",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsxs("span",{children:["Cart (",m(),")"]})]}),e.jsx("button",{className:"flex items-center space-x-1 px-2 py-1 bg-green-50 text-green-700 rounded-lg text-xs font-medium hover:bg-green-100 transition-colors",children:e.jsx("span",{children:"💳 Quick Pay"})}),e.jsx("button",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-lg text-xs font-medium hover:bg-blue-100 transition-colors",children:e.jsx("span",{children:"📋 Orders"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"flex items-center space-x-1 px-2 py-1 bg-gray-50 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-100 transition-colors",children:e.jsx("span",{children:"⚙️ Settings"})}),e.jsx("button",{className:"flex items-center space-x-1 px-2 py-1 bg-orange-50 text-orange-700 rounded-lg text-xs font-medium hover:bg-orange-100 transition-colors",children:e.jsx("span",{children:"🔔 Alerts"})})]})]}),e.jsxs("div",{className:"relative mb-2 sm:mb-3",children:[e.jsx(De,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 w-4 h-4 text-secondary-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",value:i,onChange:x=>o(x.target.value),className:"w-full pl-8 pr-3 py-2 sm:py-2.5 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm sm:text-base"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2 mb-2 sm:mb-3",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-blue-700",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["💡 ",e.jsx("strong",{children:"Tips:"})," Use Ctrl+K to search, Ctrl+C for cart"]}),e.jsx("span",{className:"hidden sm:inline",children:"| Double-tap items to add quickly"}),e.jsx("span",{className:"hidden md:inline",children:"| Hover over items for quick actions"})]}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:"Got it"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide scroll-smooth -mx-1",children:e.jsxs("div",{className:"flex space-x-2 pb-2 min-w-max px-1",children:[e.jsxs("button",{onClick:()=>n("all"),className:`px-2.5 sm:px-3 py-1.5 sm:py-2 rounded-full font-medium whitespace-nowrap transition-all duration-200 flex-shrink-0 text-xs border-2 min-w-[60px] sm:min-w-[80px] ${r==="all"?"bg-primary-500 text-white border-primary-500 shadow-lg transform scale-105":"bg-white text-secondary-700 border-secondary-200 hover:border-primary-300 hover:bg-primary-50 active:bg-primary-100"}`,children:[e.jsxs("span",{className:"block sm:hidden",children:["All (",a.length,")"]}),e.jsxs("span",{className:"hidden sm:block",children:["All Items (",a.length,")"]})]}),t.map(x=>{const b=a.filter(p=>p.category_id===x.id),w=b.length===0,g=p=>({"Kunafa Bowls":"Kunafa","Smoocho Signatures":"Signatures","Crispy Rice Tubs":"Rice Tubs","Choco Desserts":"Chocolate","Fruits Choco Mix":"Fruit Mix","Ice Creams":"Ice Cream",Beverages:"Drinks","Add-ons":"Add-ons"})[p]||p;return e.jsxs("button",{onClick:()=>n(x.id),disabled:w,className:`px-2.5 sm:px-3 py-1.5 sm:py-2 rounded-full font-medium whitespace-nowrap transition-all duration-200 flex-shrink-0 text-xs border-2 min-w-[60px] sm:min-w-[80px] ${r===x.id?"bg-primary-500 text-white border-primary-500 shadow-lg transform scale-105":w?"bg-secondary-100 text-secondary-400 border-secondary-200 cursor-not-allowed opacity-50":"bg-white text-secondary-700 border-secondary-200 hover:border-primary-300 hover:bg-primary-50 active:bg-primary-100"}`,children:[e.jsxs("span",{className:"block sm:hidden",children:[g(x.name)," (",b.length,")"]}),e.jsxs("span",{className:"hidden sm:block",children:[x.name," (",b.length,")"]})]},x.id)})]})}),e.jsx("div",{className:"hidden sm:block absolute right-0 top-0 bottom-0 w-4 bg-gradient-to-l from-white via-white/80 to-transparent pointer-events-none opacity-75"}),e.jsx("div",{className:"hidden sm:block absolute left-0 top-0 bottom-0 w-4 bg-gradient-to-r from-white via-white/80 to-transparent pointer-events-none opacity-75"})]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-2 sm:p-3",style:{paddingBottom:"env(safe-area-inset-bottom, 20px)"},children:h.length===0?e.jsxs("div",{className:"text-center py-12 sm:py-16",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-secondary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(De,{className:"w-6 h-6 sm:w-8 sm:h-8 text-secondary-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-medium text-secondary-900 mb-2",children:"No products found"}),e.jsx("p",{className:"text-sm sm:text-base text-secondary-500",children:i?`No products match "${i}"`:r!=="all"?`No products in ${I(r)}`:"No products available"})]}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8 gap-2 sm:gap-3 pb-6",children:h.map(x=>e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 hover:border-primary-300 hover:shadow-lg transition-all duration-200 overflow-hidden group cursor-pointer",children:[e.jsxs("div",{className:"aspect-square bg-secondary-100 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsx($s,{product:x,size:"md"})}),d(x.id)>0&&e.jsx("div",{className:"absolute top-2 left-2 z-10 animate-bounce",children:e.jsx("div",{className:"bg-primary-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-lg border-2 border-white",children:d(x.id)})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:b=>{b.stopPropagation(),d(x.id)>0&&u(x.id,1)},className:"w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors",children:e.jsx("span",{className:"text-sm font-bold",children:"-"})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),f(x)},className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center hover:bg-green-600 transition-colors",children:e.jsx("span",{className:"text-sm font-bold",children:"+"})})]})}),x.image_url?e.jsx("img",{src:x.image_url,alt:x.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-secondary-400 text-lg sm:text-xl lg:text-2xl font-bold",children:x.name.charAt(0).toUpperCase()})})]}),e.jsxs("div",{className:"p-1.5 sm:p-2",children:[e.jsx("h3",{className:"font-medium text-secondary-900 mb-1 text-[10px] sm:text-xs line-clamp-2 min-h-[1.5rem] sm:min-h-[2rem] leading-tight",children:x.name}),e.jsxs("div",{className:"flex items-center justify-between mb-1.5 sm:mb-2",children:[e.jsxs("span",{className:"text-xs sm:text-sm lg:text-base font-bold text-primary-600",children:["₹",x.price.toFixed(0)]}),x.preparation_time&&e.jsxs("span",{className:"text-[9px] sm:text-xs text-secondary-500 hidden sm:inline",children:[x.preparation_time,"min"]})]}),e.jsx("button",{onClick:()=>f(x),className:`w-full font-medium py-1.5 sm:py-2 px-1 sm:px-2 rounded text-[10px] sm:text-xs transition-all duration-200 flex items-center justify-center space-x-1 touch-manipulation min-h-[28px] sm:min-h-[32px] ${d(x.id)>0?"bg-green-500 hover:bg-green-600 active:bg-green-700 text-white shadow-lg":"bg-primary-500 hover:bg-primary-600 active:bg-primary-700 text-white hover:shadow-md"}`,children:d(x.id)>0?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"+1"}),e.jsx("span",{className:"sm:hidden",children:"+1"})]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add"}),e.jsx("span",{className:"sm:hidden",children:"+"})]})}),d(x.id)>0&&e.jsx("div",{className:"mt-1 text-center",children:e.jsxs("span",{className:"text-[9px] sm:text-xs text-green-600 font-medium",children:["In Cart: ",d(x.id)]})}),e.jsxs("div",{className:"mt-1 flex items-center justify-center space-x-1",children:[x.is_vegetarian&&e.jsx("span",{className:"text-[8px] px-1 py-0.5 bg-green-100 text-green-700 rounded text-xs",children:"🥬 Veg"}),x.preparation_time&&x.preparation_time<=5&&e.jsx("span",{className:"text-[8px] px-1 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:"⚡ Fast"})]})]})]},x.id))})}),m()>0&&e.jsx("div",{className:"fixed bottom-3 right-3 z-50 md:hidden",children:e.jsxs("button",{onClick:s,className:"bg-primary-500 hover:bg-primary-600 active:bg-primary-700 text-white rounded-full p-3 shadow-lg transition-all duration-200 relative min-h-[48px] min-w-[48px] flex items-center justify-center touch-manipulation transform hover:scale-105 active:scale-95",children:[e.jsx(xe,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center min-w-[20px]",children:m()})]})}),m()>0&&e.jsx("div",{className:"hidden md:block fixed bottom-4 right-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border border-secondary-200 p-4 min-w-[280px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900",children:"Current Order"}),e.jsx("button",{onClick:s,className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View Cart"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-secondary-600",children:"Items:"}),e.jsx("span",{className:"font-medium",children:m()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-secondary-600",children:"Total:"}),e.jsx("span",{className:"font-bold text-lg text-primary-600",children:"₹0"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:s,className:"flex-1 bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg font-medium text-sm transition-colors",children:"Proceed to Payment"}),e.jsx("button",{className:"px-3 py-2 border border-secondary-300 text-secondary-700 rounded-lg hover:bg-secondary-50 text-sm transition-colors",children:"Clear"})]})]})})]})},Us=({onBack:a,onProceedToPayment:t})=>{const[s,r]=c.useState(!1),[n,i]=c.useState(""),[o,l]=c.useState("percentage"),{items:m,subtotal:d,discount_amount:u,tax_amount:h,total_amount:f,updateQuantity:I,removeItem:j,updateSpecialInstructions:y,applyDiscount:x,removeDiscount:b,clearCart:w,getItemCount:g}=ve(),p=(v,E)=>{E<=0?j(v):I(v,E)},k=()=>{const v=parseFloat(n);v>0&&(x(v,o),r(!1),i(""))},D=()=>{window.confirm("Are you sure you want to clear the entire cart?")&&w()};return m.length===0?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-white border-b border-secondary-200 px-3 py-2 flex items-center",children:[e.jsx("button",{onClick:a,className:"mr-2 p-1.5 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("h2",{className:"text-lg font-bold text-secondary-900",children:"Cart"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-secondary-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(ne,{className:"w-6 h-6 sm:w-8 sm:h-8 text-secondary-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-medium text-secondary-900 mb-2",children:"Cart is empty"}),e.jsx("p",{className:"text-secondary-500 mb-4 text-sm sm:text-base",children:"Add some items from the menu to get started"}),e.jsx("button",{onClick:a,className:"btn-primary px-4 py-2 text-sm sm:text-base",children:"Browse Menu"})]})})]}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"bg-white border-b border-secondary-200 px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:a,className:"mr-2 p-1.5 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsxs("h2",{className:"text-lg font-bold text-secondary-900",children:["Cart (",g(),")"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>r(!0),className:"p-1.5 hover:bg-secondary-100 rounded-lg transition-colors",title:"Apply Discount",children:e.jsx(hs,{className:"w-4 h-4 text-secondary-600"})}),e.jsx("button",{onClick:D,className:"p-1.5 hover:bg-red-100 rounded-lg transition-colors text-red-600",title:"Clear Cart",children:e.jsx(ne,{className:"w-4 h-4"})})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-1 sm:p-2 space-y-1.5",children:m.map(v=>e.jsx("div",{className:"bg-white rounded border border-secondary-200 p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-10 h-10 bg-secondary-100 rounded overflow-hidden flex-shrink-0",children:v.product.image_url?e.jsx("img",{src:v.product.image_url,alt:v.product.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-secondary-400 text-xs font-bold",children:v.product.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"font-medium text-secondary-900 text-xs line-clamp-1 flex-1",children:v.product.name}),e.jsx("button",{onClick:()=>j(v.product.id),className:"p-0.5 hover:bg-red-100 rounded text-red-600 transition-colors ml-1 flex-shrink-0",children:e.jsx(be,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-secondary-500",children:["₹",v.product.price.toFixed(0)]}),e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx("button",{onClick:()=>p(v.product.id,v.quantity-1),className:"w-5 h-5 rounded-full bg-secondary-100 hover:bg-secondary-200 flex items-center justify-center transition-colors",children:e.jsx(rt,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:"text-xs font-medium w-4 text-center",children:v.quantity}),e.jsx("button",{onClick:()=>p(v.product.id,v.quantity+1),className:"w-5 h-5 rounded-full bg-primary-100 hover:bg-primary-200 text-primary-600 flex items-center justify-center transition-colors",children:e.jsx(se,{className:"w-2.5 h-2.5"})})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-xs font-bold text-secondary-900",children:["₹",v.item_total.toFixed(0)]})})]})]})]})},`${v.product.id}-${v.special_instructions}`))}),e.jsxs("div",{className:"bg-white border-t border-secondary-200 p-2",children:[e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"flex justify-between text-secondary-600 text-xs",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",d.toFixed(0)]})]}),u>0&&e.jsxs("div",{className:"flex justify-between text-green-600 text-xs",children:[e.jsxs("span",{children:["Discount",e.jsx("button",{onClick:b,className:"ml-1 text-red-600 hover:text-red-700",children:e.jsx(be,{className:"w-3 h-3 inline"})})]}),e.jsxs("span",{children:["-₹",u.toFixed(0)]})]}),e.jsxs("div",{className:"flex justify-between text-secondary-600 text-xs",children:[e.jsx("span",{children:"Tax (5%)"}),e.jsxs("span",{children:["₹",h.toFixed(0)]})]}),e.jsx("div",{className:"border-t border-secondary-200 pt-1",children:e.jsxs("div",{className:"flex justify-between text-sm font-bold text-secondary-900",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹",f.toFixed(0)]})]})})]}),e.jsxs("button",{onClick:t,className:"w-full btn-primary py-2.5 text-sm font-medium flex items-center justify-center space-x-1",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:"Proceed to Payment"})]})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary-900",children:"Apply Discount"}),e.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-secondary-100 rounded",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Discount Type"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l("percentage"),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${o==="percentage"?"border-primary-500 bg-primary-50 text-primary-600":"border-secondary-300 text-secondary-600"}`,children:"Percentage (%)"}),e.jsx("button",{onClick:()=>l("fixed"),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${o==="fixed"?"border-primary-500 bg-primary-50 text-primary-600":"border-secondary-300 text-secondary-600"}`,children:"Fixed Amount (₹)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:o==="percentage"?"Percentage":"Amount"}),e.jsx("input",{type:"number",placeholder:o==="percentage"?"Enter percentage (e.g., 10)":"Enter amount (e.g., 50)",value:n,onChange:v=>i(v.target.value),className:"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-3 pt-2",children:[e.jsx("button",{onClick:()=>r(!1),className:"flex-1 py-2 px-4 border border-secondary-300 text-secondary-700 rounded-lg hover:bg-secondary-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:!n||parseFloat(n)<=0,className:"flex-1 py-2 px-4 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:bg-secondary-300 disabled:cursor-not-allowed",children:"Apply Discount"})]})]})]})})]})};class Bs{constructor(){B(this,"dbName","SmoochodBillOfflineDB");B(this,"dbVersion",1);B(this,"db",null);B(this,"stores",{orders:{keyPath:"id",indexes:[{name:"order_number",keyPath:"order_number",unique:!0},{name:"status",keyPath:"status"},{name:"order_date",keyPath:"order_date"},{name:"sync_status",keyPath:"is_synced"}]},payments:{keyPath:"id",indexes:[{name:"order_id",keyPath:"order_id"},{name:"payment_status",keyPath:"payment_status"},{name:"payment_date",keyPath:"payment_date"},{name:"sync_status",keyPath:"is_synced"}]},inventory:{keyPath:"id",indexes:[{name:"name",keyPath:"name"},{name:"current_stock",keyPath:"current_stock"},{name:"minimum_stock",keyPath:"minimum_stock"},{name:"updated_at",keyPath:"updated_at"}]},stock_transactions:{keyPath:"id",indexes:[{name:"inventory_item_id",keyPath:"inventory_item_id"},{name:"transaction_type",keyPath:"transaction_type"},{name:"created_at",keyPath:"created_at"},{name:"reference_id",keyPath:"reference_id"}]},products:{keyPath:"id",indexes:[{name:"name",keyPath:"name"},{name:"category_id",keyPath:"category_id"},{name:"is_available",keyPath:"is_available"},{name:"updated_at",keyPath:"updated_at"}]},categories:{keyPath:"id",indexes:[{name:"name",keyPath:"name"},{name:"sort_order",keyPath:"sort_order"},{name:"is_active",keyPath:"is_active"}]},sync_records:{keyPath:"id",indexes:[{name:"table_name",keyPath:"table_name"},{name:"sync_status",keyPath:"sync_status"},{name:"timestamp",keyPath:"timestamp"},{name:"priority",keyPath:"priority"}]},offline_operations:{keyPath:"id",indexes:[{name:"operation_type",keyPath:"operation_type"},{name:"entity_type",keyPath:"entity_type"},{name:"status",keyPath:"status"},{name:"timestamp",keyPath:"timestamp"}]},offline_bills:{keyPath:"id",indexes:[{name:"created_at",keyPath:"created_at"},{name:"sync_status",keyPath:"sync_status"},{name:"order_id",keyPath:"order_data.id"}]},offline_inventory_updates:{keyPath:"id",indexes:[{name:"inventory_item_id",keyPath:"inventory_item_id"},{name:"operation_type",keyPath:"operation_type"},{name:"sync_status",keyPath:"sync_status"},{name:"timestamp",keyPath:"timestamp"}]},metadata:{keyPath:"key"}});this.initializeDatabase()}async initializeDatabase(){return new Promise((t,s)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>{console.error("Failed to open IndexedDB:",r.error),s(r.error)},r.onsuccess=()=>{this.db=r.result,console.log("✅ IndexedDB initialized successfully"),t()},r.onupgradeneeded=n=>{const i=n.target.result;this.createStores(i)}})}createStores(t){console.log("🔧 Creating IndexedDB stores..."),Object.entries(this.stores).forEach(([s,r])=>{if(!t.objectStoreNames.contains(s)){const n=t.createObjectStore(s,{keyPath:r.keyPath});"indexes"in r&&r.indexes&&r.indexes.forEach(i=>{n.createIndex(i.name,i.keyPath,{unique:i.unique||!1})}),console.log(`✅ Created store: ${s}`)}})}async ensureDbReady(){if(this.db||await this.initializeDatabase(),!this.db)throw new Error("Database not initialized");return this.db}async save(t,s){const r=await this.ensureDbReady();return new Promise((n,i)=>{const m=r.transaction([t],"readwrite").objectStore(t).put(s);m.onsuccess=()=>n(s),m.onerror=()=>i(m.error)})}async getById(t,s){const r=await this.ensureDbReady();return new Promise((n,i)=>{const m=r.transaction([t],"readonly").objectStore(t).get(s);m.onsuccess=()=>n(m.result||null),m.onerror=()=>i(m.error)})}async getAll(t){const s=await this.ensureDbReady();return new Promise((r,n)=>{const l=s.transaction([t],"readonly").objectStore(t).getAll();l.onsuccess=()=>r(l.result||[]),l.onerror=()=>n(l.error)})}async delete(t,s){const r=await this.ensureDbReady();return new Promise((n,i)=>{const m=r.transaction([t],"readwrite").objectStore(t).delete(s);m.onsuccess=()=>n(),m.onerror=()=>i(m.error)})}async getByIndex(t,s,r){const n=await this.ensureDbReady();return new Promise((i,o)=>{const u=n.transaction([t],"readonly").objectStore(t).index(s).getAll(r);u.onsuccess=()=>i(u.result||[]),u.onerror=()=>o(u.error)})}async count(t){const s=await this.ensureDbReady();return new Promise((r,n)=>{const l=s.transaction([t],"readonly").objectStore(t).count();l.onsuccess=()=>r(l.result),l.onerror=()=>n(l.error)})}async clear(t){const s=await this.ensureDbReady();return new Promise((r,n)=>{const l=s.transaction([t],"readwrite").objectStore(t).clear();l.onsuccess=()=>r(),l.onerror=()=>n(l.error)})}async saveOrder(t){return console.log("💾 Saving order offline:",t.order_number),this.save("orders",t)}async getOrder(t){return this.getById("orders",t)}async getOrderWithItems(t){const s=await this.getOrder(t);return s||null}async updateOrder(t,s){const r=await this.getOrder(t);if(!r)throw new Error("Order not found");const n={...r,...s,updated_at:new Date().toISOString()};await this.saveOrder(n)}async getAllOrders(){return this.getAll("orders")}async getOrdersByStatus(t){return this.getByIndex("orders","status",t)}async getUnsyncedOrders(){return this.getByIndex("orders","sync_status",!1)}async savePayment(t){return console.log("💾 Saving payment offline:",t.id),this.save("payments",t)}async getPayment(t){return this.getById("payments",t)}async getPaymentsByOrder(t){return this.getByIndex("payments","order_id",t)}async getUnsyncedPayments(){return this.getByIndex("payments","sync_status",!1)}async saveInventoryItem(t){return console.log("💾 Saving inventory item offline:",t.name),this.save("inventory",t)}async getInventoryItem(t){return this.getById("inventory",t)}async getAllInventory(){return this.getAll("inventory")}async getLowStockItems(){return(await this.getAllInventory()).filter(s=>s.current_stock<=s.minimum_stock)}async saveStockTransaction(t){return console.log("💾 Saving stock transaction offline:",t.id),this.save("stock_transactions",t)}async getStockTransactionsByItem(t){return this.getByIndex("stock_transactions","inventory_item_id",t)}async saveProduct(t){return console.log("💾 Saving product offline:",t.name),this.save("products",t)}async getAllProducts(){return this.getAll("products")}async getAvailableProducts(){return this.getByIndex("products","is_available",!0)}async getProductsByCategory(t){return this.getByIndex("products","category_id",t)}async saveCategory(t){return console.log("💾 Saving category offline:",t.name),this.save("categories",t)}async getAllCategories(){return this.getAll("categories")}async getActiveCategories(){return this.getByIndex("categories","is_active",!0)}async saveSyncRecord(t){return console.log("💾 Saving sync record:",t.table_name,t.operation_type),this.save("sync_records",t)}async getPendingSyncRecords(){return this.getByIndex("sync_records","sync_status","pending")}async getSyncRecordsByTable(t){return this.getByIndex("sync_records","table_name",t)}async getHighPrioritySyncRecords(){const t=await this.getByIndex("sync_records","priority","critical"),s=await this.getByIndex("sync_records","priority","high");return[...t,...s].sort((r,n)=>new Date(n.timestamp).getTime()-new Date(r.timestamp).getTime())}async saveOfflineOperation(t){return console.log("💾 Saving offline operation:",t.operation_type),this.save("offline_operations",t)}async getPendingOfflineOperations(){return this.getByIndex("offline_operations","status","pending")}async getOfflineOperationsByType(t){return this.getByIndex("offline_operations","operation_type",t)}async saveOfflineBill(t){return console.log("💾 Saving offline bill:",t.order_data.order_number),this.save("offline_bills",t)}async getPendingOfflineBills(){return this.getByIndex("offline_bills","sync_status","pending")}async getAllOfflineBills(){return this.getAll("offline_bills")}async saveOfflineInventoryUpdate(t){return console.log("💾 Saving offline inventory update:",t.inventory_item_id),this.save("offline_inventory_updates",t)}async getPendingInventoryUpdates(){return this.getByIndex("offline_inventory_updates","sync_status","pending")}async getInventoryUpdatesByItem(t){return this.getByIndex("offline_inventory_updates","inventory_item_id",t)}async saveMetadata(t,s){await this.save("metadata",{key:t,value:s,updated_at:new Date().toISOString()})}async getMetadata(t){const s=await this.getById("metadata",t);return(s==null?void 0:s.value)||null}async getStorageInfo(){await this.ensureDbReady();const t={};let s=0;for(const n of Object.keys(this.stores))if(this.stores[n]){const i=await this.count(n);t[n]=i,s+=i}const r=s*1024;return{total_size:s,used_size:s,available_size:100*1024*1024/1024,database_size:r/1024,cache_size:0,storage_type:"indexeddb",database_name:this.dbName,database_version:this.dbVersion,total_size_bytes:r,used_size_bytes:r,available_size_bytes:100*1024*1024-r,table_sizes:t,auto_cleanup_enabled:!0,retention_days:30,last_cleanup:await this.getMetadata("last_cleanup"),cleanup_frequency:30}}async bulkSave(t,s){const r=await this.ensureDbReady();return new Promise((n,i)=>{const o=r.transaction([t],"readwrite"),l=o.objectStore(t),m=[];o.oncomplete=()=>n(m),o.onerror=()=>i(o.error),s.forEach(d=>{const u=l.put(d);u.onsuccess=()=>{m.push(d)}})})}async exportData(){const t={};for(const s of Object.keys(this.stores))t[s]=await this.getAll(s);return t}async importData(t){for(const[s,r]of Object.entries(t))this.stores[s]&&(await this.clear(s),await this.bulkSave(s,r),console.log(`✅ Imported ${r.length} records to ${s}`))}async cleanupOldRecords(t=30){const s=new Date;s.setDate(s.getDate()-t);const r=s.toISOString();let n=0;const o=(await this.getAll("sync_records")).filter(d=>d.sync_status==="completed"&&d.timestamp<r);for(const d of o)await this.delete("sync_records",d.id),n++;const m=(await this.getAll("offline_operations")).filter(d=>d.status==="completed"&&d.timestamp<r);for(const d of m)await this.delete("offline_operations",d.id),n++;return await this.saveMetadata("last_cleanup",new Date().toISOString()),console.log(`🧹 Cleaned up ${n} old records`),n}async close(){this.db&&(this.db.close(),this.db=null,console.log("📴 IndexedDB connection closed"))}async deleteDatabase(){return await this.close(),new Promise((t,s)=>{const r=indexedDB.deleteDatabase(this.dbName);r.onsuccess=()=>{console.log("🗑️ Database deleted successfully"),t()},r.onerror=()=>{console.error("Failed to delete database:",r.error),s(r.error)}})}async initialize(){await this.ensureDbReady()}async getSyncQueueCount(){return await(await this.ensureDbReady()).transaction(["syncQueue"],"readonly").objectStore("syncQueue").count()}async clearAllData(){const s=(await this.ensureDbReady()).transaction(Object.keys(this.stores),"readwrite");for(const r of Object.keys(this.stores))await s.objectStore(r).clear()}async getPendingSyncOperations(){return this.getPendingOfflineOperations()}async markSyncOperationCompleted(t){console.log(`Marking operation ${t} as completed`)}async markSyncOperationFailed(t,s){console.log(`Marking operation ${t} as failed: ${s}`)}async syncProducts(t){for(const s of t)await this.saveProduct(s)}async syncCategories(t){for(const s of t)await this.saveCategory(s)}async syncInventoryItems(t){for(const s of t)await this.saveInventoryItem(s)}async syncSettings(t){await this.saveSetting("business",t)}async getFailedSyncOperations(t=10){return[]}async updateSyncOperationStatus(t,s){console.log(`Updating operation ${t} status:`,s)}async cleanupCompletedSyncOperations(t){console.log(`Cleaning up operations older than ${t} days`)}}const H=new Bs,qs=H;class zs{generateOrderNumber(){const t=new Date,s=t.getFullYear().toString().slice(-2),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0"),i=t.getTime().toString().slice(-6);return`ORD${s}${r}${n}${i}`}async createOrder(t,s,r,n){const{user:i}=V.getState(),{addNotification:o}=P.getState();if(!i)throw new Error("User not authenticated");if(t.length===0)throw new Error("Cart is empty");try{const l=t.map(g=>({product:g.product,quantity:g.quantity})),m=await ee.validateOrderStock(l);if(!m.isValid){const g=m.insufficientItems.map(p=>`${p.item_name}: need ${p.required} ${p.unit}, have ${p.available} ${p.unit}`).join(", ");throw new Error(`Insufficient stock: ${g}`)}if(m.warnings.length>0)for(const g of m.warnings)o({type:"warning",title:"Stock Warning",message:`${g.item_name}: ${g.message}`});const d=t.reduce((g,p)=>g+p.item_total,0),u=0,h=d*.05,f=d-u+h,I=`order_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,j=t.map((g,p)=>({id:`order_item_${I}_${p}`,order_id:I,product_id:g.product.id,product_name:g.product.name,product_price:g.product.price,quantity:g.quantity,item_total:g.item_total,special_instructions:g.special_instructions,created_at:new Date().toISOString()})),y={id:I,order_number:this.generateOrderNumber(),order_type:s,customer_name:n==null?void 0:n.name,customer_phone:n==null?void 0:n.phone,customer_email:n==null?void 0:n.email,table_number:n==null?void 0:n.tableNumber,subtotal:d,discount_amount:u,tax_amount:h,total_amount:f,status:"pending",payment_status:"pending",order_date:new Date().toISOString(),cashier_id:i.id,order_items:j,payments:[],is_synced:!1,can_edit:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await H.saveOrder(y);try{const g=await ee.processStockDeduction(I,l,i.id);if(!g.success)throw await H.updateOrder(I,{status:"cancelled"}),new Error(`Stock deduction failed: ${g.errors.join(", ")}`);console.log("✅ Stock deducted successfully:",g.deductedItems),o({type:"info",title:"Stock Updated",message:`Stock deducted for ${g.deductedItems.length} ingredients`})}catch(g){throw console.error("❌ Stock deduction failed:",g),await H.updateOrder(I,{status:"cancelled"}),o({type:"error",title:"Order Cancelled",message:"Order cancelled due to stock deduction failure"}),new Error(`Order cancelled: ${g.message}`)}const b={id:`payment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,order_id:I,payment_method:r,amount:f,payment_status:"completed",payment_date:new Date().toISOString(),is_synced:!1,created_at:new Date().toISOString()};await H.savePayment(b);const w=await H.getOrder(I);return w&&(w.payments=[b],w.status="confirmed",w.payment_status="paid",w.completed_at=new Date().toISOString(),w.updated_at=new Date().toISOString(),await H.saveOrder(w)),o({type:"success",title:"Order Created",message:`Order ${y.order_number} created successfully`}),I}catch(l){throw console.error("Failed to create order:",l),o({type:"error",title:"Order Failed",message:l instanceof Error?l.message:"Failed to create order. Please try again."}),l}}async getOrderWithItems(t){try{return await H.getOrderWithItems(t)||null}catch(s){return console.error("Failed to get order:",s),null}}async getRecentOrders(t=50){try{return await H.getAllOrders()}catch(s){return console.error("Failed to get recent orders:",s),[]}}async updateOrder(t,s,r=!1){const{user:n}=V.getState(),{addNotification:i}=P.getState();if(!n)throw new Error("User not authenticated");if(n.role!=="admin"&&n.role!=="manager"&&!r)throw new Error("Admin approval required to edit orders");try{await H.updateOrder(t,s),i({type:"success",title:"Order Updated",message:"Order has been updated successfully"})}catch(o){throw console.error("Failed to update order:",o),i({type:"error",title:"Update Failed",message:"Failed to update order. Please try again."}),o}}async cancelOrder(t){const{user:s}=V.getState(),{addNotification:r}=P.getState();if(!s)throw new Error("User not authenticated");try{const n=await H.getOrderWithItems(t);if(!n)throw new Error("Order not found");if(n.status==="cancelled")throw new Error("Order is already cancelled");if(n.status==="completed")throw new Error("Cannot cancel completed order");if(n.status==="confirmed"||n.status==="preparing")try{const i=n.order_items.map(o=>{var l;return{product:{id:o.product_id,name:o.product_name,recipe_items:((l=o.product)==null?void 0:l.recipe_items)||[]},quantity:o.quantity}});for(const o of i)if(o.product.recipe_items&&Array.isArray(o.product.recipe_items))for(const l of o.product.recipe_items){const m=l.quantity*o.quantity;await F.addStockTransaction({inventory_item_id:l.inventory_id,transaction_type:"IN",quantity:m,reference_type:"ORDER",reference_id:t,notes:`Stock restored from cancelled order ${n.order_number}`})}r({type:"info",title:"Stock Restored",message:"Inventory has been restored for cancelled order"})}catch(i){console.error("Failed to restore stock:",i),r({type:"warning",title:"Stock Restoration Failed",message:"Order cancelled but stock could not be restored automatically"})}await H.updateOrder(t,{status:"cancelled",updated_at:new Date().toISOString()}),r({type:"info",title:"Order Cancelled",message:`Order ${n.order_number} has been cancelled`})}catch(n){throw console.error("Failed to cancel order:",n),r({type:"error",title:"Cancel Failed",message:n instanceof Error?n.message:"Failed to cancel order. Please try again."}),n}}async searchOrders(t){try{return(await H.getAllOrders()).filter(r=>{var n,i,o;return r.order_number.toLowerCase().includes(t.toLowerCase())||((n=r.customer_name)==null?void 0:n.toLowerCase().includes(t.toLowerCase()))||((i=r.customer_phone)==null?void 0:i.includes(t))||((o=r.table_number)==null?void 0:o.toLowerCase().includes(t.toLowerCase()))})}catch(s){return console.error("Failed to search orders:",s),[]}}async getOrdersByDateRange(t,s,r){try{const n={};return r&&(n.status=r),(await H.getAllOrders()).filter(o=>{const l=new Date(o.order_date),m=new Date(t),d=new Date(s);return l>=m&&l<=d})}catch(n){return console.error("Failed to get orders by date range:",n),[]}}async getOrderStats(t){try{let s=await H.getAllOrders();t&&(s=s.filter(m=>{const d=new Date(m.order_date),u=new Date(t.start),h=new Date(t.end);return d>=u&&d<=h}));const r=s.length,n=s.reduce((m,d)=>m+d.total_amount,0),i=r>0?n/r:0,o=s.reduce((m,d)=>(m[d.order_type]=(m[d.order_type]||0)+1,m),{}),l=s.reduce((m,d)=>(m[d.status]=(m[d.status]||0)+1,m),{});return{totalOrders:r,totalRevenue:n,averageOrderValue:i,ordersByType:o,ordersByStatus:l}}catch(s){return console.error("Failed to get order stats:",s),{totalOrders:0,totalRevenue:0,averageOrderValue:0,ordersByType:{},ordersByStatus:{}}}}async validateCartItems(t){const s={isValid:!0,warnings:[],errors:[]};if(t.length===0)return s;try{const r=t.map(i=>({product:i.product,quantity:i.quantity})),n=await ee.validateOrderStock(r);n.isValid||(s.isValid=!1,s.errors=n.insufficientItems.map(i=>`${i.item_name}: need ${i.required} ${i.unit}, have ${i.available} ${i.unit}`)),n.warnings.length>0&&(s.warnings=n.warnings.map(i=>`${i.item_name}: ${i.message}`))}catch(r){console.error("Failed to validate cart items:",r),s.isValid=!1,s.errors.push("Failed to validate stock availability")}return s}}const X=new zs,ie=class ie{static getInstance(){return ie.instance||(ie.instance=new ie),ie.instance}formatReceipt(t){const s={name:"Smoocho Bill Restaurant",address:"123 Food Street, Delhi",phone:"+91 9876543210",gst:"GST: 07AAAAA0000A1Z5"},r=32,n="=".repeat(r),i="-".repeat(r);let o="";if(o+=this.centerText(s.name,r)+`
`,o+=this.centerText(s.address,r)+`
`,o+=this.centerText(s.phone,r)+`
`,o+=this.centerText(s.gst,r)+`
`,o+=n+`
`,o+=`Order No: ${t.order_number}
`,o+=`Date: ${new Date(t.order_date).toLocaleString()}
`,o+=`Type: ${this.formatOrderType(t.order_type)}
`,t.customer_name&&(o+=`Customer: ${t.customer_name}
`),t.customer_phone&&(o+=`Phone: ${t.customer_phone}
`),t.table_number&&(o+=`Table: ${t.table_number}
`),o+=n+`
`,o+=this.padText("Item","Qty","Amount",r)+`
`,o+=i+`
`,t.order_items.forEach(m=>{const d=this.truncateText(m.product_name,16),u=m.quantity.toString(),h=`₹${m.item_total.toFixed(2)}`;o+=this.padText(d,u,h,r)+`
`,m.special_instructions&&(o+=` Note: ${m.special_instructions}
`)}),o+=i+`
`,o+=this.padTwoColumns("Subtotal:",`₹${t.subtotal.toFixed(2)}`,r)+`
`,t.discount_amount>0){const m=t.discount_type==="percentage"?`Discount (${t.discount_amount}%):`:"Discount:";o+=this.padTwoColumns(m,`-₹${t.discount_amount.toFixed(2)}`,r)+`
`}o+=this.padTwoColumns("Tax (5%):",`₹${t.tax_amount.toFixed(2)}`,r)+`
`,o+=i+`
`,o+=this.padTwoColumns("TOTAL:",`₹${t.total_amount.toFixed(2)}`,r)+`
`,o+=n+`
`;const l=t.payments||[];return l.length>0&&(o+=`Payment Details:
`,l.forEach(m=>{o+=this.padTwoColumns(this.formatPaymentMethod(m.payment_method),`₹${m.amount.toFixed(2)}`,r)+`
`}),o+=i+`
`),o+=this.centerText("Thank you for your visit!",r)+`
`,o+=this.centerText("Please visit again",r)+`
`,o+=n+`
`,o+=`


`,o}async printReceipt(t){try{const s=await qs.getOrderWithItems(t);if(!s)throw new Error("Order not found");const r=this.formatReceipt(s);return typeof window<"u"?this.printInBrowser(r,s.order_number):(console.log("Thermal printer output:"),console.log(r),!0)}catch(s){return console.error("Print failed:",s),!1}}printInBrowser(t,s){try{const r=window.open("","_blank","width=300,height=600");if(!r)throw new Error("Could not open print window");return r.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Receipt - ${s}</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.2;
              margin: 10px;
              white-space: pre-wrap;
            }
            @media print {
              body { margin: 0; }
              @page { size: 80mm auto; margin: 0; }
            }
          </style>
        </head>
        <body>${t}</body>
        </html>
      `),r.document.close(),r.focus(),setTimeout(()=>{r.print(),r.close()},250),!0}catch(r){return console.error("Browser print failed:",r),!1}}centerText(t,s){const r=Math.max(0,Math.floor((s-t.length)/2));return" ".repeat(r)+t}padTwoColumns(t,s,r){const n=r-s.length-1,i=this.truncateText(t,n),o=r-i.length-s.length;return i+" ".repeat(Math.max(1,o))+s}padText(t,s,r,n){const l=n-16-4;return this.truncateText(t,16).padEnd(16)+s.padStart(4)+r.padStart(l)}truncateText(t,s){return t.length>s?t.substring(0,s-1)+"…":t}formatOrderType(t){return{dine_in:"Dine In",takeaway:"Takeaway",zomato:"Zomato Delivery",swiggy:"Swiggy Delivery"}[t]||t}formatPaymentMethod(t){return{cash:"Cash",card:"Card",upi:"UPI",zomato:"Zomato Payment",swiggy:"Swiggy Payment"}[t]||t}generateReceiptHTML(t){return`
      <div style="font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.4; max-width: 350px; margin: 0 auto; padding: 20px; background: white; white-space: pre-wrap;">
        ${this.formatReceipt(t)}
      </div>
    `}generateESCPOSCommands(t){const s=this.formatReceipt(t),r=new TextEncoder,n=[[27,64],[27,97,1],r.encode(s),[29,86,66,0]],i=n.reduce((m,d)=>m+d.length,0),o=new Uint8Array(i);let l=0;return n.forEach(m=>{m instanceof Uint8Array?(o.set(m,l),l+=m.length):(o.set(new Uint8Array(m),l),l+=m.length)}),o}};B(ie,"instance");let Pe=ie;const ot=Pe.getInstance(),oe=class oe{constructor(){B(this,"isSDKLoaded",!1)}static getInstance(){return oe.instance||(oe.instance=new oe),oe.instance}async loadSDK(){return this.isSDKLoaded?!0:new Promise(t=>{if(window.Paytm){this.isSDKLoaded=!0,t(!0);return}const s=document.createElement("script");s.src="https://securegw-stage.paytm.in/merchantpgpui/checkoutjs/merchants/YOUR_MID.js",s.onload=()=>{this.isSDKLoaded=!0,t(!0)},s.onerror=()=>{console.error("Failed to load Paytm SDK"),t(!1)},document.head.appendChild(s)})}async initiatePayment(t){try{if(!await this.loadSDK())throw new Error("Failed to load Paytm SDK");this.validatePaymentData(t);const r=await this.getTransactionToken(t);if(!r.success)throw new Error(r.error||"Failed to get transaction token");const n={root:"",flow:"DEFAULT",data:{orderId:t.orderId,token:r.token,tokenType:"TXN_TOKEN",amount:t.txnAmount},merchant:{mid:"your_merchant_id_here",redirect:!1},handler:{transactionStatus:i=>this.handlePaymentResponse(i),notifyMerchant:(i,o)=>{console.log("Paytm Event:",i,o)}}};return new Promise(i=>{window.Paytm&&window.Paytm.CheckoutJS?(window.Paytm.CheckoutJS.init(n).then(()=>{window.Paytm.CheckoutJS.invoke()}),window.paytmPaymentHandler=o=>{i(this.processPaymentResult(o))}):i({success:!1,error:"Paytm SDK not available"})})}catch(s){return console.error("Paytm payment error:",s),{success:!1,error:s instanceof Error?s.message:"Payment failed"}}}validatePaymentData(t){const s=["orderId","txnAmount","custId"];for(const n of s)if(!t[n])throw new Error(`Missing required field: ${n}`);const r=parseFloat(t.txnAmount);if(isNaN(r)||r<=0)throw new Error("Invalid transaction amount");if(t.mobileNo&&!/^[6-9]\d{9}$/.test(t.mobileNo))throw new Error("Invalid mobile number");if(t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email))throw new Error("Invalid email address")}async getTransactionToken(t){try{const s=await fetch(`${ge.api.baseUrl}/api/payments/paytm/token`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(ge.storage.tokenKey)}`},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to get transaction token");return{success:!0,token:(await s.json()).token}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Token request failed"}}}handlePaymentResponse(t){return console.log("Payment Status:",t),window.paytmPaymentHandler&&window.paytmPaymentHandler(t),!0}processPaymentResult(t){return t.STATUS==="TXN_SUCCESS"?{success:!0,transactionId:t.TXNID}:{success:!1,error:t.RESPMSG||"Payment failed"}}async verifyPayment(t,s){try{const r=await fetch(`${ge.api.baseUrl}/api/payments/paytm/verify`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(ge.storage.tokenKey)}`},body:JSON.stringify({orderId:t,transactionId:s})});if(!r.ok)throw new Error("Payment verification failed");return{success:!0,verified:(await r.json()).verified}}catch(r){return{success:!1,verified:!1,error:r instanceof Error?r.message:"Verification failed"}}}isAvailable(){return this.isSDKLoaded&&!!window.Paytm}getSupportedMethods(){return["CREDIT_CARD","DEBIT_CARD","NET_BANKING","WALLET","UPI"]}};B(oe,"instance");let Ee=oe;const Ge=Ee.getInstance(),Ws=({onBack:a,onOrderSuccess:t})=>{const[s,r]=c.useState("cash"),[n,i]=c.useState("dine_in"),[o,l]=c.useState({name:"",phone:"",email:"",tableNumber:""}),[m,d]=c.useState(!1),[u,h]=c.useState(""),[f,I]=c.useState(!1),{items:j,subtotal:y,discount_amount:x,tax_amount:b,total_amount:w,getItemCount:g}=ve(),p=[{id:"cash",name:"Cash",icon:Re,color:"green",description:"Physical cash payment"},{id:"card",name:"Card",icon:je,color:"blue",description:"Credit/Debit card"},{id:"upi",name:"UPI",icon:Ht,color:"purple",description:"UPI/Digital payment"}],k=[{id:"dine_in",name:"Dine In",icon:Ot,color:"blue",description:"Customer dining in restaurant"},{id:"takeaway",name:"Takeaway",icon:fs,color:"green",description:"Customer pickup order"}],D=(C,R)=>{l(O=>({...O,[C]:R}))},v=()=>g()===0?(h("Cart is empty"),!1):(h(""),!0),E=async C=>{try{I(!0);const R={id:`paytm_${Date.now()}`,order_id:C,orderId:C,transaction_id:"",amount:w,txnAmount:w.toString(),payment_status:"pending",payment_method:"card",customer_info:{name:o.name||"Guest",phone:o.phone,email:o.email},mobileNo:o.phone||"",email:o.email||"",custId:o.phone||"guest",callbackUrl:`${window.location.origin}/payment-callback`,gateway_response:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},O=await Ge.initiatePayment(R);if(O.success&&O.transactionId){if((await Ge.verifyPayment(C,O.transactionId)).verified)return!0;throw new Error("Payment verification failed")}else throw new Error(O.error||"Payment failed")}catch(R){return console.error("Paytm payment error:",R),h(R instanceof Error?R.message:"Payment processing failed"),!1}finally{I(!1)}},$=async()=>{if(v()){d(!0),h("");try{const C=await X.createOrder(j,n,s,o),R=await X.getOrderWithItems(C);if(R){if(s==="card"&&!await E(C)){await X.updateOrder(C,{status:"cancelled",payment_status:"pending"});return}try{await ot.printReceipt(C)}catch(O){console.warn("Print failed, but order was successful:",O)}t(C,R.order_number)}else throw new Error("Failed to retrieve order details")}catch(C){console.error("Failed to place order:",C),h(C instanceof Error?C.message:"Failed to place order")}finally{d(!1)}}};return g()===0?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-white border-b border-secondary-200 px-3 py-2 flex items-center",children:[e.jsx("button",{onClick:a,className:"mr-2 p-1.5 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("h2",{className:"text-lg font-bold text-secondary-900",children:"Payment"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ie,{className:"w-12 h-12 sm:w-16 sm:h-16 text-yellow-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-base sm:text-lg font-medium text-secondary-900 mb-2",children:"No items in cart"}),e.jsx("p",{className:"text-secondary-500 mb-4 text-sm",children:"Add some items before proceeding to payment"}),e.jsx("button",{onClick:a,className:"btn-primary px-4 py-2 text-sm",children:"Go Back to Cart"})]})})]}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-white border-b border-secondary-200 px-3 py-2 flex items-center",children:[e.jsx("button",{onClick:a,className:"mr-2 p-1.5 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("h2",{className:"text-lg font-bold text-secondary-900",children:"Payment"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 sm:p-3 space-y-3",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-secondary-900 mb-2",children:"Order Summary"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-secondary-600",children:["Items (",g(),")"]}),e.jsxs("span",{children:["₹",y.toFixed(0)]})]}),x>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-₹",x.toFixed(0)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary-600",children:"Tax (5%)"}),e.jsxs("span",{children:["₹",b.toFixed(0)]})]}),e.jsx("div",{className:"border-t border-secondary-200 pt-1 mt-2",children:e.jsxs("div",{className:"flex justify-between text-base font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹",w.toFixed(0)]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-secondary-900 mb-2",children:"Order Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.map(C=>{const R=C.icon,O=n===C.id;return e.jsxs("button",{onClick:()=>i(C.id),className:`p-3 rounded-lg border-2 transition-all ${O?`border-${C.color}-500 bg-${C.color}-50`:"border-secondary-200 hover:border-secondary-300"}`,children:[e.jsx(R,{className:`w-6 h-6 mx-auto mb-1 ${O?`text-${C.color}-600`:"text-secondary-400"}`}),e.jsx("div",{className:"text-xs font-medium text-secondary-900",children:C.name})]},C.id)})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-secondary-900 mb-2",children:"Customer Info (Optional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Customer name (optional)",value:o.name,onChange:C=>D("name",C.target.value),className:"w-full px-2 py-2 text-sm border border-secondary-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsx("input",{type:"tel",placeholder:"Phone number (optional)",value:o.phone,onChange:C=>D("phone",C.target.value),className:"w-full px-2 py-2 text-sm border border-secondary-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),n==="dine_in"&&e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Table number (optional)",value:o.tableNumber,onChange:C=>D("tableNumber",C.target.value),className:"w-full px-2 py-2 text-sm border border-secondary-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-secondary-900 mb-2",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:p.map(C=>{const R=C.icon,O=s===C.id;return e.jsxs("button",{onClick:()=>r(C.id),className:`p-3 rounded-lg border-2 transition-all flex items-center space-x-3 ${O?`border-${C.color}-500 bg-${C.color}-50`:"border-secondary-200 hover:border-secondary-300"}`,children:[e.jsx(R,{className:`w-6 h-6 ${O?`text-${C.color}-600`:"text-secondary-400"}`}),e.jsx("div",{className:"text-left",children:e.jsx("div",{className:"text-sm font-medium text-secondary-900",children:C.name})}),O&&e.jsx(ce,{className:`w-5 h-5 text-${C.color}-600 ml-auto`})]},C.id)})})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ie,{className:"w-4 h-4 text-red-600 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-red-800 text-sm",children:u})]})})]}),e.jsx("div",{className:"bg-white border-t border-secondary-200 p-2",children:e.jsx("button",{onClick:$,disabled:m||f,className:"w-full btn-primary py-3 text-sm font-medium flex items-center justify-center space-x-2 disabled:bg-secondary-300 disabled:cursor-not-allowed",children:m||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsxs("span",{children:["Place Order (₹",w.toFixed(0),")"]})]})})})]})},Vs=()=>{const[a,t]=c.useState("menu"),[s,r]=c.useState([]),[n,i]=c.useState([]),[o,l]=c.useState(!0),[m,d]=c.useState("Initializing..."),[u,h]=c.useState(null),[f,I]=c.useState(!0),{user:j}=V(),{getItemCount:y,clearCart:x,items:b}=ve();c.useEffect(()=>{(async()=>{try{console.log("🚀 Initializing POS page (direct mode)..."),d("Loading menu data..."),await w()}catch(E){console.error("❌ Failed to initialize POS:",E),d("Error loading data"),r([]),i([]),l(!1)}})()},[]);const w=async()=>{var v,E;l(!0);try{console.log("🔄 Loading POS data..."),d("Loading menu directly (bypassing database)..."),console.log("🔄 Loading menu data directly from source files");const{smoochoProducts:$}=await Rs(async()=>{const{smoochoProducts:O}=await Promise.resolve().then(()=>Is);return{smoochoProducts:O}},void 0),C=$.map(O=>({...O,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),R=[{id:"cat-1",name:"Kunafa Bowls",description:"Premium dessert bowls",sort_order:1,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-2",name:"Smoocho Signatures",description:"Signature desserts",sort_order:2,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-3",name:"Crispy Rice Tubs",description:"Crispy rice desserts",sort_order:3,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-4",name:"Choco Desserts",description:"Chocolate treats",sort_order:4,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-5",name:"Fruits Choco Mix",description:"Fruit and chocolate combo",sort_order:5,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-6",name:"Ice Creams",description:"Premium ice creams",sort_order:6,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-7",name:"Beverages",description:"Refreshing drinks",sort_order:7,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"cat-8",name:"Add-ons",description:"Extra toppings",sort_order:8,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];console.log("📊 Successfully loaded direct menu data:",{products:C.length,categories:R.length,firstProduct:(v=C[0])==null?void 0:v.name,firstCategory:(E=R[0])==null?void 0:E.name,productSample:C.slice(0,3).map(O=>({id:O.id,name:O.name,price:O.price})),categorySample:R.slice(0,3).map(O=>({id:O.id,name:O.name}))}),r(C),i(R)}catch($){console.error("Failed to load menu data:",$),d("Error loading menu - using minimal fallback");const C=[{id:"fallback-1",name:"Hazelnut Kunafa",description:"Premium kunafa with hazelnut toppings",category_id:"cat-1",price:219,cost_price:110,sku:"KUN001",is_available:!0,is_active:!0,sort_order:1,preparation_time:10,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"fallback-2",name:"White Chocolate Kunafa",description:"Kunafa topped with white chocolate",category_id:"cat-1",price:219,cost_price:110,sku:"KUN002",is_available:!0,is_active:!0,sort_order:2,preparation_time:10,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],R=[{id:"cat-1",name:"Kunafa Bowls",description:"Premium dessert bowls",sort_order:1,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];r(C),i(R)}finally{l(!1)}},g=(v,E)=>{h({orderId:v,orderNumber:E}),t("success"),x(),setTimeout(()=>{t("menu"),h(null)},3e3)},p=()=>{y()>0&&t("cart")},k=()=>{y()>0&&t("payment")},D=()=>{a==="payment"?t("cart"):a==="cart"&&t("menu")};return o?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),e.jsx("p",{className:"text-secondary-600 text-lg font-medium",children:m}),e.jsx("p",{className:"text-secondary-400 text-sm mt-2",children:"Please wait..."})]})}):e.jsxs(re,{children:[e.jsx("div",{className:"bg-white border-b border-secondary-200 px-2 sm:px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[e.jsx("h1",{className:"text-base sm:text-lg font-bold text-secondary-900 truncate",children:"Smoocho POS"}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-secondary-500 hidden md:block",children:[j==null?void 0:j.username," • ",new Date().toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("button",{onClick:()=>t("menu"),className:`px-2 sm:px-3 py-1.5 sm:py-2 rounded-md font-medium transition-colors text-xs ${a==="menu"?"bg-primary-500 text-white":"bg-secondary-100 text-secondary-700 hover:bg-secondary-200"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"Menu"}),e.jsx("span",{className:"sm:hidden",children:"🍽️"})]}),e.jsxs("button",{onClick:p,disabled:y()===0,className:`px-2 sm:px-3 py-1.5 sm:py-2 rounded-md font-medium transition-colors relative text-xs ${a==="cart"?"bg-primary-500 text-white":y()>0?"bg-secondary-100 text-secondary-700 hover:bg-secondary-200":"bg-secondary-50 text-secondary-400 cursor-not-allowed"}`,children:[e.jsx(xe,{className:"w-3 h-3 sm:w-4 sm:h-4 inline sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Cart"}),y()>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-3.5 h-3.5 sm:w-4 sm:h-4 flex items-center justify-center text-[8px] sm:text-[9px]",children:y()})]}),e.jsxs("button",{onClick:k,disabled:y()===0,className:`px-2 sm:px-3 py-1.5 sm:py-2 rounded-md font-medium transition-colors text-xs ${a==="payment"?"bg-primary-500 text-white":y()>0?"bg-green-100 text-green-700 hover:bg-green-200":"bg-secondary-50 text-secondary-400 cursor-not-allowed"}`,children:[e.jsx(je,{className:"w-4 h-4 sm:w-5 sm:h-5 inline sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Payment"}),e.jsx("span",{className:"sm:hidden",children:"💳"})]}),a==="menu"&&e.jsx("button",{onClick:()=>I(!f),className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-md font-medium transition-colors text-xs bg-orange-100 text-orange-700 hover:bg-orange-200 hidden lg:block",children:f?"📊 Hide":"⚠️ Stock"})]})]})}),e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[a==="menu"&&e.jsxs("div",{className:"flex-1 min-h-0 flex",children:[e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(Ms,{products:s,categories:n,onGoToCart:p})}),f&&s.length>0&&e.jsxs("div",{className:"w-80 bg-white border-l border-secondary-200 p-4 overflow-y-auto hidden lg:block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-secondary-900",children:"Stock Alerts"}),e.jsx("button",{onClick:()=>I(!1),className:"text-secondary-500 hover:text-secondary-700 text-sm",children:"Hide"})]}),e.jsx(Ze,{products:s,selectedItems:b.map(v=>({product:v.product,quantity:v.quantity})),onProductUnavailable:v=>{console.log("Product unavailable:",v)}})]})]}),a==="cart"&&e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[b.length>0&&e.jsx("div",{className:"bg-white border-b border-secondary-200 p-3",children:e.jsx(Ze,{products:b.map(v=>v.product),selectedItems:b.map(v=>({product:v.product,quantity:v.quantity})),onProductUnavailable:v=>{ve.getState().removeItem(v)}})}),e.jsx(Us,{onBack:D,onProceedToPayment:k})]}),a==="payment"&&e.jsx(Ws,{onBack:D,onOrderSuccess:g}),a==="success"&&u&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ce,{className:"w-12 h-12 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-secondary-900 mb-2",children:"Order Successful!"}),e.jsxs("p",{className:"text-lg text-secondary-600 mb-4",children:["Order #",u.orderNumber]}),e.jsxs("div",{className:"flex items-center justify-center text-secondary-500 mb-6",children:[e.jsx(he,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Returning to menu in 3 seconds..."})]}),e.jsx("button",{onClick:()=>{t("menu"),h(null)},className:"btn-primary px-8 py-3 text-lg",children:"New Order"})]})})]})]})};class Hs{constructor(){B(this,"syncQueue",[]);B(this,"isSyncing",!1);B(this,"syncInterval",null);B(this,"MAX_RETRIES",3);B(this,"SYNC_INTERVAL",3e4);this.loadSyncQueue(),this.startAutoSync(),window.addEventListener("online",()=>{console.log("📶 Connection restored - starting sync"),this.performSync()}),window.addEventListener("offline",()=>{console.log("📵 Connection lost - sync paused")})}loadSyncQueue(){try{const t=localStorage.getItem("inventory_sync_queue");t&&(this.syncQueue=JSON.parse(t))}catch(t){console.error("Failed to load sync queue:",t),this.syncQueue=[]}}saveSyncQueue(){try{localStorage.setItem("inventory_sync_queue",JSON.stringify(this.syncQueue))}catch(t){console.error("Failed to save sync queue:",t)}}startAutoSync(){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval(()=>{navigator.onLine&&!this.isSyncing&&this.performSync()},this.SYNC_INTERVAL)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null)}addToSyncQueue(t,s,r){const n={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:t,entity:s,data:r,timestamp:new Date().toISOString(),retryCount:0,status:"pending"};this.syncQueue.push(n),this.saveSyncQueue(),console.log(`📝 Added to sync queue: ${t} ${s}`,n),navigator.onLine&&!this.isSyncing&&setTimeout(()=>this.performSync(),1e3)}async performSync(){if(this.isSyncing)return console.log("⏳ Sync already in progress"),{success:!1,synced:0,failed:0,errors:["Sync already in progress"]};if(!navigator.onLine)return console.log("📵 Offline - skipping sync"),{success:!1,synced:0,failed:0,errors:["Device is offline"]};this.isSyncing=!0,Y.getState().setSyncStatus(!0);const t={success:!0,synced:0,failed:0,errors:[]};console.log(`🔄 Starting sync - ${this.syncQueue.length} operations in queue`);try{const s=this.syncQueue.filter(n=>n.status==="pending"||n.status==="failed"&&n.retryCount<this.MAX_RETRIES);for(const n of s)try{n.status="syncing",await this.syncSingleOperation(n),n.status="completed",t.synced++,console.log(`✅ Synced: ${n.type} ${n.entity}`)}catch(i){n.status="failed",n.retryCount++,n.error=i.message,t.failed++,t.errors.push(`${n.type} ${n.entity}: ${i.message}`),console.error(`❌ Sync failed: ${n.type} ${n.entity}`,i)}this.syncQueue=this.syncQueue.filter(n=>n.status!=="completed");const r=this.syncQueue.filter(n=>n.status==="failed"&&n.retryCount>=this.MAX_RETRIES);r.length>0&&(console.warn(`🗑️ Removing ${r.length} operations that exceeded max retries`),this.syncQueue=this.syncQueue.filter(n=>!(n.status==="failed"&&n.retryCount>=this.MAX_RETRIES))),this.saveSyncQueue(),Y.getState().updateLastSyncTime(),t.synced>0&&P.getState().addNotification({type:"success",title:"Sync Complete",message:`${t.synced} inventory changes synced successfully`}),t.failed>0&&P.getState().addNotification({type:"warning",title:"Sync Issues",message:`${t.failed} operations failed to sync`})}catch(s){console.error("🚨 Sync process failed:",s),t.success=!1,t.errors.push(`Sync process failed: ${s.message}`),P.getState().addNotification({type:"error",title:"Sync Failed",message:"Failed to sync inventory changes"})}finally{this.isSyncing=!1,Y.getState().setSyncStatus(!1),Y.getState().setPendingOperations(this.syncQueue.length)}return t}async syncSingleOperation(t){switch(t.entity){case"inventory_item":await this.syncInventoryItem(t);break;case"stock_transaction":await this.syncStockTransaction(t);break;default:throw new Error(`Unknown entity type: ${t.entity}`)}}async syncInventoryItem(t){const{type:s,data:r}=t;switch(s){case"CREATE":await F.createItem(r);break;case"UPDATE":await F.updateItem(r.id,r);break;case"DELETE":await F.deleteItem(r.id);break;default:throw new Error(`Unknown operation type for inventory item: ${s}`)}}async syncStockTransaction(t){const{type:s,data:r}=t;switch(s){case"STOCK_TRANSACTION":await F.addStockTransaction(r);break;default:throw new Error(`Unknown operation type for stock transaction: ${s}`)}}getSyncStatus(){return{isSyncing:this.isSyncing,pendingOperations:this.syncQueue.length,failedOperations:this.syncQueue.filter(t=>t.status==="failed").length,lastSyncTime:Y.getState().lastSyncTime,isOnline:navigator.onLine}}async forceSyncNow(){return console.log("🔴 Force sync requested"),await this.performSync()}clearSyncQueue(){this.syncQueue=[],this.saveSyncQueue(),Y.getState().setPendingOperations(0),console.log("🗑️ Sync queue cleared"),P.getState().addNotification({type:"info",title:"Sync Queue Cleared",message:"All pending sync operations have been removed"})}getSyncQueue(){return[...this.syncQueue]}async retryFailedOperations(){const t=this.syncQueue.filter(s=>s.status==="failed");return t.length===0?{success:!0,synced:0,failed:0,errors:[]}:(console.log(`🔄 Retrying ${t.length} failed operations`),t.forEach(s=>{s.status="pending",s.retryCount=0,s.error=void 0}),this.saveSyncQueue(),await this.performSync())}async syncInventoryItemById(t){try{const s=await F.getItemById(t);this.addToSyncQueue("UPDATE","inventory_item",s)}catch(s){throw console.error("Failed to sync inventory item:",s),s}}async bulkSyncInventoryItems(t){for(const s of t)try{await this.syncInventoryItemById(s)}catch(r){console.error(`Failed to queue sync for item ${s}:`,r)}}getSyncStatistics(){const t=this.syncQueue,s={total:t.length,pending:t.filter(r=>r.status==="pending").length,syncing:t.filter(r=>r.status==="syncing").length,failed:t.filter(r=>r.status==="failed").length,byType:{},byEntity:{},oldestOperation:t.length>0?t[0].timestamp:null,newestOperation:t.length>0?t[t.length-1].timestamp:null};return t.forEach(r=>{s.byType[r.type]=(s.byType[r.type]||0)+1,s.byEntity[r.entity]=(s.byEntity[r.entity]||0)+1}),s}}const de=new Hs,ke=le((a,t)=>({items:[],selectedItem:null,lowStockAlerts:[],expiringItems:[],stockSummary:null,isLoading:!1,error:null,lastSyncTime:null,loadItems:async(s={})=>{a({isLoading:!0,error:null});try{const r=await F.getAllItems(s);a({items:r,isLoading:!1,lastSyncTime:new Date().toISOString()})}catch(r){a({error:r.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Load Inventory",message:r.message})}},loadItemById:async s=>{a({isLoading:!0,error:null});try{const r=await F.getItemById(s);a({selectedItem:r,isLoading:!1});const{items:n}=t(),i=n.map(o=>o.id===s?r:o);a({items:i})}catch(r){a({error:r.message,isLoading:!1})}},createItem:async s=>{a({isLoading:!0,error:null});try{const r=await F.createItem(s),{items:n}=t();a({items:[...n,r],isLoading:!1}),de.addToSyncQueue("CREATE","inventory_item",r),P.getState().addNotification({type:"success",title:"Item Created",message:`${r.name} has been added to inventory`}),t().loadStockSummary()}catch(r){a({error:r.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Create Item",message:r.message})}},updateItem:async(s,r)=>{var n;a({isLoading:!0,error:null});try{const i=await F.updateItem(s,r),{items:o}=t(),l=o.map(m=>m.id===s?i:m);a({items:l,selectedItem:((n=t().selectedItem)==null?void 0:n.id)===s?i:t().selectedItem,isLoading:!1}),de.addToSyncQueue("UPDATE","inventory_item",i),P.getState().addNotification({type:"success",title:"Item Updated",message:`${i.name} has been updated`}),t().loadStockSummary(),t().loadLowStockAlerts()}catch(i){a({error:i.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Update Item",message:i.message})}},deleteItem:async s=>{var r;a({isLoading:!0,error:null});try{await F.deleteItem(s);const{items:n}=t(),i=n.filter(o=>o.id!==s);a({items:i,selectedItem:((r=t().selectedItem)==null?void 0:r.id)===s?null:t().selectedItem,isLoading:!1}),de.addToSyncQueue("DELETE","inventory_item",{id:s}),P.getState().addNotification({type:"success",title:"Item Deleted",message:"Item has been removed from inventory"}),t().loadStockSummary()}catch(n){a({error:n.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Delete Item",message:n.message})}},addStockTransaction:async s=>{a({isLoading:!0,error:null});try{await F.addStockTransaction(s),de.addToSyncQueue("STOCK_TRANSACTION","stock_transaction",s),await t().loadItemById(s.inventory_item_id),await t().loadItems(),P.getState().addNotification({type:"success",title:"Stock Updated",message:"Stock transaction has been recorded"}),t().loadStockSummary(),t().loadLowStockAlerts()}catch(r){a({error:r.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Update Stock",message:r.message})}},bulkUpdateStock:async s=>{a({isLoading:!0,error:null});try{await F.bulkUpdateStock(s),await t().loadItems(),P.getState().addNotification({type:"success",title:"Bulk Update Complete",message:`${s.length} items updated successfully`}),t().loadStockSummary(),t().loadLowStockAlerts()}catch(r){a({error:r.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Bulk Update Failed",message:r.message})}},loadLowStockAlerts:async()=>{try{const s=await F.getLowStockAlerts();a({lowStockAlerts:s})}catch(s){console.error("Failed to load low stock alerts:",s)}},loadExpiringItems:async(s=7)=>{try{const r=await F.getExpiringItems(s);a({expiringItems:r})}catch(r){console.error("Failed to load expiring items:",r)}},loadStockSummary:async()=>{try{const s=await F.getStockSummary();a({stockSummary:s})}catch(s){console.error("Failed to load stock summary:",s)}},checkStockAvailability:async s=>{try{return await F.checkStockAvailability(s)}catch(r){return console.error("Failed to check stock availability:",r),[]}},clearError:()=>{a({error:null})},setSelectedItem:s=>{a({selectedItem:s})},filterItems:s=>{const{items:r}=t();return r.filter(n=>{if(s.isActive!==void 0&&n.is_active!==s.isActive||s.lowStock&&(n.current_stock||0)>(n.minimum_stock||0)||s.outOfStock&&(n.current_stock||0)>0)return!1;if(s.expiringSoon&&n.expiry_date){const i=new Date(n.expiry_date),o=new Date;if(o.setDate(o.getDate()+7),i>o)return!1}return!0})},searchItems:s=>{const{items:r}=t(),n=s.toLowerCase();return r.filter(i=>i.name.toLowerCase().includes(n)||i.supplier_name&&i.supplier_name.toLowerCase().includes(n))},getItemById:s=>{const{items:r}=t();return r.find(n=>n.id===s)},refreshData:async()=>{const s=[t().loadItems(),t().loadLowStockAlerts(),t().loadExpiringItems(),t().loadStockSummary()];await Promise.all(s),P.getState().addNotification({type:"success",title:"Data Refreshed",message:"Inventory data has been updated"})},syncToCloud:async()=>{try{const s=await de.forceSyncNow();return s.success?P.getState().addNotification({type:"success",title:"Sync Complete",message:`${s.synced} changes synced to cloud`}):P.getState().addNotification({type:"error",title:"Sync Failed",message:"Failed to sync changes to cloud"}),s}catch(s){throw P.getState().addNotification({type:"error",title:"Sync Error",message:s.message}),s}},getSyncStatus:()=>de.getSyncStatus()})),Ks=({onViewDetails:a})=>{const{stockSummary:t,loadStockSummary:s,lowStockAlerts:r,expiringItems:n}=ke(),[i,o]=c.useState(!0);if(c.useEffect(()=>{(async()=>{o(!0),await s(),o(!1)})()},[s]),i)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((d,u)=>e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-secondary-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-8 bg-secondary-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-secondary-200 rounded w-full"})]},u))});const l=[{title:"Total Items",value:(t==null?void 0:t.totalItems)||0,subtitle:"Active inventory items",icon:"📦",color:"blue",action:()=>a("all")},{title:"Low Stock Alerts",value:(t==null?void 0:t.lowStockItems)||0,subtitle:"Items below minimum",icon:"⚠️",color:r.length>0?"orange":"green",action:()=>a("low-stock")},{title:"Out of Stock",value:(t==null?void 0:t.outOfStockItems)||0,subtitle:"Items completely out",icon:"🚫",color:((t==null?void 0:t.outOfStockItems)||0)>0?"red":"green",action:()=>a("out-of-stock")},{title:"Expiring Soon",value:(t==null?void 0:t.expiringItemsCount)||0,subtitle:"Items expiring in 7 days",icon:"⏰",color:n.length>0?"yellow":"green",action:()=>a("expiring")}],m=d=>{const u={blue:"bg-blue-50 border-blue-200 text-blue-800",green:"bg-green-50 border-green-200 text-green-800",orange:"bg-orange-50 border-orange-200 text-orange-800",red:"bg-red-50 border-red-200 text-red-800",yellow:"bg-yellow-50 border-yellow-200 text-yellow-800"};return u[d]||u.blue};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:l.map((d,u)=>e.jsxs("div",{onClick:d.action,className:`${m(d.color)} rounded-lg border-2 p-6 cursor-pointer transition-all duration-200 hover:shadow-lg hover:scale-105`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-2xl",children:d.icon}),e.jsx("button",{className:"text-xs font-medium px-2 py-1 bg-white rounded-full opacity-75 hover:opacity-100",children:"View Details"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium opacity-75 mb-1",children:d.title}),e.jsx("p",{className:"text-3xl font-bold mb-1",children:d.value.toLocaleString()}),e.jsx("p",{className:"text-xs opacity-75",children:d.subtitle})]})]},u))})},Qs=({filters:a,onFiltersChange:t,alertCounts:s})=>{const r=(o,l)=>{t({...a,[o]:l})},n=[{value:"all",label:"All Items",count:s.total},{value:"in_stock",label:"In Stock",count:null},{value:"low_stock",label:"Low Stock",count:s.lowStock},{value:"out_of_stock",label:"Out of Stock",count:s.outOfStock},{value:"expiring",label:"Expiring Soon",count:s.expiring}],i=[{value:"name",label:"Name"},{value:"stock",label:"Stock Level"},{value:"updated",label:"Last Updated"},{value:"expiry",label:"Expiry Date"}];return e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-4 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Search Items"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-secondary-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Search by name or supplier...",value:a.search,onChange:o=>r("search",o.target.value),className:"w-full pl-10 pr-4 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Status"}),e.jsx("div",{className:"space-y-2",children:n.map(o=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:o.value,checked:a.status===o.value,onChange:l=>r("status",l.target.value),className:"mr-2 text-primary-600 focus:ring-primary-500"}),e.jsxs("span",{className:"text-sm text-secondary-700",children:[o.label,o.count!==null&&o.count>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-red-100 text-red-800 rounded-full",children:o.count})]})]},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Sort By"}),e.jsx("select",{value:a.sortBy,onChange:o=>r("sortBy",o.target.value),className:"w-full p-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:i.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Order"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r("sortOrder","asc"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${a.sortOrder==="asc"?"bg-primary-100 text-primary-700 border-2 border-primary-300":"bg-secondary-100 text-secondary-700 border-2 border-secondary-200 hover:bg-secondary-200"}`,children:"↑ Ascending"}),e.jsx("button",{onClick:()=>r("sortOrder","desc"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${a.sortOrder==="desc"?"bg-primary-100 text-primary-700 border-2 border-primary-300":"bg-secondary-100 text-secondary-700 border-2 border-secondary-200 hover:bg-secondary-200"}`,children:"↓ Descending"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-secondary-200",children:[e.jsx("p",{className:"text-sm font-medium text-secondary-700 mb-2",children:"Quick Filters"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>r("status","low_stock"),className:"px-3 py-1 text-xs font-medium bg-orange-100 text-orange-800 rounded-full hover:bg-orange-200 transition-colors",children:["Low Stock (",s.lowStock,")"]}),e.jsxs("button",{onClick:()=>r("status","out_of_stock"),className:"px-3 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full hover:bg-red-200 transition-colors",children:["Out of Stock (",s.outOfStock,")"]}),e.jsxs("button",{onClick:()=>r("status","expiring"),className:"px-3 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full hover:bg-yellow-200 transition-colors",children:["Expiring Soon (",s.expiring,")"]})]})]})]})},Zs=({item:a,onClick:t,showActions:s=!0,onEdit:r,onAddStock:n,onViewHistory:i})=>{const o=()=>{const h=a.current_stock||0,f=a.minimum_stock||0;return h<=0?"out-of-stock":h<=f?"low-stock":h<=f*1.5?"warning":"good"},l=()=>{switch(o()){case"out-of-stock":return"bg-red-100 border-red-300 text-red-800";case"low-stock":return"bg-orange-100 border-orange-300 text-orange-800";case"warning":return"bg-yellow-100 border-yellow-300 text-yellow-800";default:return"bg-green-100 border-green-300 text-green-800"}},m=()=>{switch(o()){case"out-of-stock":return"Out of Stock";case"low-stock":return"Low Stock";case"warning":return"Warning";default:return"In Stock"}},d=()=>{if(!a.expiry_date)return!1;const h=new Date(a.expiry_date),f=new Date;return f.setDate(f.getDate()+7),h<=f},u=h=>new Date(h).toLocaleDateString();return e.jsxs("div",{className:`bg-white rounded-lg border-2 p-4 transition-all duration-200 hover:shadow-md ${t?"cursor-pointer hover:border-primary-300":""} ${o()==="out-of-stock"?"opacity-75":""}`,onClick:t,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 text-lg truncate",children:a.name}),a.supplier_name&&e.jsxs("p",{className:"text-sm text-secondary-500 mt-1",children:["Supplier: ",a.supplier_name]})]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${l()}`,children:m()})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary-500 uppercase tracking-wide",children:"Current Stock"}),e.jsxs("p",{className:"text-xl font-bold text-secondary-900",children:[a.current_stock||0," ",e.jsx("span",{className:"text-sm font-normal",children:a.unit})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary-500 uppercase tracking-wide",children:"Minimum Stock"}),e.jsxs("p",{className:"text-lg font-semibold text-secondary-700",children:[a.minimum_stock||0," ",e.jsx("span",{className:"text-sm font-normal",children:a.unit})]})]})]}),a.cost_per_unit&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-xs text-secondary-500 uppercase tracking-wide",children:["Cost per ",a.unit]}),e.jsxs("p",{className:"text-lg font-semibold text-secondary-700",children:["₹",a.cost_per_unit.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-secondary-500",children:["Total Value: ₹",((a.cost_per_unit||0)*(a.current_stock||0)).toFixed(2)]})]}),d()&&e.jsx("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded",children:e.jsxs("p",{className:"text-xs text-red-800 font-medium",children:["⚠️ Expires: ",u(a.expiry_date)]})}),s&&e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-secondary-200",children:[e.jsx("button",{onClick:h=>{h.stopPropagation(),r==null||r()},className:"flex-1 px-3 py-2 text-sm font-medium text-secondary-700 bg-secondary-100 rounded hover:bg-secondary-200 transition-colors",children:"Edit"}),e.jsx("button",{onClick:h=>{h.stopPropagation(),n==null||n()},className:"flex-1 px-3 py-2 text-sm font-medium text-primary-700 bg-primary-100 rounded hover:bg-primary-200 transition-colors",children:"Add Stock"}),e.jsx("button",{onClick:h=>{h.stopPropagation(),i==null||i()},className:"px-3 py-2 text-sm font-medium text-secondary-600 border border-secondary-300 rounded hover:bg-secondary-50 transition-colors",children:"History"})]})]})},Gs=({isOpen:a,onClose:t,item:s})=>{var x;const[r,n]=c.useState("IN"),[i,o]=c.useState(""),[l,m]=c.useState(((x=s.cost_per_unit)==null?void 0:x.toString())||""),[d,u]=c.useState(""),[h,f]=c.useState(!1),{addStockTransaction:I}=ke(),j=async b=>{if(b.preventDefault(),!i||parseFloat(i)<=0){alert("Please enter a valid quantity");return}f(!0);try{await I({inventory_item_id:s.id,transaction_type:r,quantity:parseFloat(i),cost_per_unit:l?parseFloat(l):void 0,reference_type:"MANUAL",notes:d||`Manual ${r.toLowerCase()} transaction`}),o(""),u(""),t()}catch(w){console.error("Failed to add stock transaction:",w)}finally{f(!1)}},y=()=>{const b=s.current_stock||0,w=parseFloat(i)||0;switch(r){case"IN":return b+w;case"OUT":return Math.max(0,b-w);case"ADJUSTMENT":return w;default:return b}};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-secondary-900",children:["Update Stock: ",s.name]}),e.jsx("button",{onClick:t,className:"text-secondary-500 hover:text-secondary-700 text-2xl",children:"×"})]}),e.jsx("div",{className:"bg-secondary-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500",children:"Current Stock"}),e.jsxs("p",{className:"font-semibold text-lg",children:[s.current_stock||0," ",s.unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500",children:"Minimum Stock"}),e.jsxs("p",{className:"font-semibold text-lg",children:[s.minimum_stock||0," ",s.unit]})]})]})}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Transaction Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"IN",label:"Add Stock",color:"green"},{value:"OUT",label:"Remove Stock",color:"red"},{value:"ADJUSTMENT",label:"Adjust Total",color:"blue"}].map(({value:b,label:w,color:g})=>e.jsx("button",{type:"button",onClick:()=>n(b),className:`p-3 rounded-lg border-2 text-sm font-medium transition-colors ${r===b?`border-${g}-500 bg-${g}-50 text-${g}-700`:"border-secondary-200 bg-white text-secondary-600 hover:border-secondary-300"}`,children:w},b))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:[r==="ADJUSTMENT"?"New Total Quantity":"Quantity"," ","(",s.unit,")"]}),e.jsx("input",{type:"number",value:i,onChange:b=>o(b.target.value),step:"0.001",min:"0",className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:`Enter quantity in ${s.unit}`,required:!0})]}),r==="IN"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:["Cost per ",s.unit," (Optional)"]}),e.jsx("input",{type:"number",value:l,onChange:b=>m(b.target.value),step:"0.01",min:"0",className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter cost per unit"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:d,onChange:b=>u(b.target.value),rows:3,className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Add notes about this transaction..."})]}),i&&e.jsxs("div",{className:"bg-primary-50 rounded-lg p-4",children:[e.jsxs("p",{className:"text-sm text-primary-700",children:[e.jsx("strong",{children:"Preview:"})," Stock will"," ",r==="ADJUSTMENT"?"be set to":"change to"," ",e.jsxs("span",{className:"font-bold",children:[y()," ",s.unit]})]}),l&&r==="IN"&&e.jsxs("p",{className:"text-sm text-primary-600 mt-1",children:["Total Cost: ₹",(parseFloat(i)*parseFloat(l)).toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 text-secondary-700 bg-secondary-100 rounded-lg hover:bg-secondary-200 transition-colors",disabled:h,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h||!i,className:"flex-1 px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Processing...":"Update Stock"})]})]})]})}):null},Js=({onClose:a})=>{const[t,s]=c.useState([]),[r,n]=c.useState({startDate:new Date(Date.now()-10080*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[i,o]=c.useState(!1),[l,m]=c.useState(null),d=async()=>{o(!0),m(null);try{const j=await F.getStockUsageReport(r.startDate,r.endDate);s(j)}catch(j){m(j.message||"Failed to load stock usage report")}finally{o(!1)}};c.useEffect(()=>{d()},[r]);const u=(j,y)=>{n(x=>({...x,[j]:y}))},h=()=>t.reduce((j,y)=>j+y.total_used,0),f=j=>{const y=new Date(r.startDate),x=new Date(r.endDate),b=Math.ceil((x.getTime()-y.getTime())/(1e3*60*60*24))||1;return(j.total_used/b).toFixed(2)},I=()=>{const y=[["Item Name","Unit","Total Used","Transaction Count","Avg Daily Usage"].join(","),...t.map(g=>[g.inventory_item.name,g.inventory_item.unit,g.total_used,g.transaction_count,f(g)].join(","))].join(`
`),x=new Blob([y],{type:"text/csv"}),b=window.URL.createObjectURL(x),w=document.createElement("a");w.href=b,w.download=`stock-usage-report-${r.startDate}-to-${r.endDate}.csv`,w.click(),window.URL.revokeObjectURL(b)};return e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-secondary-900",children:"Stock Usage Report"}),e.jsx("p",{className:"text-sm text-secondary-500 mt-1",children:"View inventory consumption patterns and trends"})]}),a&&e.jsx("button",{onClick:a,className:"text-secondary-500 hover:text-secondary-700 text-2xl",children:"×"})]}),e.jsx("div",{className:"mb-6 p-4 bg-secondary-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:r.startDate,onChange:j=>u("startDate",j.target.value),className:"w-full p-2 border border-secondary-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:r.endDate,onChange:j=>u("endDate",j.target.value),className:"w-full p-2 border border-secondary-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,disabled:i,className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-700 disabled:opacity-50 transition-colors",children:i?"Loading...":"Generate Report"}),e.jsx("button",{onClick:I,disabled:i||t.length===0,className:"px-4 py-2 bg-secondary-600 text-white rounded hover:bg-secondary-700 disabled:opacity-50 transition-colors",children:"Export CSV"})]})]})}),t.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-1",children:"Total Items Tracked"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:t.length})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-green-800 mb-1",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:t.reduce((j,y)=>j+y.transaction_count,0)})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-800 mb-1",children:"Total Usage Volume"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:h().toFixed(2)})]})]}),l&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-800",children:l})}),i&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-secondary-600",children:"Generating report..."})]}),!i&&t.length===0&&!l&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-secondary-400 text-4xl mb-4",children:"📊"}),e.jsx("h3",{className:"text-lg font-medium text-secondary-900 mb-2",children:"No Usage Data Found"}),e.jsx("p",{className:"text-secondary-500",children:"No stock usage recorded for the selected date range."})]}),!i&&t.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-secondary-50",children:[e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-left text-sm font-semibold text-secondary-900",children:"Item Name"}),e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-left text-sm font-semibold text-secondary-900",children:"Unit"}),e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-right text-sm font-semibold text-secondary-900",children:"Total Used"}),e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-right text-sm font-semibold text-secondary-900",children:"Transactions"}),e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-right text-sm font-semibold text-secondary-900",children:"Avg Daily Usage"}),e.jsx("th",{className:"border border-secondary-200 px-4 py-3 text-center text-sm font-semibold text-secondary-900",children:"Usage Pattern"})]})}),e.jsx("tbody",{children:t.sort((j,y)=>y.total_used-j.total_used).map((j,y)=>e.jsxs("tr",{className:y%2===0?"bg-white":"bg-secondary-50",children:[e.jsx("td",{className:"border border-secondary-200 px-4 py-3",children:e.jsx("div",{className:"font-medium text-secondary-900",children:j.inventory_item.name})}),e.jsx("td",{className:"border border-secondary-200 px-4 py-3 text-secondary-600",children:j.inventory_item.unit}),e.jsx("td",{className:"border border-secondary-200 px-4 py-3 text-right font-semibold",children:j.total_used.toFixed(2)}),e.jsx("td",{className:"border border-secondary-200 px-4 py-3 text-right",children:j.transaction_count}),e.jsx("td",{className:"border border-secondary-200 px-4 py-3 text-right",children:f(j)}),e.jsx("td",{className:"border border-secondary-200 px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:Array.from({length:5},(x,b)=>{const w=Math.min(1,j.total_used/Math.max(...t.map(g=>g.total_used)));return e.jsx("div",{className:`w-2 h-8 mx-0.5 rounded-sm ${b<w*5?"bg-primary-500":"bg-secondary-200"}`},b)})})})]},j.inventory_item.id))})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-secondary-200",children:[e.jsx("p",{className:"text-sm font-medium text-secondary-700 mb-2",children:"Quick Date Ranges:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Today",days:0},{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 3 months",days:90}].map(({label:j,days:y})=>e.jsx("button",{onClick:()=>{const x=new Date().toISOString().split("T")[0],b=new Date(Date.now()-y*24*60*60*1e3).toISOString().split("T")[0];n({startDate:b,endDate:x})},className:"px-3 py-1 text-xs font-medium bg-secondary-100 text-secondary-700 rounded hover:bg-secondary-200 transition-colors",children:j},j))})]})]})},Ys=({transactions:a,isLoading:t=!1})=>{const s=o=>{switch(o){case"IN":return"⬆️";case"OUT":return"⬇️";case"ADJUSTMENT":return"⚖️";default:return"📝"}},r=o=>{switch(o){case"IN":return"text-green-700 bg-green-50 border-green-200";case"OUT":return"text-red-700 bg-red-50 border-red-200";case"ADJUSTMENT":return"text-blue-700 bg-blue-50 border-blue-200";default:return"text-secondary-700 bg-secondary-50 border-secondary-200"}},n=o=>{const l=new Date(o);return{date:l.toLocaleDateString(),time:l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},i=o=>{switch(o.transaction_type){case"IN":return"Stock added";case"OUT":return"Stock removed";case"ADJUSTMENT":return"Stock adjusted";default:return"Stock transaction"}};return t?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((o,l)=>e.jsx("div",{className:"bg-white border border-secondary-200 rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-secondary-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-secondary-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-secondary-200 rounded w-1/2"})]}),e.jsx("div",{className:"h-6 bg-secondary-200 rounded w-16"})]})},l))}):a.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-secondary-400 text-4xl mb-4",children:"📝"}),e.jsx("h3",{className:"text-lg font-medium text-secondary-900 mb-2",children:"No Transactions Found"}),e.jsx("p",{className:"text-secondary-500",children:"No stock transactions have been recorded for this item yet."})]}):e.jsx("div",{className:"space-y-3",children:a.map(o=>{var m,d;const l=n(o.created_at);return e.jsx("div",{className:`border-2 rounded-lg p-4 ${r(o.transaction_type)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:s(o.transaction_type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:i(o)}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-white rounded-full opacity-75",children:o.transaction_type})]}),e.jsxs("div",{className:"text-sm opacity-80",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Quantity:"})," ",o.quantity,((m=o.inventory_item)==null?void 0:m.unit)&&` ${o.inventory_item.unit}`]}),o.cost_per_unit&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cost per unit:"})," ₹",o.cost_per_unit.toFixed(2)]}),o.total_cost&&e.jsxs("p",{children:[e.jsx("strong",{children:"Total cost:"})," ₹",o.total_cost.toFixed(2)]}),o.reference_type&&e.jsxs("p",{children:[e.jsx("strong",{children:"Reference:"})," ",o.reference_type,o.reference_id&&` (${o.reference_id})`]}),((d=o.user)==null?void 0:d.username)&&e.jsxs("p",{children:[e.jsx("strong",{children:"By:"})," ",o.user.username]})]}),o.notes&&e.jsxs("div",{className:"mt-2 p-2 bg-white bg-opacity-50 rounded text-sm",children:[e.jsx("strong",{children:"Notes:"})," ",o.notes]})]})]}),e.jsxs("div",{className:"text-right text-xs opacity-75",children:[e.jsx("p",{className:"font-medium",children:l.date}),e.jsx("p",{children:l.time})]})]})},o.id)})})},Xs=({isOpen:a,onClose:t,item:s})=>{const[r,n]=c.useState({name:"",unit:"",current_stock:"",minimum_stock:"",cost_per_unit:"",supplier_name:"",supplier_contact:"",expiry_date:""}),[i,o]=c.useState(!1),{createItem:l,updateItem:m}=ke();c.useEffect(()=>{var h,f,I;n(s?{name:s.name||"",unit:s.unit||"",current_stock:((h=s.current_stock)==null?void 0:h.toString())||"",minimum_stock:((f=s.minimum_stock)==null?void 0:f.toString())||"",cost_per_unit:((I=s.cost_per_unit)==null?void 0:I.toString())||"",supplier_name:s.supplier_name||"",supplier_contact:s.supplier_contact||"",expiry_date:s.expiry_date?new Date(s.expiry_date).toISOString().split("T")[0]:""}:{name:"",unit:"",current_stock:"",minimum_stock:"",cost_per_unit:"",supplier_name:"",supplier_contact:"",expiry_date:""})},[s,a]);const d=async h=>{if(h.preventDefault(),!r.name.trim()||!r.unit.trim()){alert("Name and unit are required");return}o(!0);try{const f={name:r.name.trim(),unit:r.unit.trim(),current_stock:r.current_stock?parseFloat(r.current_stock):0,minimum_stock:r.minimum_stock?parseFloat(r.minimum_stock):0};r.cost_per_unit&&(f.cost_per_unit=parseFloat(r.cost_per_unit)),r.supplier_name&&(f.supplier_name=r.supplier_name.trim()),r.supplier_contact&&(f.supplier_contact=r.supplier_contact.trim()),r.expiry_date&&(f.expiry_date=r.expiry_date),s?await m(s.id,f):await l(f),t()}catch(f){console.error("Failed to save item:",f)}finally{o(!1)}},u=(h,f)=>{n(I=>({...I,[h]:f}))};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary-900",children:s?"Edit Item":"Add New Item"}),e.jsx("button",{onClick:t,className:"text-secondary-500 hover:text-secondary-700 text-2xl",children:"×"})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Item Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:h=>u("name",h.target.value),className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter item name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Unit *"}),e.jsxs("select",{value:r.unit,onChange:h=>u("unit",h.target.value),className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e.jsx("option",{value:"",children:"Select unit"}),e.jsx("option",{value:"grams",children:"Grams (g)"}),e.jsx("option",{value:"kilograms",children:"Kilograms (kg)"}),e.jsx("option",{value:"liters",children:"Liters (L)"}),e.jsx("option",{value:"milliliters",children:"Milliliters (mL)"}),e.jsx("option",{value:"pieces",children:"Pieces (pcs)"}),e.jsx("option",{value:"packets",children:"Packets"}),e.jsx("option",{value:"boxes",children:"Boxes"}),e.jsx("option",{value:"bottles",children:"Bottles"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Current Stock"}),e.jsx("input",{type:"number",value:r.current_stock,onChange:h=>u("current_stock",h.target.value),step:"0.001",min:"0",className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Minimum Stock"}),e.jsx("input",{type:"number",value:r.minimum_stock,onChange:h=>u("minimum_stock",h.target.value),step:"0.001",min:"0",className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Cost per Unit (₹)"}),e.jsx("input",{type:"number",value:r.cost_per_unit,onChange:h=>u("cost_per_unit",h.target.value),step:"0.01",min:"0",className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Supplier Name"}),e.jsx("input",{type:"text",value:r.supplier_name,onChange:h=>u("supplier_name",h.target.value),className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter supplier name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Supplier Contact"}),e.jsx("input",{type:"text",value:r.supplier_contact,onChange:h=>u("supplier_contact",h.target.value),className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Phone number or email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Expiry Date (Optional)"}),e.jsx("input",{type:"date",value:r.expiry_date,onChange:h=>u("expiry_date",h.target.value),className:"w-full p-3 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 text-secondary-700 bg-secondary-100 rounded-lg hover:bg-secondary-200 transition-colors",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i||!r.name.trim()||!r.unit.trim(),className:"flex-1 px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?"Saving...":s?"Update Item":"Create Item"})]})]})]})}):null},er=()=>{const{items:a,selectedItem:t,lowStockAlerts:s,expiringItems:r,isLoading:n,error:i,loadItems:o,loadLowStockAlerts:l,loadExpiringItems:m,loadStockSummary:d,setSelectedItem:u,refreshData:h,syncToCloud:f,getSyncStatus:I}=ke(),[j,y]=c.useState("dashboard"),[x,b]=c.useState(!1),[w,g]=c.useState(!1),[p,k]=c.useState(null),[D,v]=c.useState({search:"",status:"all",sortBy:"name",sortOrder:"asc"});c.useEffect(()=>{(async()=>{await o(),await l(),await m(),await d()})()},[]);const E=Ye.useMemo(()=>{let S=a;if(D.search){const A=D.search.toLowerCase();S=S.filter(L=>L.name.toLowerCase().includes(A)||L.supplier_name&&L.supplier_name.toLowerCase().includes(A))}switch(D.status){case"in_stock":S=S.filter(L=>(L.current_stock||0)>(L.minimum_stock||0));break;case"low_stock":S=S.filter(L=>{const q=L.current_stock||0,K=L.minimum_stock||0;return q<=K&&q>0});break;case"out_of_stock":S=S.filter(L=>(L.current_stock||0)<=0);break;case"expiring":const A=new Date;A.setDate(A.getDate()+7),S=S.filter(L=>L.expiry_date?new Date(L.expiry_date)<=A:!1);break}return S.sort((A,L)=>{let q,K;switch(D.sortBy){case"name":q=A.name,K=L.name;break;case"stock":q=A.current_stock||0,K=L.current_stock||0;break;case"updated":q=new Date(A.updated_at),K=new Date(L.updated_at);break;case"expiry":q=A.expiry_date?new Date(A.expiry_date):new Date("9999-12-31"),K=L.expiry_date?new Date(L.expiry_date):new Date("9999-12-31");break;default:return 0}return q<K?D.sortOrder==="asc"?-1:1:q>K?D.sortOrder==="asc"?1:-1:0}),S},[a,D]),$={total:a.length,lowStock:s.length,outOfStock:a.filter(S=>(S.current_stock||0)<=0).length,expiring:r.length},C=S=>{switch(S){case"low-stock":v(A=>({...A,status:"low_stock"})),y("items");break;case"out-of-stock":v(A=>({...A,status:"out_of_stock"})),y("items");break;case"expiring":v(A=>({...A,status:"expiring"})),y("items");break;default:y("items")}},R=S=>{k(S),g(!0)},O=S=>{u(S),b(!0)},W=S=>{u(S),y("history")},_=I();return i?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold text-secondary-900",children:"Inventory Management"})}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx("h2",{className:"text-lg font-medium text-red-800 mb-2",children:"Error Loading Inventory"}),e.jsx("p",{className:"text-red-600 mb-4",children:i}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]})]}):e.jsxs(re,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary-900",children:"Inventory Management"}),e.jsx("p",{className:"text-sm text-secondary-500 mt-1",children:"Track stock levels, manage inventory, and monitor alerts"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_.isSyncing?"bg-blue-500 animate-pulse":_.isOnline?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-secondary-600",children:_.isSyncing?"Syncing...":_.isOnline?"Online":"Offline"}),_.pendingOperations>0&&e.jsxs("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded-full",children:[_.pendingOperations," pending"]})]}),e.jsx("button",{onClick:h,disabled:n,className:"px-3 py-2 text-sm font-medium text-secondary-700 bg-white border border-secondary-300 rounded hover:bg-secondary-50 disabled:opacity-50",children:n?"Loading...":"Refresh"}),e.jsx("button",{onClick:f,disabled:_.isSyncing||!_.isOnline,className:"px-3 py-2 text-sm font-medium text-blue-700 bg-blue-100 border border-blue-300 rounded hover:bg-blue-200 disabled:opacity-50",children:"Sync to Cloud"}),e.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-700",children:"Add Item"})]})]}),e.jsx("div",{className:"border-b border-secondary-200",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:"📊"},{id:"items",label:"Items",icon:"📦"},{id:"report",label:"Usage Report",icon:"📈"},{id:"history",label:"History",icon:"📜"}].map(S=>e.jsxs("button",{onClick:()=>y(S.id),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${j===S.id?"border-primary-500 text-primary-600":"border-transparent text-secondary-500 hover:text-secondary-700 hover:border-secondary-300"}`,children:[e.jsx("span",{className:"mr-2",children:S.icon}),S.label]},S.id))})}),j==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ks,{onViewDetails:C}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>y("report"),className:"p-4 bg-white border border-secondary-200 rounded-lg hover:border-primary-300 hover:shadow-md transition-all",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 mb-2",children:"📈 Usage Report"}),e.jsx("p",{className:"text-sm text-secondary-600",children:"View detailed stock usage analytics"})]}),e.jsxs("button",{onClick:()=>{v(S=>({...S,status:"low_stock"})),y("items")},className:"p-4 bg-white border border-secondary-200 rounded-lg hover:border-primary-300 hover:shadow-md transition-all",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 mb-2",children:"⚠️ Low Stock Items"}),e.jsx("p",{className:"text-sm text-secondary-600",children:"Manage items below minimum threshold"})]}),e.jsxs("button",{onClick:()=>{v(S=>({...S,status:"expiring"})),y("items")},className:"p-4 bg-white border border-secondary-200 rounded-lg hover:border-primary-300 hover:shadow-md transition-all",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 mb-2",children:"⏰ Expiring Items"}),e.jsx("p",{className:"text-sm text-secondary-600",children:"Items expiring within 7 days"})]})]})]}),j==="items"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Qs,{filters:D,onFiltersChange:v,alertCounts:$}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((S,A)=>e.jsxs("div",{className:"bg-white rounded-lg border border-secondary-200 p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-secondary-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-8 bg-secondary-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-secondary-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-secondary-200 rounded w-2/3"})]},A))}):E.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-secondary-400 text-4xl mb-4",children:"📦"}),e.jsx("h3",{className:"text-lg font-medium text-secondary-900 mb-2",children:"No items found"}),e.jsx("p",{className:"text-secondary-500 mb-4",children:D.search||D.status!=="all"?"Try adjusting your filters":"Get started by adding your first inventory item"}),e.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-700",children:"Add First Item"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:E.map(S=>e.jsx(Zs,{item:S,onEdit:()=>R(S),onAddStock:()=>O(S),onViewHistory:()=>W(S)},S.id))})]}),j==="report"&&e.jsx(Js,{}),j==="history"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary-900",children:t?`Transaction History: ${t.name}`:"Transaction History"}),e.jsx("button",{onClick:()=>y("dashboard"),className:"px-3 py-2 text-sm font-medium text-secondary-700 bg-white border border-secondary-300 rounded hover:bg-secondary-50",children:"Back to Dashboard"})]}),t&&e.jsx(Ys,{transactions:[],isLoading:n})]}),x&&t&&e.jsx(Gs,{isOpen:x,onClose:()=>{b(!1),u(null)},item:t}),w&&e.jsx(Xs,{isOpen:w,onClose:()=>{g(!1),k(null)},item:p})]})},tr=({report:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Daily Sales Summary - ",new Date(a.date).toLocaleDateString()]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["₹",a.total_sales.toLocaleString()]}),e.jsx("div",{className:"text-sm text-blue-800",children:"Total Sales"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.total_orders}),e.jsx("div",{className:"text-sm text-green-800",children:"Total Orders"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["₹",a.average_order_value.toFixed(2)]}),e.jsx("div",{className:"text-sm text-purple-800",children:"Average Order Value"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["₹",(a.total_sales/8).toFixed(0)]}),e.jsx("div",{className:"text-sm text-orange-800",children:"Per Hour Average"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Payment Methods"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["₹",a.payment_method_breakdown.cash.amount.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Cash (",a.payment_method_breakdown.cash.count," orders)"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["₹",a.payment_method_breakdown.card.amount.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Card (",a.payment_method_breakdown.card.count," orders)"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["₹",a.payment_method_breakdown.upi.amount.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["UPI (",a.payment_method_breakdown.upi.count," orders)"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["₹",a.payment_method_breakdown.online.amount.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Online (",a.payment_method_breakdown.online.count," orders)"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Top Selling Items"}),e.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity Sold"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.top_selling_items.map((t,s)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[s+1,". ",t.product_name]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.quantity_sold}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",t.revenue.toLocaleString()]})]},t.product_id))})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Hourly Sales"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"flex items-end justify-between h-32",children:a.hourly_sales.map(t=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-blue-500 rounded-t w-8",style:{height:`${t.sales/2500*100}px`}}),e.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:[t.hour,":00"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["₹",t.sales]})]},t.hour))})})]})]})]}),sr=({report:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Monthly Sales Summary - ",a.month," ",a.year]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["₹",a.total_sales.toLocaleString()]}),e.jsx("div",{className:"text-sm text-blue-800",children:"Total Sales"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.total_orders}),e.jsx("div",{className:"text-sm text-green-800",children:"Total Orders"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["₹",a.total_profit.toLocaleString()]}),e.jsx("div",{className:"text-sm text-purple-800",children:"Total Profit"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["₹",(a.total_sales/a.total_orders).toFixed(0)]}),e.jsx("div",{className:"text-sm text-orange-800",children:"Average Order Value"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Payment Trends"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[a.payment_trends.cash_percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cash"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[a.payment_trends.card_percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Card"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[a.payment_trends.upi_percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"UPI"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[a.payment_trends.online_percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Online"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Top Selling Items"}),e.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity Sold"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.top_selling_items.map((t,s)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[s+1,". ",t.product_name]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.quantity_sold}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",t.revenue.toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",t.profit.toLocaleString()]})]},t.product_id))})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Stock Usage"}),e.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Used"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.stock_usage.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.item_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.total_used}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",t.cost.toLocaleString()]})]},t.inventory_item_id))})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Daily Breakdown"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"flex items-end justify-between h-32",children:a.daily_breakdown.slice(0,7).map(t=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-green-500 rounded-t w-8",style:{height:`${t.sales/1e4*100}px`}}),e.jsx("div",{className:"text-xs text-gray-600 mt-2",children:new Date(t.date).getDate()}),e.jsxs("div",{className:"text-xs text-gray-500",children:["₹",t.sales]})]},t.date))})})]})]})]}),rr=({filters:a,onFiltersChange:t})=>{const s=(r,n)=>{t({...a,[r]:n})};return e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:a.payment_method||"all",onChange:r=>s("payment_method",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Payment Methods"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"online",children:"Online"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Type"}),e.jsxs("select",{value:a.order_type||"all",onChange:r=>s("order_type",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Order Types"}),e.jsx("option",{value:"dine_in",children:"Dine-in"}),e.jsx("option",{value:"takeaway",children:"Takeaway"}),e.jsx("option",{value:"zomato",children:"Zomato"}),e.jsx("option",{value:"swiggy",children:"Swiggy"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"date",value:a.date_from||"",onChange:r=>s("date_from",r.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"From"}),e.jsx("input",{type:"date",value:a.date_to||"",onChange:r=>s("date_to",r.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"To"})]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:()=>t({payment_method:"all",order_type:"all"}),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Clear Filters"})})]})},ar=({report:a,reportType:t,onExportPDF:s,onPrint:r})=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export & Print"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),e.jsxs("button",{onClick:r,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Print Report"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Report Summary:"})," ",t==="daily"?`Daily sales report for ${a.date}`:`Monthly sales report for ${a.month} ${a.year}`]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Generated:"})," ",new Date().toLocaleString()]})]})]}),nr=le((a,t)=>({dailyReport:null,monthlyReport:null,isLoading:!1,error:null,fetchDailyReport:async s=>{a({isLoading:!0,error:null});try{await new Promise(n=>setTimeout(n,1e3)),a({dailyReport:{date:s,total_sales:12500,total_orders:45,cash_sales:8e3,card_sales:3500,upi_sales:1e3,online_sales:0,average_order_value:277.78,top_selling_items:[{product_id:"1",product_name:"Chocolate Cake",quantity_sold:12,revenue:2400},{product_id:"2",product_name:"Vanilla Ice Cream",quantity_sold:18,revenue:1800},{product_id:"3",product_name:"Brownie",quantity_sold:15,revenue:1500}],payment_method_breakdown:{cash:{count:32,amount:8e3},card:{count:8,amount:3500},upi:{count:5,amount:1e3},online:{count:0,amount:0}},hourly_sales:[{hour:10,sales:1200,orders:4},{hour:11,sales:1800,orders:6},{hour:12,sales:2200,orders:8},{hour:13,sales:1900,orders:7},{hour:14,sales:1600,orders:6},{hour:15,sales:1400,orders:5},{hour:16,sales:1200,orders:4},{hour:17,sales:1200,orders:5}]},isLoading:!1})}catch(r){a({error:r.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Load Daily Report",message:r.message})}},fetchMonthlyReport:async(s,r)=>{a({isLoading:!0,error:null});try{await new Promise(i=>setTimeout(i,1e3)),a({monthlyReport:{month:s,year:r,total_sales:285e3,total_orders:1020,total_profit:85500,daily_breakdown:[{date:"2024-01-01",sales:8500,orders:32,profit:2550},{date:"2024-01-02",sales:9200,orders:35,profit:2760},{date:"2024-01-03",sales:8800,orders:33,profit:2640}],top_selling_items:[{product_id:"1",product_name:"Chocolate Cake",quantity_sold:280,revenue:56e3,profit:16800},{product_id:"2",product_name:"Vanilla Ice Cream",quantity_sold:320,revenue:32e3,profit:9600},{product_id:"3",product_name:"Brownie",quantity_sold:250,revenue:25e3,profit:7500}],payment_trends:{cash_percentage:65,card_percentage:25,upi_percentage:8,online_percentage:2},stock_usage:[{inventory_item_id:"1",item_name:"Flour",total_used:150,cost:3e3},{inventory_item_id:"2",item_name:"Sugar",total_used:120,cost:2400},{inventory_item_id:"3",item_name:"Chocolate",total_used:80,cost:4e3}]},isLoading:!1})}catch(n){a({error:n.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Load Monthly Report",message:n.message})}},generateReport:async(s,r,n)=>{a({isLoading:!0,error:null});try{if(s==="daily")await t().fetchDailyReport(r,n);else{const[i,o]=r.split("-");await t().fetchMonthlyReport(i,parseInt(o),n)}}catch(i){a({error:i.message,isLoading:!1})}},regenerateReport:async(s,r,n)=>{a({isLoading:!0,error:null});try{if(s==="daily")await t().fetchDailyReport(r,n);else{const[i,o]=r.split("-");await t().fetchMonthlyReport(i,parseInt(o),n)}}catch(i){a({error:i.message,isLoading:!1})}},exportToPDF:async(s="daily")=>{try{await new Promise(r=>setTimeout(r,2e3)),P.getState().addNotification({type:"success",title:"PDF Exported",message:`${s} report exported successfully`})}catch(r){P.getState().addNotification({type:"error",title:"Export Failed",message:r.message})}},printReport:async(s="daily")=>{try{await new Promise(r=>setTimeout(r,1500)),P.getState().addNotification({type:"success",title:"Report Printed",message:`${s} report sent to printer`})}catch(r){P.getState().addNotification({type:"error",title:"Print Failed",message:r.message})}},clearCache:()=>{a({dailyReport:null,monthlyReport:null})}})),ir=()=>{const[a,t]=c.useState("daily"),[s,r]=c.useState(new Date().toISOString().split("T")[0]),[n,i]=c.useState(new Date().toISOString().slice(0,7)),[o,l]=c.useState({payment_method:"all",order_type:"all"}),[m,d]=c.useState(!1),{dailyReport:u,monthlyReport:h,fetchDailyReport:f,fetchMonthlyReport:I,generateReport:j,regenerateReport:y,exportToPDF:x,printReport:b,clearCache:w}=nr(),{addNotification:g}=P();c.useEffect(()=>{p()},[s,n,o]);const p=async()=>{d(!0);try{if(a==="daily")await f(s,o);else{const[O,W]=n.split("-");await I(W,parseInt(O),o)}}catch{g({type:"error",title:"Report Loading Failed",message:"Failed to load report data. Please try again."})}finally{d(!1)}},k=async()=>{d(!0);try{if(a==="daily")await j("daily",s,o),g({type:"success",title:"Report Generated",message:"Daily report has been generated successfully."});else{const[O,W]=n.split("-");await j("monthly",`${W}-${O}`,o),g({type:"success",title:"Report Generated",message:"Monthly report has been generated successfully."})}}catch{g({type:"error",title:"Report Generation Failed",message:"Failed to generate report. Please try again."})}finally{d(!1)}},D=async()=>{d(!0);try{if(a==="daily")await y("daily",s,o),g({type:"success",title:"Report Regenerated",message:"Daily report has been regenerated successfully."});else{const[O,W]=n.split("-");await y("monthly",`${W}-${O}`,o),g({type:"success",title:"Report Regenerated",message:"Monthly report has been regenerated successfully."})}}catch{g({type:"error",title:"Report Regeneration Failed",message:"Failed to regenerate report. Please try again."})}finally{d(!1)}},v=async()=>{try{a==="daily"&&u?(await x("daily"),g({type:"success",title:"PDF Exported",message:"Daily report has been exported to PDF."})):a==="monthly"&&h&&(await x("monthly"),g({type:"success",title:"PDF Exported",message:"Monthly report has been exported to PDF."}))}catch{g({type:"error",title:"Export Failed",message:"Failed to export report to PDF. Please try again."})}},E=async()=>{try{a==="daily"&&u?(await b("daily"),g({type:"success",title:"Report Printed",message:"Daily report has been sent to printer."})):a==="monthly"&&h&&(await b("monthly"),g({type:"success",title:"Report Printed",message:"Monthly report has been sent to printer."}))}catch{g({type:"error",title:"Print Failed",message:"Failed to print report. Please try again."})}},$=O=>{l(O)},C=()=>{w(),g({type:"success",title:"Cache Cleared",message:"Report cache has been cleared successfully."})},R=a==="daily"?u:h;return e.jsx(re,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Generate and analyze sales reports, track performance, and export data"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:C,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Clear Cache"]})})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>t("daily"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="daily"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(et,{className:"h-5 w-5 inline mr-2"}),"Daily Summary"]}),e.jsxs("button",{onClick:()=>t("monthly"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="monthly"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(ue,{className:"h-5 w-5 inline mr-2"}),"Monthly Summary"]})]})})}),e.jsx("div",{className:"mb-6",children:a==="daily"?e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select Date:"}),e.jsx("input",{type:"date",value:s,onChange:O=>r(O.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}):e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select Month:"}),e.jsx("input",{type:"month",value:n,onChange:O=>i(O.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(rr,{filters:o,onFiltersChange:$})}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:k,disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Generate Report"]}),e.jsxs("button",{onClick:D,disabled:m,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Regenerate"]}),R&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:v,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Print Report"]})]})]}),m&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(_e,{size:"lg"})}),!m&&R&&e.jsxs("div",{className:"space-y-6",children:[a==="daily"&&u&&e.jsx(tr,{report:u}),a==="monthly"&&h&&e.jsx(sr,{report:h}),e.jsx(ar,{report:R,reportType:a,onExportPDF:v,onPrint:E})]}),!m&&!R&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No report available"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Generate a report for the selected date to view data."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:k,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})]})})})},or=le(a=>({integrations:{zomato:{id:"zomato",name:"Zomato",type:"order_platform",is_enabled:!1,is_active:!1,is_configured:!1,settings:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},swiggy:{id:"swiggy",name:"Swiggy",type:"order_platform",is_enabled:!1,is_active:!1,is_configured:!1,settings:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},paytm:{id:"paytm",name:"Paytm",type:"payment",is_enabled:!1,is_active:!1,is_configured:!1,settings:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},stats:{total_orders_synced:0,last_sync_time:"",active_integrations:0},payment_stats:{total_transactions:0,success_rate:0,total_amount:0}},selectedIntegration:null,isLoading:!1,error:null,fetchIntegrations:async()=>{a({isLoading:!0,error:null});try{await new Promise(t=>setTimeout(t,1e3)),a(t=>({integrations:{...t.integrations,zomato:{...t.integrations.zomato,is_configured:!0,is_active:!0},stats:{total_orders_synced:45,last_sync_time:new Date().toISOString(),active_integrations:2}},isLoading:!1}))}catch(t){a({error:t.message,isLoading:!1}),P.getState().addNotification({type:"error",title:"Failed to Load Integrations",message:t.message})}},toggleIntegration:async(t,s)=>{try{a(r=>({integrations:{...r.integrations,[t]:{...r.integrations[t],is_active:s}}}))}catch(r){a({error:r.message})}},testConnection:async()=>{try{return await new Promise(t=>setTimeout(t,2e3)),{connected:!0,message:"Connection successful"}}catch(t){return{connected:!1,message:t.message}}},updateCredentials:async(t,s)=>{try{a(r=>({integrations:{...r.integrations,[t]:{...r.integrations[t],api_credentials:s,is_configured:!0}}}))}catch(r){a({error:r.message})}},syncOrders:async()=>{try{return await new Promise(t=>setTimeout(t,3e3)),{orders_synced:Math.floor(Math.random()*10)+1}}catch(t){throw t}},clearError:()=>a({error:null}),setSelectedIntegration:t=>a({selectedIntegration:t})})),cr=()=>{var x,b,w,g,p,k,D,v,E,$,C,R,O,W,_,S,A,L,q,K;const[a,t]=c.useState(!1),[s,r]=c.useState("food-delivery"),{integrations:n,isLoading:i,fetchIntegrations:o,toggleIntegration:l,testConnection:m,updateCredentials:d,syncOrders:u}=or(),{addNotification:h}=P();c.useEffect(()=>{o()},[o]);const f=async(U,Q)=>{try{await l(U,Q),h({type:"success",title:"Integration Updated",message:`Integration ${Q?"enabled":"disabled"} successfully.`})}catch{h({type:"error",title:"Update Failed",message:"Failed to update integration status."})}},I=async U=>{t(!0);try{const Q=await m(U);h({type:Q.connected?"success":"error",title:"Connection Test",message:Q.connected?"Connection successful!":"Connection failed. Please check credentials."})}catch{h({type:"error",title:"Test Failed",message:"Failed to test connection."})}finally{t(!1)}},j=async U=>{t(!0);try{const Q=await u(U);h({type:"success",title:"Orders Synced",message:`Successfully synced ${Q.orders_synced} orders from ${U}.`})}catch{h({type:"error",title:"Sync Failed",message:`Failed to sync orders from ${U}.`})}finally{t(!1)}},y=U=>U.is_configured?U.is_active?{text:"Active",color:"text-green-600",bg:"bg-green-100"}:{text:"Inactive",color:"text-red-600",bg:"bg-red-100"}:{text:"Not Configured",color:"text-gray-500",bg:"bg-gray-100"};return i?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(_e,{size:"lg"})}):e.jsx(re,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Integrations"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Connect with food delivery platforms and payment gateways"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>r("food-delivery"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="food-delivery"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(ws,{className:"h-5 w-5 inline mr-2"}),"Food Delivery"]}),e.jsxs("button",{onClick:()=>r("payments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="payments"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(je,{className:"h-5 w-5 inline mr-2"}),"Payment Gateways"]})]})})}),s==="food-delivery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Food Delivery Platforms"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Automatically fetch orders from delivery platforms"})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:"🟡"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Zomato"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Auto-fetch orders and sync order status"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(n.zomato).bg} ${y(n.zomato).color}`,children:y(n.zomato).text}),e.jsxs("button",{onClick:()=>I("zomato"),disabled:a||!((x=n.zomato)!=null&&x.is_configured),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Test"]}),e.jsxs("button",{onClick:()=>j("zomato"),disabled:a||!((b=n.zomato)!=null&&b.is_active),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Sync Orders"]}),e.jsx("button",{onClick:()=>{var U;return f("zomato",!((U=n.zomato)!=null&&U.is_active))},disabled:!((w=n.zomato)!=null&&w.is_configured),className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ${(g=n.zomato)!=null&&g.is_active?"text-white bg-red-600 hover:bg-red-700":"text-white bg-green-600 hover:bg-green-700"}`,children:(p=n.zomato)!=null&&p.is_active?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Disable"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Enable"]})}),e.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Configure"]})]})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:"🟠"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Swiggy"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Auto-fetch orders and sync order status"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(n.swiggy).bg} ${y(n.swiggy).color}`,children:y(n.swiggy).text}),e.jsxs("button",{onClick:()=>I("swiggy"),disabled:a||!((k=n.swiggy)!=null&&k.is_configured),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Test"]}),e.jsxs("button",{onClick:()=>j("swiggy"),disabled:a||!((D=n.swiggy)!=null&&D.is_active),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Sync Orders"]}),e.jsx("button",{onClick:()=>{var U;return f("swiggy",!((U=n.swiggy)!=null&&U.is_active))},disabled:!((v=n.swiggy)!=null&&v.is_configured),className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ${(E=n.swiggy)!=null&&E.is_active?"text-white bg-red-600 hover:bg-red-700":"text-white bg-green-600 hover:bg-green-700"}`,children:($=n.swiggy)!=null&&$.is_active?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Disable"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Enable"]})}),e.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Configure"]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Integration Statistics"})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((C=n.stats)==null?void 0:C.total_orders_synced)||0}),e.jsx("div",{className:"text-sm text-blue-800",children:"Total Orders Synced"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(R=n.stats)!=null&&R.last_sync_time?new Date(n.stats.last_sync_time).toLocaleTimeString():"Never"}),e.jsx("div",{className:"text-sm text-green-800",children:"Last Sync Time"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:((O=n.stats)==null?void 0:O.active_integrations)||0}),e.jsx("div",{className:"text-sm text-purple-800",children:"Active Integrations"})]})]})})]})]}),s==="payments"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Payment Gateways"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Process card payments and digital transactions"})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:"💳"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Paytm Card Machine"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Process card payments via Paytm terminal"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(n.paytm).bg} ${y(n.paytm).color}`,children:y(n.paytm).text}),e.jsxs("button",{onClick:()=>I("paytm"),disabled:a||!((W=n.paytm)!=null&&W.is_configured),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Test"]}),e.jsx("button",{onClick:()=>{var U;return f("paytm",!((U=n.paytm)!=null&&U.is_active))},disabled:!((_=n.paytm)!=null&&_.is_configured),className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ${(S=n.paytm)!=null&&S.is_active?"text-white bg-red-600 hover:bg-red-700":"text-white bg-green-600 hover:bg-green-700"}`,children:(A=n.paytm)!=null&&A.is_active?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Disable"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Enable"]})}),e.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Configure"]})]})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Payment Statistics"})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((L=n.payment_stats)==null?void 0:L.total_transactions)||0}),e.jsx("div",{className:"text-sm text-blue-800",children:"Total Transactions"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(q=n.payment_stats)!=null&&q.success_rate?`${n.payment_stats.success_rate}%`:"0%"}),e.jsx("div",{className:"text-sm text-green-800",children:"Success Rate"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(K=n.payment_stats)!=null&&K.total_amount?`₹${n.payment_stats.total_amount.toLocaleString()}`:"₹0"}),e.jsx("div",{className:"text-sm text-purple-800",children:"Total Amount"})]})]})})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex items-center space-x-3",children:[e.jsx(_e,{size:"md"}),e.jsx("span",{className:"text-gray-700",children:"Processing..."})]})})]})})})};class lr{constructor(){B(this,"updates",[]);B(this,"modules",[]);B(this,"schedules",[]);B(this,"isUpdateMode",!1);B(this,"updateQueue",[]);this.initializeDefaultUpdates(),this.initializeDefaultModules(),this.initializeUpdateSchedules()}initializeDefaultUpdates(){this.updates=[{id:"v2.1.0",version:"2.1.0",name:"Advanced Analytics Dashboard",description:"Enhanced reporting with real-time analytics, predictive insights, and custom dashboards",type:"feature",priority:"high",status:"planned",releaseDate:"2024-03-15",changelog:["Real-time sales analytics","Predictive inventory management","Custom dashboard builder","Advanced filtering options","Export to multiple formats"],dependencies:["analytics-engine","chart-library"],breakingChanges:!1,requiresRestart:!1,estimatedDuration:"2 weeks",developer:"Smoocho Dev Team",tags:["analytics","dashboard","reporting","insights"]},{id:"v2.2.0",version:"2.2.0",name:"Multi-Location Support",description:"Support for multiple store locations with centralized management",type:"feature",priority:"medium",status:"planned",releaseDate:"2024-04-01",changelog:["Multi-store management","Centralized inventory control","Cross-location reporting","Store-specific configurations","Data synchronization between locations"],dependencies:["multi-tenant-db","sync-engine"],breakingChanges:!0,requiresRestart:!0,estimatedDuration:"3 weeks",developer:"Smoocho Dev Team",tags:["multi-location","enterprise","scalability"]},{id:"v2.3.0",version:"2.3.0",name:"AI-Powered Recommendations",description:"Machine learning based product recommendations and demand forecasting",type:"feature",priority:"medium",status:"planned",releaseDate:"2024-05-01",changelog:["Smart product recommendations","Demand forecasting","Seasonal trend analysis","Customer behavior insights","Automated reorder suggestions"],dependencies:["ml-engine","data-processor"],breakingChanges:!1,requiresRestart:!1,estimatedDuration:"4 weeks",developer:"Smoocho Dev Team",tags:["ai","ml","recommendations","forecasting"]},{id:"v2.4.0",version:"2.4.0",name:"Mobile App Integration",description:"Native mobile apps for iOS and Android with offline capabilities",type:"feature",priority:"high",status:"planned",releaseDate:"2024-06-01",changelog:["Native iOS app","Native Android app","Offline-first architecture","Push notifications","Biometric authentication"],dependencies:["mobile-framework","push-service"],breakingChanges:!1,requiresRestart:!1,estimatedDuration:"6 weeks",developer:"Smoocho Dev Team",tags:["mobile","ios","android","native"]},{id:"v2.5.0",version:"2.5.0",name:"Advanced Payment Gateway",description:"Support for multiple payment methods including crypto and digital wallets",type:"feature",priority:"medium",status:"planned",releaseDate:"2024-07-01",changelog:["Cryptocurrency payments","Digital wallet integration","QR code payments","Contactless payments","Payment security enhancements"],dependencies:["payment-gateway","crypto-service"],breakingChanges:!1,requiresRestart:!1,estimatedDuration:"3 weeks",developer:"Smoocho Dev Team",tags:["payments","crypto","digital-wallets","security"]}]}initializeDefaultModules(){this.modules=[{id:"core-pos",name:"Core POS System",version:"2.0.0",description:"Main point of sale functionality",isEnabled:!0,isRequired:!0,dependencies:[],config:{timeout:0,retryCount:10},lastChecked:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:"inventory-management",name:"Inventory Management",version:"2.0.0",description:"Stock tracking and management",isEnabled:!0,isRequired:!0,dependencies:["core-pos"],config:{lowStockThreshold:10,autoReorder:!0},lastChecked:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:"reporting-engine",name:"Reporting Engine",version:"2.0.0",description:"Sales and analytics reporting",isEnabled:!0,isRequired:!1,dependencies:["core-pos"],config:{autoGenerate:!0,exportFormats:["pdf","csv"]},lastChecked:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:"integration-hub",name:"Integration Hub",version:"2.0.0",description:"Third-party service integrations",isEnabled:!0,isRequired:!1,dependencies:["core-pos"],config:{zomato:{enabled:!0,syncInterval:3e4},swiggy:{enabled:!0,syncInterval:3e4},paytm:{enabled:!0,testMode:!1}},lastChecked:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:"offline-sync",name:"Offline Sync Engine",version:"2.0.0",description:"Offline-first data synchronization",isEnabled:!0,isRequired:!0,dependencies:["core-pos"],config:{syncInterval:5e3,maxRetries:10,conflictResolution:"newest_wins"},lastChecked:new Date().toISOString(),lastUpdated:new Date().toISOString()}]}initializeUpdateSchedules(){this.schedules=[{id:"schedule-2024-q1",name:"Q1 2024 Updates",description:"First quarter updates focusing on analytics and performance",targetDate:"2024-03-31",priority:"high",modules:["v2.1.0"],estimatedDuration:"2 weeks",riskLevel:"low",rollbackPlan:"Database rollback to v2.0.0 with data migration",testingRequired:!0,approvalRequired:!1},{id:"schedule-2024-q2",name:"Q2 2024 Updates",description:"Second quarter updates with multi-location support",targetDate:"2024-06-30",priority:"medium",modules:["v2.2.0","v2.3.0"],estimatedDuration:"6 weeks",riskLevel:"medium",rollbackPlan:"Full system rollback with data backup restoration",testingRequired:!0,approvalRequired:!0},{id:"schedule-2024-q3",name:"Q3 2024 Updates",description:"Third quarter updates with mobile apps and payments",targetDate:"2024-09-30",priority:"high",modules:["v2.4.0","v2.5.0"],estimatedDuration:"8 weeks",riskLevel:"high",rollbackPlan:"Gradual rollback with feature flags",testingRequired:!0,approvalRequired:!0}]}addUpdate(t){if(!this.validateUpdate(t))throw new Error("Invalid update information");if(this.updates.find(s=>s.id===t.id))throw new Error(`Update with ID ${t.id} already exists`);this.updates.push(t),this.sortUpdates(),console.log(`✅ Added new update: ${t.name} (${t.version})`)}modifyUpdate(t,s){const r=this.updates.findIndex(n=>n.id===t);if(r===-1)throw new Error(`Update with ID ${t} not found`);this.updates[r]={...this.updates[r],...s},this.sortUpdates(),console.log(`✅ Modified update: ${this.updates[r].name}`)}removeUpdate(t){const s=this.updates.findIndex(n=>n.id===t);if(s===-1)throw new Error(`Update with ID ${t} not found`);const r=this.updates[s].name;this.updates.splice(s,1),console.log(`✅ Removed update: ${r}`)}addModule(t){if(this.modules.find(s=>s.id===t.id))throw new Error(`Module with ID ${t.id} already exists`);this.modules.push(t),console.log(`✅ Added new module: ${t.name}`)}toggleModule(t,s){const r=this.modules.find(n=>n.id===t);if(!r)throw new Error(`Module with ID ${t} not found`);if(r.isRequired&&!s)throw new Error(`Cannot disable required module: ${r.name}`);r.isEnabled=s,r.lastUpdated=new Date().toISOString(),console.log(`✅ ${s?"Enabled":"Disabled"} module: ${r.name}`)}scheduleUpdate(t){if(this.schedules.find(s=>s.id===t.id))throw new Error(`Schedule with ID ${t.id} already exists`);this.schedules.push(t),console.log(`✅ Scheduled update: ${t.name}`)}getAllUpdates(){return[...this.updates]}getUpdatesByStatus(t){return this.updates.filter(s=>s.status===t)}getUpdatesByPriority(t){return this.updates.filter(s=>s.priority===t)}getUpdatesByType(t){return this.updates.filter(s=>s.type===t)}getAllModules(){return[...this.modules]}getEnabledModules(){return this.modules.filter(t=>t.isEnabled)}getAllSchedules(){return[...this.schedules]}getUpcomingUpdates(t=30){const s=new Date;return s.setDate(s.getDate()+t),this.updates.filter(r=>r.releaseDate&&new Date(r.releaseDate)<=s)}async checkForUpdates(){try{console.log("🔍 Checking for updates...");const t=this.updates.filter(s=>s.status==="ready"||s.status==="testing");return console.log(`✅ Found ${t.length} available updates`),t}catch(t){return console.error("❌ Failed to check for updates:",t),[]}}async startUpdate(t){try{const s=this.updates.find(r=>r.id===t);if(!s)throw new Error(`Update ${t} not found`);if(s.status!=="ready")throw new Error(`Update ${t} is not ready for deployment`);return console.log(`🚀 Starting update: ${s.name}`),this.isUpdateMode=!0,this.updateQueue.push(t),await this.simulateUpdateProcess(s),!0}catch(s){return console.error("❌ Failed to start update:",s),!1}}async simulateUpdateProcess(t){const s=["Preparing update environment...","Backing up current system...","Downloading update files...","Validating update integrity...","Applying update...","Updating configuration...","Restarting services...","Verifying update success..."];for(const r of s)console.log(`⏳ ${r}`),await new Promise(n=>setTimeout(n,1e3));console.log(`✅ Update ${t.name} completed successfully!`),this.isUpdateMode=!1}async rollbackUpdate(t){try{const s=this.updates.find(r=>r.id===t);if(!s)throw new Error(`Update ${t} not found`);return console.log(`🔄 Rolling back update: ${s.name}`),await this.simulateRollbackProcess(s),!0}catch(s){return console.error("❌ Failed to rollback update:",s),!1}}async simulateRollbackProcess(t){const s=["Stopping current services...","Restoring previous version...","Rolling back database changes...","Restoring configuration...","Restarting services...","Verifying rollback success..."];for(const r of s)console.log(`⏳ ${r}`),await new Promise(n=>setTimeout(n,1e3));console.log(`✅ Rollback of ${t.name} completed successfully!`)}validateUpdate(t){return!!(t.id&&t.version&&t.name&&t.description&&t.type&&t.priority&&t.status&&t.changelog&&t.changelog.length>0)}sortUpdates(){this.updates.sort((t,s)=>{const r={critical:0,high:1,medium:2,low:3},n=r[t.priority]-r[s.priority];return n!==0?n:t.releaseDate&&s.releaseDate?new Date(t.releaseDate).getTime()-new Date(s.releaseDate).getTime():0})}getUpdateStats(){const t=this.updates.length,s=this.updates.reduce((i,o)=>(i[o.status]=(i[o.status]||0)+1,i),{}),r=this.updates.reduce((i,o)=>(i[o.priority]=(i[o.priority]||0)+1,i),{}),n=this.updates.reduce((i,o)=>(i[o.type]=(i[o.type]||0)+1,i),{});return{total:t,byStatus:s,byPriority:r,byType:n,upcoming:this.getUpcomingUpdates().length,inProgress:this.isUpdateMode}}exportUpdateData(){return JSON.stringify({updates:this.updates,modules:this.modules,schedules:this.schedules,exportDate:new Date().toISOString(),version:"2.0.0"},null,2)}importUpdateData(t){try{const s=JSON.parse(t);s.updates&&(this.updates=s.updates),s.modules&&(this.modules=s.modules),s.schedules&&(this.schedules=s.schedules),console.log("✅ Successfully imported update data")}catch(s){throw console.error("❌ Failed to import update data:",s),new Error("Invalid update data format")}}}const G=new lr,dr=()=>{const[a,t]=c.useState([]),[s,r]=c.useState([]),[n,i]=c.useState([]),[o,l]=c.useState("updates"),[m,d]=c.useState(!1),[u,h]=c.useState(G.getUpdateStats());c.useEffect(()=>{f()},[]);const f=()=>{t(G.getAllUpdates()),r(G.getAllModules()),i(G.getAllSchedules()),h(G.getUpdateStats())},I=async()=>{d(!0);try{await G.checkForUpdates(),f()}catch(p){console.error("Failed to check updates:",p)}finally{d(!1)}},j=async p=>{try{await G.startUpdate(p),f()}catch(k){console.error("Failed to start update:",k)}},y=async p=>{if(window.confirm("Are you sure you want to rollback this update? This action cannot be undone."))try{await G.rollbackUpdate(p),f()}catch(k){console.error("Failed to rollback update:",k)}},x=(p,k)=>{try{G.toggleModule(p,k),f()}catch(D){console.error("Failed to toggle module:",D)}},b=p=>{switch(p){case"deployed":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"ready":return"bg-blue-100 text-blue-800 border-blue-200";case"testing":return"bg-amber-100 text-amber-800 border-amber-200";case"in_development":return"bg-purple-100 text-purple-800 border-purple-200";case"planned":return"bg-neutral-100 text-neutral-800 border-neutral-200";default:return"bg-neutral-100 text-neutral-800 border-neutral-200"}},w=p=>{switch(p){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-amber-100 text-amber-800 border-amber-200";case"low":return"bg-emerald-100 text-emerald-800 border-emerald-200";default:return"bg-neutral-100 text-neutral-800 border-neutral-200"}},g=p=>{switch(p){case"feature":return"✨";case"bugfix":return"🐛";case"security":return"🔒";case"performance":return"⚡";case"ui":return"🎨";case"integration":return"🔗";default:return"📦"}};return e.jsxs(re,{children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-2xl p-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"🚀 Update Management"}),e.jsx("p",{className:"text-primary-100 text-lg",children:"Manage future updates, modules, and deployment schedules"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{onClick:I,disabled:m,className:"bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(ae,{className:`w-5 h-5 ${m?"animate-spin":""}`}),e.jsx("span",{children:m?"Checking...":"Check Updates"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-neutral-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Total Updates"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-2",children:u.total})]}),e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center",children:e.jsx(tt,{className:"w-6 h-6 text-primary-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-neutral-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Upcoming"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-2",children:u.upcoming})]}),e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center",children:e.jsx(he,{className:"w-6 h-6 text-amber-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-neutral-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Active Modules"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-2",children:s.filter(p=>p.isEnabled).length})]}),e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:e.jsx(ce,{className:"w-6 h-6 text-emerald-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-neutral-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-2",children:n.length})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(he,{className:"w-6 h-6 text-purple-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200",children:[e.jsx("div",{className:"border-b border-neutral-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"updates",name:"Future Updates",count:a.length},{id:"modules",name:"System Modules",count:s.length},{id:"schedules",name:"Update Schedules",count:n.length}].map(p=>e.jsxs("button",{onClick:()=>l(p.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${o===p.id?"border-primary-500 text-primary-600":"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300"}`,children:[p.name,e.jsx("span",{className:"ml-2 bg-neutral-100 text-neutral-900 py-0.5 px-2.5 rounded-full text-xs font-medium",children:p.count})]},p.id))})}),e.jsxs("div",{className:"p-6",children:[o==="updates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Future Updates"}),e.jsxs("button",{onClick:()=>{},className:"bg-primary-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-primary-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Update"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.map(p=>e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-6 border border-neutral-200 hover:border-primary-200 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:g(p.type)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:p.name}),e.jsxs("p",{className:"text-sm text-neutral-500",children:["v",p.version]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${b(p.status)}`,children:p.status}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${w(p.priority)}`,children:p.priority})]})]}),e.jsx("p",{className:"text-neutral-600 mb-4",children:p.description}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Release Date:"}),e.jsx("span",{className:"font-medium",children:p.releaseDate||"TBD"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Duration:"}),e.jsx("span",{className:"font-medium",children:p.estimatedDuration})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Developer:"}),e.jsx("span",{className:"font-medium",children:p.developer})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-2",children:"Changelog:"}),e.jsxs("ul",{className:"space-y-1",children:[p.changelog.slice(0,3).map((k,D)=>e.jsxs("li",{className:"text-sm text-neutral-600 flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary-500 rounded-full"}),e.jsx("span",{children:k})]},D)),p.changelog.length>3&&e.jsxs("li",{className:"text-sm text-primary-600",children:["+",p.changelog.length-3," more items"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[p.breakingChanges&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full border border-red-200",children:"Breaking Changes"}),p.requiresRestart&&e.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded-full border border-amber-200",children:"Requires Restart"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p.status==="ready"&&e.jsxs("button",{onClick:()=>j(p.id),className:"bg-emerald-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors duration-200 flex items-center space-x-1",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx("span",{children:"Deploy"})]}),p.status==="deployed"&&e.jsxs("button",{onClick:()=>y(p.id),className:"bg-red-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center space-x-1",children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsx("span",{children:"Rollback"})]}),e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(te,{className:"w-4 h-4 text-neutral-600"})}),e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(ne,{className:"w-4 h-4 text-neutral-600"})})]})]})]},p.id))})]}),o==="modules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"System Modules"}),e.jsxs("button",{onClick:()=>{},className:"bg-primary-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-primary-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Module"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:s.map(p=>e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-6 border border-neutral-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:p.name}),e.jsxs("p",{className:"text-sm text-neutral-500",children:["v",p.version]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${p.isEnabled?"bg-emerald-100 text-emerald-800 border-emerald-200":"bg-neutral-100 text-neutral-800 border-neutral-200"}`,children:p.isEnabled?"Active":"Inactive"}),p.isRequired&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full border border-red-200",children:"Required"})]})]}),e.jsx("p",{className:"text-neutral-600 mb-4",children:p.description}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Last Updated:"}),e.jsx("span",{className:"font-medium",children:new Date(p.lastUpdated).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Dependencies:"}),e.jsx("span",{className:"font-medium",children:p.dependencies.length||"None"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:!p.isRequired&&e.jsx("button",{onClick:()=>x(p.id,!p.isEnabled),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${p.isEnabled?"bg-red-600 text-white hover:bg-red-700":"bg-emerald-600 text-white hover:bg-emerald-700"}`,children:p.isEnabled?"Disable":"Enable"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(te,{className:"w-4 h-4 text-neutral-600"})}),!p.isRequired&&e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(ne,{className:"w-4 h-4 text-neutral-600"})})]})]})]},p.id))})]}),o==="schedules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Update Schedules"}),e.jsxs("button",{onClick:()=>{},className:"bg-primary-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-primary-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Schedule"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(p=>e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-6 border border-neutral-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:p.name}),e.jsx("p",{className:"text-sm text-neutral-500",children:p.description})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${w(p.priority)}`,children:p.priority}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${p.riskLevel==="high"?"bg-red-100 text-red-800 border-red-200":p.riskLevel==="medium"?"bg-amber-100 text-amber-800 border-amber-200":"bg-emerald-100 text-emerald-800 border-emerald-200"}`,children:[p.riskLevel," risk"]})]})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Target Date:"}),e.jsx("span",{className:"font-medium",children:new Date(p.targetDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Duration:"}),e.jsx("span",{className:"font-medium",children:p.estimatedDuration})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-500",children:"Modules:"}),e.jsx("span",{className:"font-medium",children:p.modules.length})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-2",children:"Rollback Plan:"}),e.jsx("p",{className:"text-sm text-neutral-600",children:p.rollbackPlan})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[p.testingRequired&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full border border-blue-200",children:"Testing Required"}),p.approvalRequired&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full border border-purple-200",children:"Approval Required"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"bg-primary-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors duration-200",children:"View Details"}),e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(te,{className:"w-4 h-4 text-neutral-600"})}),e.jsx("button",{className:"p-1.5 hover:bg-neutral-200 rounded-lg transition-colors duration-200",children:e.jsx(ne,{className:"w-4 h-4 text-neutral-600"})})]})]})]},p.id))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Data Management"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>{const p=G.exportUpdateData(),k=new Blob([p],{type:"application/json"}),D=URL.createObjectURL(k),v=document.createElement("a");v.href=D,v.download=`smoocho-updates-${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(D)},className:"bg-emerald-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-emerald-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Te,{className:"w-5 h-5"}),e.jsx("span",{children:"Export Updates"})]}),e.jsxs("button",{onClick:()=>{const p=document.createElement("input");p.type="file",p.accept=".json",p.onchange=k=>{var v;const D=(v=k.target.files)==null?void 0:v[0];if(D){const E=new FileReader;E.onload=$=>{var C;try{G.importUpdateData((C=$.target)==null?void 0:C.result),f()}catch(R){alert("Failed to import update data: "+R)}},E.readAsText(D)}},p.click()},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Jt,{className:"w-5 h-5"}),e.jsx("span",{children:"Import Updates"})]})]})]})]})},mr=()=>e.jsx(re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Menu Editor"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your menu categories, items, pricing, and past orders"})]})}),e.jsx(nt,{})]})}),ur=()=>e.jsx(re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Configure your system preferences and business settings"})]})}),e.jsx(it,{isOpen:!0,onClose:()=>{},isPage:!0})]})}),pr=({order:a,onClose:t,onOrderUpdated:s})=>{const[r,n]=c.useState(a.order_items),[i,o]=c.useState(!1),[l,m]=c.useState(!1),[d,u]=c.useState(""),{user:h}=V(),{addNotification:f}=P();c.useEffect(()=>{m((h==null?void 0:h.role)!=="admin"&&(h==null?void 0:h.role)!=="manager")},[h]);const I=(k,D)=>{D<=0?n(v=>v.filter(E=>E.id!==k)):n(v=>v.map(E=>E.id===k?{...E,quantity:D,item_total:D*E.product_price}:E))},j=k=>{n(D=>D.filter(v=>v.id!==k))},y=()=>{const k=r.reduce((C,R)=>C+R.item_total,0),D=a.discount_amount||0,v=k-D,E=v*.05,$=v+E;return{subtotal:k,tax:E,total:$}},x=async()=>{if(r.length===0){f({type:"error",title:"Invalid Order",message:"Order must have at least one item"});return}o(!0);try{const{subtotal:k,tax:D,total:v}=y(),E={subtotal:k,tax_amount:D,total_amount:v,updated_at:new Date().toISOString()};if(l&&d===""){f({type:"warning",title:"Admin Approval Required",message:"Please enter admin password to approve this edit"});return}await X.updateOrder(a.id,E,!l||d!==""),f({type:"success",title:"Order Updated",message:"Order has been updated successfully"}),s(),t()}catch(k){console.error("Failed to update order:",k),f({type:"error",title:"Update Failed",message:k instanceof Error?k.message:"Failed to update order"})}finally{o(!1)}},{subtotal:b,tax:w,total:g}=y(),p=JSON.stringify(r)!==JSON.stringify(a.order_items);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary-900",children:["Edit Order - #",a.order_number]}),e.jsx("button",{onClick:t,className:"p-1 hover:bg-secondary-100 rounded",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ie,{className:"w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Order Edit Warning"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["Editing orders can affect inventory tracking and financial records.",l&&" This action requires admin approval."]})]})]})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("h4",{className:"font-medium text-secondary-900",children:"Order Items"}),r.map(k=>e.jsx("div",{className:"border border-secondary-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-secondary-900",children:k.product_name}),e.jsxs("p",{className:"text-sm text-secondary-500",children:["₹",k.product_price.toFixed(2)," each"]}),k.special_instructions&&e.jsxs("p",{className:"text-sm text-secondary-600 mt-1",children:["Note: ",k.special_instructions]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>I(k.id,k.quantity-1),className:"p-2 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-medium min-w-[3rem] text-center",children:k.quantity}),e.jsx("button",{onClick:()=>I(k.id,k.quantity+1),className:"p-2 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(se,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"text-right min-w-[5rem]",children:e.jsxs("p",{className:"text-lg font-bold text-secondary-900",children:["₹",k.item_total.toFixed(2)]})}),e.jsx("button",{onClick:()=>j(k.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors text-red-600",title:"Remove Item",children:e.jsx(ne,{className:"w-4 h-4"})})]})]})},k.id)),r.length===0&&e.jsx("div",{className:"text-center py-8 text-secondary-500",children:e.jsx("p",{children:"No items in order. Add at least one item to save changes."})})]}),e.jsx("div",{className:"border-t border-secondary-200 pt-4 mb-6",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["₹",b.toFixed(2)]})]}),a.discount_amount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-₹",a.discount_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax (5%):"}),e.jsxs("span",{children:["₹",w.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-secondary-200 pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["₹",g.toFixed(2)]})]}),p&&e.jsxs("div",{className:"flex justify-between text-sm text-blue-600 pt-2 border-t border-blue-200",children:[e.jsx("span",{children:"Change from original:"}),e.jsxs("span",{children:[g>a.total_amount?"+":"","₹",(g-a.total_amount).toFixed(2)]})]})]})}),l&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Admin Password (Required for Approval)"}),e.jsx("input",{type:"password",value:d,onChange:k=>u(k.target.value),placeholder:"Enter admin password",className:"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 border border-secondary-300 text-secondary-700 rounded-lg hover:bg-secondary-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:x,disabled:i||!p||r.length===0,className:"flex-1 px-4 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:bg-secondary-300 disabled:cursor-not-allowed transition-colors",children:i?"Saving...":"Save Changes"})]})]})})})},hr=({isModal:a=!1,onClose:t})=>{const[s,r]=c.useState([]),[n,i]=c.useState(!0),[o,l]=c.useState(""),[m,d]=c.useState("all"),[u,h]=c.useState(null),[f,I]=c.useState(null),[j,y]=c.useState(1),[x,b]=c.useState({start:new Date(Date.now()-10080*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),{user:w}=V(),{addNotification:g}=P(),p=10;c.useEffect(()=>{k()},[x,m]);const k=async()=>{i(!0);try{let _;m==="all"?_=await X.getOrdersByDateRange(x.start+"T00:00:00.000Z",x.end+"T23:59:59.999Z"):_=await X.getOrdersByDateRange(x.start+"T00:00:00.000Z",x.end+"T23:59:59.999Z",m),_.sort((S,A)=>new Date(A.order_date).getTime()-new Date(S.order_date).getTime()),r(_)}catch(_){console.error("Failed to load orders:",_),g({type:"error",title:"Load Failed",message:"Failed to load order history"})}finally{i(!1)}},D=s.filter(_=>{var A,L,q;return o===""||_.order_number.toLowerCase().includes(o.toLowerCase())||((A=_.customer_name)==null?void 0:A.toLowerCase().includes(o.toLowerCase()))||((L=_.customer_phone)==null?void 0:L.includes(o))||((q=_.table_number)==null?void 0:q.toLowerCase().includes(o.toLowerCase()))}),v=Math.ceil(D.length/p),E=D.slice((j-1)*p,j*p),$=async _=>{try{const S=await X.getOrderWithItems(_);S&&h(S)}catch(S){console.error("Failed to load order details:",S),g({type:"error",title:"Load Failed",message:"Failed to load order details"})}},C=async _=>{try{const S=await X.getOrderWithItems(_);S&&I(S)}catch(S){console.error("Failed to load order for editing:",S),g({type:"error",title:"Load Failed",message:"Failed to load order for editing"})}},R=async _=>{if(window.confirm("Are you sure you want to cancel this order?"))try{await X.cancelOrder(_),g({type:"success",title:"Order Cancelled",message:"Order has been cancelled successfully"}),k()}catch(S){console.error("Failed to cancel order:",S),g({type:"error",title:"Cancel Failed",message:"Failed to cancel order"})}},O=async _=>{try{if(await ot.printReceipt(_))g({type:"success",title:"Print Successful",message:"Receipt has been sent to printer"});else throw new Error("Print failed")}catch(S){console.error("Failed to print receipt:",S),g({type:"error",title:"Print Failed",message:"Failed to print receipt"})}},W=({status:_})=>{const S={pending:{color:"yellow",text:"Pending"},confirmed:{color:"blue",text:"Confirmed"},preparing:{color:"orange",text:"Preparing"},ready:{color:"purple",text:"Ready"},completed:{color:"green",text:"Completed"},cancelled:{color:"red",text:"Cancelled"}},A=S[_]||S.pending;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${A.color}-100 text-${A.color}-800`,children:A.text})};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-white border-b border-secondary-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center",children:[a&&t&&e.jsx("button",{onClick:t,className:"mr-3 p-2 hover:bg-secondary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-bold text-secondary-900",children:"Order History"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-3 top-3 w-5 h-5 text-secondary-400"}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:o,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("select",{value:m,onChange:_=>d(_.target.value),className:"px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"preparing",children:"Preparing"}),e.jsx("option",{value:"ready",children:"Ready"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsx("input",{type:"date",value:x.start,onChange:_=>b(S=>({...S,start:_.target.value})),className:"px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx("input",{type:"date",value:x.end,onChange:_=>b(S=>({...S,end:_.target.value})),className:"px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:n?e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),e.jsx("span",{className:"ml-3 text-secondary-600",children:"Loading orders..."})]}):E.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(he,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-secondary-900 mb-2",children:"No orders found"}),e.jsx("p",{className:"text-secondary-500",children:o?`No orders match "${o}"`:"No orders in selected date range"})]}):e.jsx("div",{className:"p-4 space-y-4",children:E.map(_=>e.jsx("div",{className:"bg-white rounded-lg border border-secondary-200 hover:border-primary-300 transition-colors",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"font-medium text-secondary-900",children:["#",_.order_number]}),e.jsx(W,{status:_.status}),e.jsx("span",{className:"text-sm text-secondary-500",children:new Date(_.order_date).toLocaleString()})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-secondary-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",_.order_type.replace("_"," ")]}),_.customer_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Customer:"})," ",_.customer_name]}),_.table_number&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Table:"})," ",_.table_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total:"})," ₹",_.total_amount.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>$(_.id),className:"p-2 hover:bg-blue-100 rounded-lg transition-colors text-blue-600",title:"View Details",children:e.jsx(st,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(_.id),className:"p-2 hover:bg-green-100 rounded-lg transition-colors text-green-600",title:"Print Receipt",children:e.jsx(we,{className:"w-4 h-4"})}),((w==null?void 0:w.role)==="admin"||(w==null?void 0:w.role)==="manager")&&_.status!=="cancelled"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C(_.id),className:"p-2 hover:bg-blue-100 rounded-lg transition-colors text-blue-600",title:"Edit Order",children:e.jsx(te,{className:"w-4 h-4"})}),_.status==="pending"&&e.jsx("button",{onClick:()=>R(_.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors text-red-600",title:"Cancel Order",children:e.jsx(fe,{className:"w-4 h-4"})})]})]})]})})},_.id))})}),v>1&&e.jsx("div",{className:"bg-white border-t border-secondary-200 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-secondary-700",children:["Showing"," ",Math.min((j-1)*p+1,D.length)," ","to ",Math.min(j*p,D.length)," ","of ",D.length," orders"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>y(_=>Math.max(1,_-1)),disabled:j===1,className:"p-2 hover:bg-secondary-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-secondary-700",children:["Page ",j," of ",v]}),e.jsx("button",{onClick:()=>y(_=>Math.min(v,_+1)),disabled:j===v,className:"p-2 hover:bg-secondary-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Lt,{className:"w-4 h-4"})})]})]})}),f&&e.jsx(pr,{order:f,onClose:()=>I(null),onOrderUpdated:()=>{k(),I(null)}}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary-900",children:["Order Details - #",u.order_number]}),e.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-secondary-100 rounded",children:e.jsx(fe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-secondary-700",children:"Status:"}),e.jsx("div",{className:"mt-1",children:e.jsx(W,{status:u.status})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-secondary-700",children:"Date:"}),e.jsx("div",{className:"mt-1",children:new Date(u.order_date).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-secondary-700",children:"Type:"}),e.jsx("div",{className:"mt-1",children:u.order_type.replace("_"," ")})]}),u.customer_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-secondary-700",children:"Customer:"}),e.jsx("div",{className:"mt-1",children:u.customer_name})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-secondary-900 mb-2",children:"Items"}),e.jsx("div",{className:"space-y-2",children:u.order_items.map(_=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-secondary-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:_.product_name}),_.special_instructions&&e.jsxs("div",{className:"text-sm text-secondary-500",children:["Note: ",_.special_instructions]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:[_.quantity," × ₹",_.product_price.toFixed(2)]}),e.jsxs("div",{className:"font-medium",children:["₹",_.item_total.toFixed(2)]})]})]},_.id))})]}),e.jsx("div",{className:"border-t border-secondary-200 pt-4",children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["₹",u.subtotal.toFixed(2)]})]}),u.discount_amount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-₹",u.discount_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax:"}),e.jsxs("span",{children:["₹",u.tax_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-secondary-200 pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["₹",u.total_amount.toFixed(2)]})]})]})})]})]})})})]})},xr=()=>e.jsx(re,{children:e.jsx(hr,{})});class gr{constructor(){B(this,"apiBaseUrl");B(this,"tokenKey","smoocho-auth-token");this.apiBaseUrl="http://localhost:5000",this.setupAxiosInterceptors()}setupAxiosInterceptors(){J.interceptors.request.use(t=>{const s=this.getStoredToken();return s&&t.headers&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t)),J.interceptors.response.use(t=>t,async t=>{var r;const s=t.config;if(((r=t.response)==null?void 0:r.status)===401&&!s._retry)if(s._retry=!0,await this.tryRefreshToken()){const i=this.getStoredToken();return i&&(s.headers.Authorization=`Bearer ${i}`),J(s)}else this.logout();return Promise.reject(t)})}async login(t){var s,r;try{const n=await J.post(`${this.apiBaseUrl}/api/auth/login`,t);if(n.data.success&&n.data.data){const{user:i,token:o}=n.data.data;this.storeToken(o);const{login:l}=V.getState();l(i,o);const{addNotification:m}=P.getState();return m({type:"success",title:"Login Successful",message:`Welcome back, ${i.username}!`}),n.data.data}else throw new Error(n.data.error||"Login failed")}catch(n){const i=((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.error)||n.message||"Login failed",{addNotification:o}=P.getState();throw o({type:"error",title:"Login Failed",message:i}),new Error(i)}}logout(){try{J.post(`${this.apiBaseUrl}/api/auth/logout`).catch(()=>{})}catch{}this.clearStoredToken();const{logout:t}=V.getState();t();const{addNotification:s}=P.getState();s({type:"info",title:"Logged Out",message:"You have been logged out successfully"})}async register(t){var s,r;try{const n=await J.post(`${this.apiBaseUrl}/api/auth/register`,t);if(n.data.success&&n.data.data){const{user:i,token:o}=n.data.data;this.storeToken(o);const{login:l}=V.getState();l(i,o);const{addNotification:m}=P.getState();return m({type:"success",title:"Registration Successful",message:`Welcome to Smoocho Bill, ${i.username}!`}),n.data.data}else throw new Error(n.data.error||"Registration failed")}catch(n){const i=((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.error)||n.message||"Registration failed",{addNotification:o}=P.getState();throw o({type:"error",title:"Registration Failed",message:i}),new Error(i)}}async refreshToken(){try{const t=this.getStoredToken();if(!t)return!1;const s=await J.post(`${this.apiBaseUrl}/api/auth/refresh`,{token:t});if(s.data.success&&s.data.data){const{token:r}=s.data.data;this.storeToken(r);const{user:n,login:i}=V.getState();return n&&i(n,r),console.log("✅ Token refreshed successfully"),!0}return!1}catch(t){return console.log("❌ Token refresh failed:",t),!1}}async tryRefreshToken(){try{return await this.refreshToken()}catch(t){return console.log("Silent token refresh failed:",t),!1}}async getCurrentUser(){try{const t=await J.get(`${this.apiBaseUrl}/api/auth/me`);return t.data.success&&t.data.data?t.data.data:null}catch(t){return console.log("Failed to get current user:",t),null}}async updateProfile(t){var s,r;try{const n=await J.put(`${this.apiBaseUrl}/api/auth/profile`,t);if(n.data.success&&n.data.data){const{updateUser:i}=V.getState();i(n.data.data);const{addNotification:o}=P.getState();return o({type:"success",title:"Profile Updated",message:"Your profile has been updated successfully"}),n.data.data}else throw new Error(n.data.error||"Failed to update profile")}catch(n){const i=((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.error)||n.message||"Failed to update profile",{addNotification:o}=P.getState();throw o({type:"error",title:"Update Failed",message:i}),new Error(i)}}async changePassword(t,s){var r,n;try{const i=await J.post(`${this.apiBaseUrl}/api/auth/change-password`,{currentPassword:t,newPassword:s});if(i.data.success){const{addNotification:o}=P.getState();o({type:"success",title:"Password Changed",message:"Your password has been changed successfully"})}else throw new Error(i.data.error||"Failed to change password")}catch(i){const o=((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.error)||i.message||"Failed to change password",{addNotification:l}=P.getState();throw l({type:"error",title:"Password Change Failed",message:o}),new Error(o)}}isAuthenticated(){const t=this.getStoredToken(),{isAuthenticated:s}=V.getState();return!!(t&&s)}getStoredToken(){try{return localStorage.getItem(this.tokenKey)}catch(t){return console.warn("Failed to get stored token:",t),null}}storeToken(t){try{localStorage.setItem(this.tokenKey,t)}catch(s){console.error("Failed to store token:",s)}}clearStoredToken(){try{localStorage.removeItem(this.tokenKey)}catch(t){console.warn("Failed to clear stored token:",t)}}isTokenValid(){const t=this.getStoredToken();if(!t)return!1;try{const s=t.split(".");if(s.length!==3)return!1;const r=JSON.parse(atob(s[1])),n=Math.floor(Date.now()/1e3);return r.exp>n}catch(s){return console.warn("Token validation failed:",s),!1}}getTokenExpiration(){const t=this.getStoredToken();if(!t)return null;try{const s=t.split("."),r=JSON.parse(atob(s[1]));return new Date(r.exp*1e3)}catch(s){return console.warn("Failed to get token expiration:",s),null}}scheduleTokenRefresh(){const t=this.getTokenExpiration();if(!t)return;const s=new Date,n=t.getTime()-s.getTime()-300*1e3;n>0&&setTimeout(()=>{this.refreshToken().then(i=>{i&&this.scheduleTokenRefresh()})},n)}async initializeAuth(){const{setLoading:t}=V.getState();try{t(!0);const s=this.getStoredToken();if(!s||!this.isTokenValid())return;const r=await this.getCurrentUser();if(r){const{login:n}=V.getState();n(r,s),this.scheduleTokenRefresh(),console.log("✅ Auth initialized from stored token")}else this.clearStoredToken()}catch(s){console.error("Auth initialization failed:",s),this.clearStoredToken()}finally{t(!1)}}}const me=new gr;typeof window<"u"&&me.initializeAuth();const yr=()=>{const{user:a,isAuthenticated:t,isLoading:s,setLoading:r}=V(),[n,i]=c.useState(!1),o=c.useCallback(async h=>{try{i(!0),r(!0),await me.login(h)}finally{i(!1),r(!1)}},[r]),l=c.useCallback(()=>{me.logout()},[]),m=c.useCallback(async()=>await me.refreshToken(),[]),d=c.useCallback(async h=>{try{i(!0),await me.updateProfile(h)}finally{i(!1)}},[]),u=c.useCallback(async(h,f)=>{try{i(!0),await me.changePassword(h,f)}finally{i(!1)}},[]);return{isAuthenticated:t,user:a,isLoading:s||n,login:o,logout:l,refreshToken:m,updateProfile:d,changePassword:u}};function fr(){const{user:a,isLoading:t}=yr();console.log("🔍 App.tsx - Auth state:",{user:a,isLoading:t});const s={id:"1",username:"admin",role:"admin"};return t?(console.log("🔄 App.tsx - Loading..."),e.jsx(_e,{})):(console.log("✅ App.tsx - Not loading, user:",s),e.jsx(ut,{children:e.jsxs(pt,{children:[e.jsx(Z,{path:"/login",element:e.jsx(Ae,{to:"/dashboard"})}),e.jsx(Z,{path:"/dashboard",element:e.jsx(Os,{})}),e.jsx(Z,{path:"/pos",element:e.jsx(Vs,{})}),e.jsx(Z,{path:"/inventory",element:e.jsx(er,{})}),e.jsx(Z,{path:"/reports",element:e.jsx(ir,{})}),e.jsx(Z,{path:"/integrations",element:e.jsx(cr,{})}),e.jsx(Z,{path:"/updates",element:e.jsx(dr,{})}),e.jsx(Z,{path:"/menu-editor",element:e.jsx(mr,{})}),e.jsx(Z,{path:"/settings",element:e.jsx(ur,{})}),e.jsx(Z,{path:"/orders",element:e.jsx(xr,{})}),e.jsx(Z,{path:"/",element:e.jsx(Ae,{to:"/dashboard"})})]})}))}const br=ft.createRoot(document.getElementById("root"));br.render(e.jsx(Ye.StrictMode,{children:e.jsx(fr,{})}));
